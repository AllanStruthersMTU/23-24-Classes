(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    278156,       6715]
NotebookOptionsPosition[    255612,       6353]
NotebookOutlinePosition[    256216,       6374]
CellTagsIndexPosition[    256173,       6371]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["P2: Orthogonality", "Title",
 CellChangeTimes->{{3.8465884180627756`*^9, 3.846588429089326*^9}, {
   3.84666883912605*^9, 3.846668864267633*^9}, {3.8826172645175605`*^9, 
   3.8826172694218645`*^9}, 3.9132865143327746`*^9, {3.9132865889164953`*^9, 
   3.9132865971961107`*^9}, {3.9135471333791113`*^9, 
   3.9135471341080503`*^9}, {3.9135474119473047`*^9, 3.913547436538397*^9}, {
   3.9137348080520563`*^9, 
   3.9137348084449606`*^9}},ExpressionUUID->"bb443c9e-1a1c-437e-b10c-\
400e63a30bb8"],

Cell["\<\
The gold-standard most stable linear algebra computations are based on \
operations with orthogonal matrices.  We need to be able to build rotations \
(and associated projectors) to do useful tasks.  \
\>", "Text",
 CellChangeTimes->{{3.846588481992638*^9, 3.8465885542280874`*^9}, {
  3.8466688770034857`*^9, 3.84666896561064*^9}, {3.8511778114942026`*^9, 
  3.851177811739499*^9}, {3.913286497973633*^9, 3.9132866018439727`*^9}, {
  3.913547445906307*^9, 
  3.913547562281369*^9}},ExpressionUUID->"81b47a30-cbf5-44a1-b035-\
840c4d1878c2"],

Cell[CellGroupData[{

Cell["Projectors and Orthogonality", "Section",
 CellChangeTimes->{{3.8465884180627756`*^9, 3.846588429089326*^9}, {
  3.84666883912605*^9, 3.846668864267633*^9}, {3.846670417593573*^9, 
  3.846670436952243*^9}, {3.846672726384389*^9, 3.8466727270705147`*^9}, {
  3.8466757090828*^9, 3.846675717466256*^9}, {3.846758673014533*^9, 
  3.8467586795609393`*^9}, {3.91354876492236*^9, 
  3.913548776618065*^9}},ExpressionUUID->"2c54ee19-3f0a-4f3e-9333-\
ab8c9a1832bc"],

Cell[CellGroupData[{

Cell["Calculus II", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}},ExpressionUUID->"ff5a9bb7-5436-4220-93e6-\
34e47a0c6a5e"],

Cell[TextData[{
 "In Calculus II you defined projectors onto a vector ",
 Cell[BoxData[
  FormBox["u", TraditionalForm]],ExpressionUUID->
  "9174236f-b9ff-4d47-9809-ed310904dd25"],
 " as an operator (clearly linear although you may not have bothered saying \
it) as \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"v", "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"<", "v"}], ",", 
        RowBox[{"u", ">"}]}], 
       RowBox[{
        RowBox[{"<", "u"}], ",", 
        RowBox[{"u", ">"}]}]], "u"}]}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"v", ".", "u"}], 
      RowBox[{"u", ".", "u"}]], "u"}]}], TraditionalForm]],ExpressionUUID->
  "eccf4ee1-668d-4518-8759-5754cd0080e9"],
 "\nYou immediately realized that this was cleaner if ",
 Cell[BoxData[
  FormBox["u", TraditionalForm]],ExpressionUUID->
  "220c0658-01c5-4fe0-9ded-93cb8834e1a1"],
 " was normalized! The simpler formula for the projector onto a unit (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"||", "u", "||"}], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "1e5f9bba-bda6-4b1c-b885-f61646fef952"],
 ") vector \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"v", ".", "u"}], ")"}], "u"}]}], TraditionalForm]],
  ExpressionUUID->"d2a3ee33-6a2f-4e0a-9f8f-c2a9819191bd"],
 "\nand the complementary projection onto ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "\[Perpendicular]"], TraditionalForm]],ExpressionUUID->
  "d97b9268-d9a0-4ce4-a690-cf61aa924981"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "\[Rule]", 
    RowBox[{"v", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"v", ".", "u"}], ")"}], "u"}]}]}], TraditionalForm]],
  ExpressionUUID->"e106f61d-8d7a-4576-9f36-a8d6cc8d44b4"],
 "\nhopefully look familiar! Since these are linear operators they have \
matrices! "
}], "Text",
 CellChangeTimes->{{3.846758706375594*^9, 3.8467587538151207`*^9}, {
  3.8467588236395116`*^9, 3.846758971339628*^9}, {3.846759020212946*^9, 
  3.846759262113787*^9}},ExpressionUUID->"1b41932c-f3d2-45e2-970f-\
0c5f9f42a32f"],

Cell["We want to know how to tell if a matrix is a projection. ", \
"ItemNumbered",
 CellChangeTimes->{{3.8467592757626677`*^9, 
  3.846759340936923*^9}},ExpressionUUID->"3603a0d5-f3c6-4f21-90ff-\
f5b5261c3363"],

Cell[TextData[{
 "We want to know how to efficiently build ",
 StyleBox["useful",
  FontSlant->"Italic"],
 " projection matrices. "
}], "ItemNumbered",
 CellChangeTimes->{{3.8467592757626677`*^9, 
  3.84675932144508*^9}},ExpressionUUID->"2163908e-9a17-4b3e-8a66-\
80835f2a01a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear Algebra: Eigenstuff", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}, {3.846760700320636*^9, 
  3.8467607095636463`*^9}},ExpressionUUID->"c904312e-b770-481e-84bd-\
a64d0c9f7cdb"],

Cell[TextData[{
 "In linear algebra you learned eigenvalue-eigenvector pairs of A satisfy\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", ".", "v"}], "=", 
    RowBox[{"\[Lambda]", " ", "v"}]}], TraditionalForm]],ExpressionUUID->
  "57c6d44c-f987-47b6-8ff4-dc297637793b"],
 ".\nYou did not learn how to compute them for large matrices! "
}], "Text",
 CellChangeTimes->{{3.846758706375594*^9, 3.8467587538151207`*^9}, {
  3.8467588236395116`*^9, 3.846758971339628*^9}, {3.846759020212946*^9, 
  3.846759262113787*^9}, {3.8467607156883707`*^9, 
  3.8467608256074038`*^9}},ExpressionUUID->"e3038d8a-e661-4720-8822-\
dee33edcfb62"],

Cell[TextData[{
 "You did learn that for real symmetric ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "m"}], TraditionalForm]],ExpressionUUID->
  "3af0a8c1-32b3-46e4-89d0-a67ccd51f32d"],
 " matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"A", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "f32180fb-126f-4318-bfd5-0de5e5ec6ef4"],
 ":"
}], "Text",
 CellChangeTimes->{{3.846758706375594*^9, 3.8467587538151207`*^9}, {
  3.8467588236395116`*^9, 3.846758971339628*^9}, {3.846759020212946*^9, 
  3.846759262113787*^9}, {3.8467607156883707`*^9, 
  3.846760922688015*^9}},ExpressionUUID->"bdf2e5b4-11f9-4e09-8da0-\
1c628c1d971b"],

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]], "Item",ExpressionUUID->
  "880e6aec-26be-48b0-91f6-dee9a070c283"],
 " eigenvalues ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "k"], TraditionalForm]],ExpressionUUID->
  "42011416-5657-40f4-bbb3-af945cc4ef26"],
 " were real."
}], "Item",
 CellChangeTimes->{{3.846758706375594*^9, 3.8467587538151207`*^9}, {
  3.8467588236395116`*^9, 3.846758971339628*^9}, {3.846759020212946*^9, 
  3.846759262113787*^9}, {3.8467607156883707`*^9, 
  3.846761019856619*^9}},ExpressionUUID->"90b74020-1d74-4206-8694-\
cad55ad99b65"],

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "4aafd854-fe51-4e50-b8aa-7d6d892f744b"],
 " eigenvectors ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "k"], " "}], TraditionalForm]],ExpressionUUID->
  "933641dc-9bc7-497f-af27-98fd63d7f815"],
 "could be chosen real and orthogonal! "
}], "Item",
 CellChangeTimes->{{3.846758706375594*^9, 3.8467587538151207`*^9}, {
  3.8467588236395116`*^9, 3.846758971339628*^9}, {3.846759020212946*^9, 
  3.846759262113787*^9}, {3.8467607156883707`*^9, 
  3.8467610336495333`*^9}},ExpressionUUID->"ef716ba5-fa20-41ba-8dfc-\
7bf44ebc1e60"]
}, Closed]],

Cell[CellGroupData[{

Cell["Projector: Definitions etc.", "Subsection",
 CellChangeTimes->{{3.8465886036957493`*^9, 3.846588613228965*^9}, {
   3.846590081767165*^9, 3.8465900846336513`*^9}, {3.8466689721145897`*^9, 
   3.84666897592218*^9}, {3.846670668239315*^9, 3.846670675127418*^9}, {
   3.846670718593*^9, 3.846670719856618*^9}, {3.846670942518662*^9, 
   3.8466709471577263`*^9}, {3.846672731263501*^9, 3.846672732014659*^9}, {
   3.8466757203363028`*^9, 3.8466757206982594`*^9}, {3.846675798202323*^9, 
   3.846675804012905*^9}, {3.8466758973627653`*^9, 3.8466758986830587`*^9}, {
   3.846676841206923*^9, 3.846676841542103*^9}, {3.846677370908235*^9, 
   3.846677403276561*^9}, {3.846678661565572*^9, 3.8466786765070143`*^9}, {
   3.8467593676587205`*^9, 3.8467593870521307`*^9}, 3.8467602925657125`*^9, {
   3.846760520520613*^9, 
   3.846760522351062*^9}},ExpressionUUID->"df32ca66-4a4c-40d8-b7c9-\
17a9d4cda6f3"],

Cell[TextData[{
 "An ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "m"}], TraditionalForm]],ExpressionUUID->
  "dfeffc0a-f8e7-4ec9-a150-9a26d271c8c2"],
 " matrix ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]],ExpressionUUID->
  "d3d26d0d-3ee3-48ea-9389-72a6548588ee"],
 " is a ",
 StyleBox["projector",
  FontVariations->{"Underline"->True}],
 " if ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["P", "2"], "=", 
    RowBox[{
     RowBox[{"P", ".", "P"}], "=", "P"}]}], TraditionalForm]],ExpressionUUID->
  "df72f57d-76c5-4a39-89a2-b8b5ae95bdd7"],
 ".  The fancy word for this property is \[OpenCurlyDoubleQuote]Idempotent\
\[CloseCurlyDoubleQuote]. It simply says multiplying by ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]],ExpressionUUID->
  "2e3e5ffd-ada8-42f0-8c91-424f3e9c9436"],
 " once is the same as doing it more than once!  "
}], "Text",
 CellChangeTimes->{{3.846759391701086*^9, 
  3.8467595522773156`*^9}},ExpressionUUID->"e7431805-16b9-49c0-a30d-\
1c8df7dffbf0"],

Cell[TextData[{
 "For a projector ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]],ExpressionUUID->
  "e0d73f39-90c9-4dab-9069-f9cffa106b0d"],
 " the ",
 StyleBox["complementary projector",
  FontVariations->{"Underline"->True}],
 " is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"I", "-", "P"}], TraditionalForm]],ExpressionUUID->
  "49e051b8-165d-45f3-a625-91bd78afd2d2"],
 " "
}], "Text",
 CellChangeTimes->{{3.846759561581052*^9, 3.8467596168792024`*^9}, {
  3.851875115693646*^9, 3.8518751159574823`*^9}, {3.913548973215322*^9, 
  3.913548980526675*^9}},ExpressionUUID->"bfcf968c-dac0-4e7f-8a61-\
27d5c970ea88"],

Cell[TextData[{
 "An ",
 StyleBox["orthogonal projector",
  FontVariations->{"Underline"->True}],
 " has ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "=", 
    SuperscriptBox["P", "*"]}], TraditionalForm]],ExpressionUUID->
  "b0e93e4f-bc9d-44e7-b317-40323db38774"]
}], "Text",
 CellChangeTimes->{{3.846759561581052*^9, 3.8467596168792024`*^9}, {
  3.846760346385092*^9, 
  3.8467604676682796`*^9}},ExpressionUUID->"7f3f46a5-58eb-43a8-896e-\
0cb8b7d4bb56"],

Cell[TextData[{
 "Eigenvalues of ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]],ExpressionUUID->
  "7a1893af-1666-477c-b5e7-3e9e7e5b4853"],
 " are all either 1 or 0. "
}], "Text",
 CellChangeTimes->{{3.846759561581052*^9, 3.8467596168792024`*^9}, {
  3.846760346385092*^9, 3.8467604676682796`*^9}, {3.8467605325212717`*^9, 
  3.8467605625462985`*^9}, {3.8467610592011786`*^9, 
  3.84676105993709*^9}},ExpressionUUID->"e20a2a99-8868-4810-8203-\
a217a7fc3aa1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Householder Reflector", "Subsection",
 CellChangeTimes->{{3.8465886036957493`*^9, 3.846588613228965*^9}, {
  3.846590081767165*^9, 3.8465900846336513`*^9}, {3.8466689721145897`*^9, 
  3.84666897592218*^9}, {3.846670668239315*^9, 3.846670675127418*^9}, {
  3.846670718593*^9, 3.846670719856618*^9}, {3.846670942518662*^9, 
  3.8466709471577263`*^9}, {3.846672731263501*^9, 3.846672732014659*^9}, {
  3.8466757203363028`*^9, 3.8466757206982594`*^9}, {3.846675798202323*^9, 
  3.846675804012905*^9}, {3.8466758973627653`*^9, 3.8466758986830587`*^9}, {
  3.846676841206923*^9, 3.846676841542103*^9}, {3.846677370908235*^9, 
  3.846677403276561*^9}, {3.846678661565572*^9, 3.8466786765070143`*^9}, {
  3.8467593676587205`*^9, 3.8467593870521307`*^9}, {3.846759636649461*^9, 
  3.8467596437730565`*^9}, {3.846759820416525*^9, 
  3.846759820604526*^9}},ExpressionUUID->"f8306d6e-3ab0-4292-a643-\
77ea9de1bbcd"],

Cell[TextData[{
 "The ",
 StyleBox["Householder Reflector",
  FontVariations->{"Underline"->True}],
 " associated with an orthogonal projector ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]],ExpressionUUID->
  "aec75d24-8036-4431-bae6-12e5e7a34e5b"],
 " is the Orthogonal matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "=", 
    RowBox[{"I", "-", 
     RowBox[{"2", 
      RowBox[{"P", "."}]}]}]}], TraditionalForm]],ExpressionUUID->
  "3f4ee7e8-660c-4143-a814-07d8e3092679"],
 "  "
}], "Text",
 CellChangeTimes->{{3.846759561581052*^9, 3.8467596168792024`*^9}, {
  3.846759659174985*^9, 3.846759712993941*^9}, {3.8467598125085216`*^9, 
  3.8467598152873616`*^9}, {3.852041749084217*^9, 3.852041750883213*^9}, {
  3.852041818263266*^9, 3.8520418202049985`*^9}, {3.852043021980394*^9, 
  3.852043023159691*^9}, {3.91354903855835*^9, 
  3.9135490881254663`*^9}},ExpressionUUID->"b07a03a8-a520-44b9-ac67-\
3cd864f484f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Tall Skinny A:
Orthogonal Projector onto Column Space of A\
\>", "Subsection",
 CellChangeTimes->{{3.8465886036957493`*^9, 3.846588613228965*^9}, {
  3.846590081767165*^9, 3.8465900846336513`*^9}, {3.8466689721145897`*^9, 
  3.84666897592218*^9}, {3.846670668239315*^9, 3.846670675127418*^9}, {
  3.846670718593*^9, 3.846670719856618*^9}, {3.846670942518662*^9, 
  3.8466709471577263`*^9}, {3.846672731263501*^9, 3.846672732014659*^9}, {
  3.8466757203363028`*^9, 3.8466757206982594`*^9}, {3.846675798202323*^9, 
  3.846675804012905*^9}, {3.8466758973627653`*^9, 3.8466758986830587`*^9}, {
  3.846676841206923*^9, 3.846676841542103*^9}, {3.846677370908235*^9, 
  3.846677403276561*^9}, {3.846678661565572*^9, 3.8466786765070143`*^9}, {
  3.8467593676587205`*^9, 3.8467593870521307`*^9}, {3.846759636649461*^9, 
  3.8467596437730565`*^9}, {3.846759820416525*^9, 3.846759820604526*^9}, {
  3.846759868600956*^9, 3.8467599445568447`*^9}, {3.846760473015874*^9, 
  3.846760476407309*^9}},ExpressionUUID->"8a8ab895-d54f-41d5-8b65-\
6993af5e690c"],

Cell[TextData[{
 "If ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "7b086bf5-f54a-4c26-8a92-b32c95aac941"],
 " is full rank then the orthogonal projector onto the column space of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "9a5c3e08-d59f-4c3e-bff0-42d1cd89cbec"],
 " is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "=", 
    RowBox[{"A", ".", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["A", "*"], ".", "A"}], ")"}], 
      RowBox[{"-", "1"}]], ".", 
     SuperscriptBox["A", "*"]}]}], TraditionalForm]],ExpressionUUID->
  "43f49510-7fb2-4318-86d5-0c3c5dacb51d"]
}], "Text",
 CellChangeTimes->{{3.846759561581052*^9, 3.8467596168792024`*^9}, {
  3.846759659174985*^9, 3.846759712993941*^9}, {3.8467598125085216`*^9, 
  3.8467598152873616`*^9}, {3.846759960787799*^9, 3.846760074043264*^9}, {
  3.846760154428651*^9, 3.846760158801769*^9}, {3.8467602775801563`*^9, 
  3.846760279987824*^9}},ExpressionUUID->"2817a0b5-4878-4a9e-8630-\
f9e3c46ac468"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Tall Skinny Q:
Orthogonal Projector onto Orthogonal basis\
\>", "Subsection",
 CellChangeTimes->{{3.8465886036957493`*^9, 3.846588613228965*^9}, {
   3.846590081767165*^9, 3.8465900846336513`*^9}, {3.8466689721145897`*^9, 
   3.84666897592218*^9}, {3.846670668239315*^9, 3.846670675127418*^9}, {
   3.846670718593*^9, 3.846670719856618*^9}, {3.846670942518662*^9, 
   3.8466709471577263`*^9}, {3.846672731263501*^9, 3.846672732014659*^9}, {
   3.8466757203363028`*^9, 3.8466757206982594`*^9}, {3.846675798202323*^9, 
   3.846675804012905*^9}, {3.8466758973627653`*^9, 3.8466758986830587`*^9}, {
   3.846676841206923*^9, 3.846676841542103*^9}, {3.846677370908235*^9, 
   3.846677403276561*^9}, {3.846678661565572*^9, 3.8466786765070143`*^9}, {
   3.8467593676587205`*^9, 3.8467593870521307`*^9}, {3.846759636649461*^9, 
   3.8467596437730565`*^9}, {3.846759820416525*^9, 3.846759820604526*^9}, {
   3.846759868600956*^9, 3.8467599445568447`*^9}, {3.846760473015874*^9, 
   3.846760476407309*^9}, 3.846761095626568*^9, {3.8467614115902576`*^9, 
   3.8467614176307545`*^9}, {3.851875203383872*^9, 
   3.851875205184342*^9}},ExpressionUUID->"0316f89c-512d-41b7-8ba4-\
a05e32b12b2f"],

Cell[TextData[{
 "If a Tall-Skinny ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "4c2a7a35-c855-4328-8be0-8abe3b65348c"],
 " matrix ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "ba9199a4-d6dd-441c-a405-86e1b9126f82"],
 " has orthogonal columns then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["Q", "*"], ".", "Q"}], "=", 
    SubscriptBox["I", "n"]}], TraditionalForm]],ExpressionUUID->
  "51dd9852-ed01-4c77-9340-fd5433fd0aec"],
 "! and the orthogonal projector is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "=", 
    RowBox[{"Q", ".", 
     SuperscriptBox["Q", "*"]}]}], TraditionalForm]],ExpressionUUID->
  "69a101bb-6d8b-455d-9516-3a616921430f"],
 "."
}], "Text",
 CellChangeTimes->{{3.846759561581052*^9, 3.8467596168792024`*^9}, {
  3.846759659174985*^9, 3.846759712993941*^9}, {3.8467598125085216`*^9, 
  3.8467598152873616`*^9}, {3.846759960787799*^9, 3.846760074043264*^9}, {
  3.846760154428651*^9, 3.846760158801769*^9}, {3.8467602775801563`*^9, 
  3.846760279987824*^9}, {3.8467614234795165`*^9, 
  3.84676160731423*^9}},ExpressionUUID->"e9ddbcf1-3f84-4bb9-be30-\
da3172cb2448"],

Cell[TextData[{
 "This has limited utility until we know how compute an orthogonal ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "fbba27ae-ec60-44d5-942f-2ff83ea3c284"]
}], "Text",
 CellChangeTimes->{{3.84676154791216*^9, 3.846761565202777*^9}, {
  3.8467616120199113`*^9, 
  3.8467616304127016`*^9}},ExpressionUUID->"0008d66e-88c5-4fb9-a7e6-\
6ae2a102c183"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computations", "Subsection",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQPcW5TPzkijeO64KXS4DoeT0WF0D0fbcpYHrHqubQ
D0C6oekvmK5Y0a75EUifF07RAtG3f17SB9FZmb/B9MMZF7xBtARPqg+InpWX
of0JSItVNIDpf4e4Fn4G0ioRYmA6r/LYKhC9I7NhNYg+Nlt7O4iedzsUTMvO
V9P9AqRfRBiCaWeB2HwQPe1mRjGI1pLcJPAVSJdZThAC0bYiXytkVr5x5Fud
WA2ik05MmQWiH+6pmA2idUJ6N4Jo94jJYJrDevJ2EL3mouBBEM3VpMAsC6TX
cvSC6c27TQRAdLVVP5gGAEk6pbw=
  "],ExpressionUUID->"22304631-56b1-40de-a5d0-ae0ed813fd0f"],

Cell["Checking some stuff. ", "Text",
 CellChangeTimes->{{3.8467605928008375`*^9, 
  3.846760612521632*^9}},ExpressionUUID->"3043691a-ea61-45e6-8932-\
6d9b078d98c8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"17", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"A", ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{
      RowBox[{"A", "\[Transpose]"}], ".", "A"}], "]"}], ".", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "m", "]"}], "-", 
    RowBox[{"2", "P"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Dimensions", "[", "P", "]"}], ",", 
   RowBox[{"Map", "[", 
    RowBox[{"Norm", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "-", 
        RowBox[{"P", ".", "P"}]}], ",", 
       RowBox[{"P", "-", 
        RowBox[{"P", "\[Transpose]"}]}], ",", 
       RowBox[{
        RowBox[{"H", ".", 
         RowBox[{"H", "\[Transpose]"}]}], "-", 
        RowBox[{"IdentityMatrix", "[", "m", "]"}]}]}], "}"}]}], "]"}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixPlot", "[", "P", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8467600802895713`*^9, 3.8467601314099607`*^9}, {
  3.846760162446851*^9, 3.8467602431941185`*^9}, {3.846760484068453*^9, 
  3.84676049359326*^9}, {3.8467605875982113`*^9, 3.846760587863773*^9}, {
  3.8467606301827497`*^9, 3.846760638105013*^9}, {3.846761745743805*^9, 
  3.846761762364184*^9}, {3.883498311438384*^9, 3.883498318564701*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"8b15d1a2-c605-43b6-8a07-5ae880008a92"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"17", ",", "17"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5.266438165120692`*^-16", ",", "1.5427601300194166`*^-16", ",", 
     "1.8737196060514945`*^-15"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.846760096824361*^9, 3.846760132118343*^9}, {
   3.846760163371955*^9, 3.8467602438512015`*^9}, {3.846760621368968*^9, 
   3.8467606385434923`*^9}, 3.846761762945194*^9, 3.8520422947000585`*^9, 
   3.8834981623140373`*^9, 3.883498320025445*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"0561e071-17c4-4b84-a5ba-43b23343d25c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"17", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"A", ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{
      RowBox[{"A", "\[Transpose]"}], ".", "A"}], "]"}], ".", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";", " ", 
  RowBox[{"H", "=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "m", "]"}], "-", 
    RowBox[{"2", "P"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Eigenvalues", ",", 
   RowBox[{"{", 
    RowBox[{"P", ",", "H"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8467600802895713`*^9, 3.8467601314099607`*^9}, {
   3.846760162446851*^9, 3.8467602431941185`*^9}, {3.846760484068453*^9, 
   3.84676049359326*^9}, {3.8467605875982113`*^9, 3.846760587863773*^9}, {
   3.8467606301827497`*^9, 3.846760665737282*^9}, {3.846761639790903*^9, 
   3.846761727977467*^9}, {3.8467617773724008`*^9, 3.8467617959220204`*^9}, 
   3.8834983386481667`*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"2a556117-580e-4a04-ad62-faba7a96701b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.0000000000000002`", ",", "1.0000000000000002`", ",", "1.`", ",", 
     "0.9999999999999998`", ",", "1.3319327031251497`*^-16", ",", 
     "1.0695279355137156`*^-16", ",", 
     RowBox[{"-", "5.002080362507238`*^-17"}], ",", 
     RowBox[{"-", "3.700403298387347`*^-17"}], ",", 
     RowBox[{"-", "3.129520555013334`*^-17"}], ",", 
     RowBox[{"-", "3.129520555013334`*^-17"}], ",", 
     "2.8712894283645185`*^-17", ",", "2.8712894283645185`*^-17", ",", 
     "2.3509928345664307`*^-17", ",", 
     RowBox[{"-", "2.051784177193781`*^-17"}], ",", 
     "1.3104704027886668`*^-17", ",", "1.0148866055290937`*^-17", ",", 
     "1.0148866055290937`*^-17"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0000000000000007`", ",", 
     RowBox[{"-", "1.0000000000000004`"}], ",", 
     RowBox[{"-", "1.0000000000000004`"}], ",", "1.0000000000000002`", ",", 
     "1.0000000000000002`", ",", 
     RowBox[{"-", "1.`"}], ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", 
     ",", "0.9999999999999999`", ",", "0.9999999999999998`", ",", 
     "0.9999999999999998`", ",", "0.9999999999999997`", ",", 
     "0.9999999999999996`", ",", 
     RowBox[{"-", "0.9999999999999994`"}], ",", "0.9999999999999993`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8467606662292604`*^9, 3.846761658752923*^9, {3.8467617129712524`*^9, 
   3.8467617286855993`*^9}, 3.846761796531239*^9, 3.852042383726866*^9, 
   3.852049808298947*^9, 3.8834983428452473`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"4601bb1e-32e5-446e-8dd1-6ee0c3731bb9"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["QRDecomposition", "Section",
 CellChangeTimes->{{3.8465884180627756`*^9, 3.846588429089326*^9}, {
  3.84666883912605*^9, 3.846668864267633*^9}, {3.846670417593573*^9, 
  3.846670436952243*^9}, {3.846672726384389*^9, 3.8466727270705147`*^9}, {
  3.8466757090828*^9, 3.846675717466256*^9}, {3.846758673014533*^9, 
  3.8467586795609393`*^9}, {3.91354876492236*^9, 3.913548776618065*^9}, {
  3.9135491467802477`*^9, 
  3.913549151972199*^9}},ExpressionUUID->"ce9659f7-3bfa-4381-a91e-\
90259a94bf6e"],

Cell[CellGroupData[{

Cell["Matrices with orthogonal columns are useful!", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}, {3.8467618957670603`*^9, 
  3.8467619360896053`*^9}},ExpressionUUID->"d0073533-1d40-4c73-9118-\
317d5fc15ff3"],

Cell[TextData[{
 "Our target is to construct an orthogonal basis for the column space of a \
Tall-Skinny ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "64c15270-cc71-426e-80db-1b6fedaf737e"],
 " matrix\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["a", "1"], "|", 
      SubscriptBox["a", "2"], "|", "\[Ellipsis]", "|", 
      SubscriptBox["a", "n"]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "34f434e8-b62b-410b-bee2-e917f0e80712"],
 ".\nThis basis is naturally represented by a Tall-Skinny ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "c8f2cf61-bf33-4c93-9d83-04b726a43e9b"],
 " matrix\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "=", 
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["q", "1"], "|", 
      SubscriptBox["q", "2"], "|", "\[Ellipsis]", "|", 
      SubscriptBox["q", "n"]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "d0dd6221-a51f-455e-9683-7c405413ac03"],
 ".\nWe will learn how to compute a QR decomposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "R"}]}], TraditionalForm]],ExpressionUUID->
  "b2b926ea-d2b7-4c8f-be1e-791fffb06bff"],
 " where the new matrix ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],ExpressionUUID->
  "ecb1bcf3-d4f6-4b0b-840d-94098ce6c32d"],
 " (which tells us how to combine the columns of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "7d86bd0e-7cbe-4177-b465-2e36150b3804"],
 " to compute ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "106088a7-3b2e-4c42-a6e1-c53c17bb57a2"],
 ") is upper triangular! "
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846758706375594*^9, 3.8467587538151207`*^9}, {
   3.8467588236395116`*^9, 3.846758971339628*^9}, {3.846759020212946*^9, 
   3.846759262113787*^9}, {3.846761943116433*^9, 3.84676210883329*^9}, {
   3.8467621424073515`*^9, 3.8467622702690773`*^9}, 3.8467623406216908`*^9, 
   3.8834985491067963`*^9},ExpressionUUID->"adbed981-d5eb-49f7-9fa0-\
a419e404c85f"],

Cell["\<\
Every software package has a QR decomposition.  Different packages return the \
bits in different ways! Always read the documentation and check! Mathematica \
returns Q on its side!\
\>", "Text",
 CellChangeTimes->{{3.8467623471859765`*^9, 3.846762426452746*^9}, {
  3.85187563331427*^9, 
  3.851875655028302*^9}},ExpressionUUID->"04775b4d-7115-4be4-9436-\
6e1d67a65d60"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"123", ",", "7"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q", ",", "R"}], "}"}], "=", 
    RowBox[{"QRDecomposition", "[", "A", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Mathematica", " ", "#$", 
    RowBox[{"#", "@", "$"}], " ", "returns", " ", "Q", " ", "on", " ", "it", 
    " ", "side"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"Q", "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "-", 
      RowBox[{"Q", ".", "R"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Q", "\[Transpose]"}], ".", "Q"}], "-", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"MatrixPlot", ",", 
   RowBox[{"{", 
    RowBox[{"A", ",", "Q", ",", "R"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.846762275345456*^9, 3.8467623298969088`*^9}, {
  3.846762429679415*^9, 3.8467624862192984`*^9}, {3.851875466544389*^9, 
  3.851875489388875*^9}, {3.8522204699374695`*^9, 3.8522204723809977`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"ca0e1d13-ffd8-445f-9f0a-8858f7ceec78"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6743085006774083`*^-15", ",", "6.859106298922317`*^-16"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8467623050484343`*^9, 3.846762330472226*^9}, {
   3.846762433556241*^9, 3.8467624868580556`*^9}, 3.8522134661241884`*^9, 
   3.8522204414879856`*^9, 3.8522204731296024`*^9, 3.8834987922490172`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"66c9201e-a2a3-42c7-b0ab-a879379e67f4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[RasterBox[CompressedData["
1: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
d2kkIojIpKtUDi6j+0YH1TDxPzjI45g=
     "], {{0, 0}, {7, 62}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{61.74796747967479, 
         FormBox["1", TraditionalForm]}, {37.048780487804876`, 
         FormBox["50", TraditionalForm]}, {0.25203252032520324`, 
         FormBox["123", TraditionalForm]}}, {{61.74796747967479, 
         FormBox["1", TraditionalForm]}, {37.048780487804876`, 
         FormBox["50", TraditionalForm]}, {0.25203252032520324`, 
         FormBox["123", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   GraphicsBox[RasterBox[CompressedData["
1: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
dpJP0HMW/gfYlBEq
     "], {{0, 0}, {7, 62}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{61.74796747967479, 
         FormBox["1", TraditionalForm]}, {37.048780487804876`, 
         FormBox["50", TraditionalForm]}, {0.25203252032520324`, 
         FormBox["123", TraditionalForm]}}, {{61.74796747967479, 
         FormBox["1", TraditionalForm]}, {37.048780487804876`, 
         FormBox["50", TraditionalForm]}, {0.25203252032520324`, 
         FormBox["123", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   GraphicsBox[RasterBox[CompressedData["
1:eJzNznlIkwEYBvDlLHNsQllJYMMyC9LogDKc89HMDK9clEdlupZgh7lS5xil
ldaQVZrTRi21YqKlJtEtCDOzMnRNKsmcustd3/fNaGJ2jYj8P4KiXnh4n+e/
3+K9eduy6TQazWs6P/rPe4//5QephKwmlRPt9A8RGfJhJCuZib7x/H/mUdcN
FSsq+hCgTc3ndo9CeflO9aKVBL7a+9bKd45hRZOou5zlwBmruTdVQv51z+mR
QEW8W4PSBN3z3Ew9hDN76wZnEiibuseXfiLhO6sy8PU6G3xqjs0P3TEIjjW9
UJzhhNhY/+XZFQpHg6+9vTHL8cc8jNItdpOrD2/a4pcYB0Zwf/topBePQC57
fUJ/iRP+eqHuAtuJOe2cDVFpBBLtXQGmNiNcl6SuBpkNl/LVYZ41BNYFsKSh
q0loxsYFRd1mpLgefdtc++y3PZyQzKzAEg3OLsw1TsqGYbpWtMx0ioBzQuOv
DHOiR1Gc7b2QgoTGX/C1zYYqVVkK8zqJNZMCTfQDC1SSlrmygle4o0z2a+yi
cPPtUoYslcDGDYJgLduMp+H6zu29JHjD3PQQoRXmDs3tl/EDv3QZJPNuxRre
TW8aLTwoseIJ2wpGpKc7kEXAsSqOHjGXgiid6chLolB/0nC99oodJ+pN/ke4
o0jQW5hmjh3NT5a/8AAJT1lxJ/05hZzqKd09MQmuLY133MMCRnmGXdqqhYvH
ydm1nMJVS0sn121DXZSpWrRfh489e4ZW7BtHUn4Hz7BAh0iVY0bL7K1IbrDu
eFxAoSR88vahlQ7ENFfI+X4G+H4uj1UrKURm9Zq71A7cPdAsunrRiN2HG+nN
TCeMDWUe+QdJlO/dSheTFmxaXeuR502gkiN3j0VTaHJrPX0ETpTFzFMXivV4
aE/pt8VZ4Vp2rjBnwIEq+UQNy04h3daqGDETmC1dlXTg/Bi+A7jsnjE=
     "], {{0, 0}, {7, 7}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{6.5, 
         FormBox["1", TraditionalForm]}, {5.5, 
         FormBox["2", TraditionalForm]}, {4.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {2.5, 
         FormBox["5", TraditionalForm]}, {1.5, 
         FormBox["6", TraditionalForm]}, {0.5, 
         FormBox["7", TraditionalForm]}}, {{6.5, 
         FormBox["1", TraditionalForm]}, {5.5, 
         FormBox["2", TraditionalForm]}, {4.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {2.5, 
         FormBox["5", TraditionalForm]}, {1.5, 
         FormBox["6", TraditionalForm]}, {0.5, 
         FormBox["7", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8467623050484343`*^9, 3.846762330472226*^9}, {
   3.846762433556241*^9, 3.8467624868580556`*^9}, 3.8522134661241884`*^9, 
   3.8522204414879856`*^9, 3.8522204731296024`*^9, 3.8834987923607097`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"13f2deb2-8b07-4aa9-ba87-f6076f3a4501"]
}, Open  ]],

Cell["\<\
We are going to learn one way the computer could do this.  Well actually we \
are going to learn a bunch but the first one is called the Gram-Schmidt \
process.\
\>", "Text",
 CellChangeTimes->{{3.846762132697706*^9, 3.846762135951541*^9}, {
  3.8467624988452873`*^9, 
  3.8467625839778557`*^9}},ExpressionUUID->"5c8476dc-d035-442c-9e64-\
5910a7edeb8e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gram-Schmidt: Idea", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}, {3.846760700320636*^9, 3.8467607095636463`*^9}, {
  3.8467625877455564`*^9, 3.8467625922734213`*^9}, {3.846763890848014*^9, 
  3.8467638918783283`*^9}},ExpressionUUID->"0114461c-fab5-401e-871a-\
10ac000b8fc7"],

Cell[TextData[{
 "The motto here is start at the very beginning of\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["a", "1"], "|", 
      SubscriptBox["a", "2"], "|", "\[Ellipsis]", "|", 
      SubscriptBox["a", "n"]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "41604f7a-5c16-43cf-9ef5-c5417f4ccf1e"],
 "\nand work through the columns!   "
}], "Text",
 CellChangeTimes->{{3.84676264392801*^9, 3.846762717783315*^9}, {
  3.883476565359091*^9, 
  3.8834765729483013`*^9}},ExpressionUUID->"1f3e13c9-dabe-4d80-9b0f-\
4daba8cf26f9"],

Cell[TextData[{
 "First, normalize the first column by dividing by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"||", 
    SubscriptBox["a", "1"], "||"}], TraditionalForm]],ExpressionUUID->
  "26301d79-4428-4b51-84d6-ef04e9ebf5f9"],
 " and define\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "1"], "=", 
    FractionBox[
     SubscriptBox["a", "1"], 
     RowBox[{"||", 
      SubscriptBox["a", "1"], "||"}]]}], TraditionalForm]],ExpressionUUID->
  "f52bda0d-b133-48be-a2f9-27af11fc595f"],
 "."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.8467627212958364`*^9, 
  3.846763093139288*^9}},ExpressionUUID->"b989e3c3-2c79-4db8-833e-\
606faee57c53"],

Cell[TextData[{
 "Next, project out the component of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "2"], TraditionalForm]],ExpressionUUID->
  "d685d5fd-1489-4cdd-bd08-e5c31bdc0413"],
 " in the direction of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "6aee3aed-e286-4bfe-ab5a-88da4b908f83"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "2"], "=", 
    RowBox[{
     SubscriptBox["a", "2"], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["a", "2"], ".", 
        SubscriptBox["q", "1"]}], ")"}], 
      SubscriptBox["q", "1"]}]}]}], TraditionalForm]],ExpressionUUID->
  "a2e11cb8-06cf-40f0-b2a8-4ad64bba60ba"],
 "\nand normalize\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "2"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "2"], "/"}], "||", 
     SubscriptBox["q", "2"], "||"}]}], TraditionalForm]],ExpressionUUID->
  "74fabe73-f208-47fd-b409-0e0661bc5b28"],
 ".\nNote we have recycled ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "2"], TraditionalForm]],ExpressionUUID->
  "d842ba11-3947-4771-a564-7ef0900d8ad7"],
 " repeatedly to accumulate the correct expression."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.8467627212958364`*^9, 
  3.8467631884436274`*^9}},ExpressionUUID->"8a51ba5c-d247-42cb-abfb-\
c468949934bb"],

Cell[TextData[{
 "The next step is more of the same but we need to get a bit more organized!  \
Pick the next column\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"w", "=", 
    SubscriptBox["a", "3"]}], TraditionalForm]],ExpressionUUID->
  "29a245a1-251f-4edf-8a6a-ed33c7651485"],
 "\nproject out the components in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "4ddb1fb9-a140-46ab-a9b8-a51d1b5537a8"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "2"], TraditionalForm]],ExpressionUUID->
  "0cf165de-60f3-4ebf-a3f8-d152104fb617"],
 "\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {"w", "=", 
      RowBox[{"w", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"w", ".", 
          SubscriptBox["q", "1"]}], ")"}], 
        SubscriptBox["q", "1"]}]}]},
     {"w", "=", 
      RowBox[{"w", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"w", ".", 
          SubscriptBox["q", "2"]}], ")"}], 
        SubscriptBox["q", "2"]}]}]}
    }], TraditionalForm]],ExpressionUUID->
  "5528f41e-82c5-4e17-a206-5c56a4e8cbae"],
 "\nand normalize\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "3"], "=", 
    RowBox[{
     RowBox[{"w", "/"}], "||", "w", "||"}]}], TraditionalForm]],
  ExpressionUUID->"cbf922bb-f915-4af7-afa8-a694b8810879"],
 ".\nI am using ",
 Cell[BoxData[
  FormBox["w", TraditionalForm]],ExpressionUUID->
  "31bc4949-7883-4bc3-b0ca-eccdd5610a1e"],
 " as mnemonic for work vector!"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.8467627212958364`*^9, 3.846763121000487*^9}, {
  3.8467632271707373`*^9, 3.8467634584743867`*^9}, {3.8467634993268323`*^9, 
  3.846763560738367*^9}, {3.8467636285392714`*^9, 
  3.846763643750461*^9}},ExpressionUUID->"1ea6b155-73fa-4a55-a2f7-\
abddeb698a49"],

Cell[TextData[{
 "The next step is more of the same but we need to get a bit more organized!  \
Pick the next column\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"w", "=", 
    SubscriptBox["a", "4"]}], TraditionalForm]],ExpressionUUID->
  "8cf2a11f-17d0-4dcd-b02e-17b0390250cc"],
 "\nproject out the components in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "309c3fe1-959a-47f0-87ea-782670bea14c"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "2"], TraditionalForm]],ExpressionUUID->
  "c41459e3-2576-4979-9c18-2fccd695854a"],
 "\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {"w", "=", 
      RowBox[{"w", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"w", ".", 
          SubscriptBox["q", "1"]}], ")"}], 
        SubscriptBox["q", "1"]}]}]},
     {"w", "=", 
      RowBox[{"w", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"w", ".", 
          SubscriptBox["q", "2"]}], ")"}], 
        SubscriptBox["q", "2"]}]}]},
     {"w", "=", 
      RowBox[{"w", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"w", ".", 
          SubscriptBox["q", "3"]}], ")"}], 
        SubscriptBox["q", "3"]}]}]}
    }], TraditionalForm]],ExpressionUUID->
  "286179db-2f46-446c-ae04-7ad334a96718"],
 "\nand normalize\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "4"], "=", 
    RowBox[{
     RowBox[{"w", "/"}], "||", "w", "||"}]}], TraditionalForm]],
  ExpressionUUID->"d8c8ab47-5101-4ee5-bdfd-3ef5a5d1e5a3"],
 "."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.8467627212958364`*^9, 3.846763121000487*^9}, {
  3.8467632271707373`*^9, 3.8467634584743867`*^9}, {3.8467634993268323`*^9, 
  3.846763560738367*^9}, {3.8467636285392714`*^9, 
  3.8467636941046095`*^9}},ExpressionUUID->"95fda020-fba7-45a9-acfd-\
85ae01e1bbbf"],

Cell["\<\
All we have to do is keep going until we run out of columns!  We are left \
with the tall-skinny matrix Q.  The only problem is we do not have the recipe \
for how we combined the columns: it is all stored in the inner products and \
scalings of the vectors. \
\>", "Text",
 CellChangeTimes->{{3.846763697145377*^9, 3.846763882258984*^9}, {
  3.8834766208318553`*^9, 
  3.88347664995932*^9}},ExpressionUUID->"c88cfaea-9220-4bb8-9d7b-\
b01cf72ffd60"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gram-Schmidt: Manual", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}, {3.846760700320636*^9, 3.8467607095636463`*^9}, {
  3.8467625877455564`*^9, 3.8467625922734213`*^9}, {3.846763890848014*^9, 
  3.846763922282195*^9}, {3.8467642119446635`*^9, 
  3.84676421442906*^9}},ExpressionUUID->"b0cc2b66-83e4-4376-a6aa-\
1b7eef6fb23c"],

Cell["\<\
Here is a hand walk through of for a three column matrix! I am saving the \
coefficients so that we can see where they go!\
\>", "Text",
 CellChangeTimes->{{3.8467641826220155`*^9, 3.8467642079006968`*^9}, {
  3.8467643746400757`*^9, 
  3.8467644017947073`*^9}},ExpressionUUID->"ef7e80b9-6f61-41d2-95fc-\
8bf47b78f0c7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"First", " ", "column"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"v", "=", 
    RowBox[{"A", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"Norm", "[", "v", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q1", " ", "=", 
    RowBox[{"v", "/", "c1"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"second", " ", "column"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c21", " ", "=", 
   RowBox[{"v", ".", "q1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"v", "-", 
    RowBox[{"c21", " ", "q1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2", "=", 
   RowBox[{"Norm", "[", "v", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q2", " ", "=", 
    RowBox[{"v", "/", "c2"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Third", " ", "column"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c31", " ", "=", 
   RowBox[{"v", ".", "q1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"v", "-", 
    RowBox[{"c31", " ", "q1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c32", " ", "=", 
   RowBox[{"v", ".", "q2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"v", "-", 
    RowBox[{"c32", " ", "q2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c3", "=", 
   RowBox[{"Norm", "[", "v", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q3", " ", "=", 
   RowBox[{"v", "/", "c3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyQ", "=", 
   RowBox[{"{", 
    RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"c1", ",", 
   RowBox[{"{", 
    RowBox[{"c21", ",", "c2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c31", ",", "c32", ",", "c3"}], "}"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.8467639306572237`*^9, 3.8467641776062603`*^9}, {
   3.8467642221950274`*^9, 3.8467643539107914`*^9}, 3.846764407546877*^9, {
   3.846764438391307*^9, 3.8467644433187313`*^9}, {3.8467645206527653`*^9, 
   3.8467645524084167`*^9}, {3.846932627457077*^9, 3.8469327077779217`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"e1bc5b4b-667b-48c2-8014-2c2ba957d3c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.1740622769820523`", ",", 
   RowBox[{"{", 
    RowBox[{"0.49414951500450177`", ",", "1.500242161359208`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.030338995151026567`", ",", 
     RowBox[{"-", "0.5491531214654278`"}], ",", "0.5307738350809634`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.846764444680108*^9, 3.8467644546819253`*^9}, 
   3.8467645530576353`*^9, {3.8469326731806126`*^9, 3.846932708979599*^9}, 
   3.8522138909691424`*^9, 3.852214000399694*^9, 3.852220703723531*^9, 
   3.883476658194118*^9, 3.88349923875744*^9, 3.8834992761619368`*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"23062bf8-a8d3-4428-b18b-1687f5d44e1f"]
}, Open  ]],

Cell["Lets compare to the built-in QR", "Text",
 CellChangeTimes->{{3.84676449268285*^9, 
  3.84676450647991*^9}},ExpressionUUID->"56da7002-83d8-4198-9fc3-\
bf08ecb04dfe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"BuiltInQ", ",", "BuiltInR"}], "}"}], "=", 
   RowBox[{"QRDecomposition", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", "BuiltInR"}], "Input",
 CellChangeTimes->{{3.8467639306572237`*^9, 3.8467641776062603`*^9}, {
   3.8467642221950274`*^9, 3.8467643539107914`*^9}, 3.846764407546877*^9, 
   3.846764438391307*^9, {3.8467644713780966`*^9, 3.8467644812610636`*^9}, {
   3.846764515232586*^9, 3.846764515711051*^9}, {3.846765244965356*^9, 
   3.8467652610129747`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"411f756e-13df-4db0-99bd-0f48ae5e72ed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.1740622769820523`"}], ",", 
     RowBox[{"-", "0.4941495150045019`"}], ",", 
     RowBox[{"-", "0.030338995151026504`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.500242161359208`", ",", 
     RowBox[{"-", "0.5491531214654279`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", 
     RowBox[{"-", "0.5307738350809635`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.846764329841936*^9, 3.8467643543923936`*^9}, {
   3.8467644082091722`*^9, 3.8467644828839874`*^9}, 3.8467645165461707`*^9, 
   3.8467645572640905`*^9, {3.8467652523496046`*^9, 3.8467652625807514`*^9}, 
   3.84693269584309*^9, 3.852213942168642*^9, 3.8522140057572365`*^9, 
   3.852220753870897*^9, 3.8834766736948147`*^9, {3.8834992587383757`*^9, 
   3.8834992803629856`*^9}},
 CellLabel->"Out[65]=",ExpressionUUID->"600baee5-cf0c-4e28-81c3-6c351141627f"]
}, Open  ]],

Cell["\<\
Our numbers match (except for the signs) and I think we can work out how to \
construct R \
\>", "Text",
 CellChangeTimes->{{3.84676264392801*^9, 3.846762717783315*^9}, {
  3.8467645709387155`*^9, 3.846764584461121*^9}, {3.8467647454544935`*^9, 
  3.846764799170443*^9}, {3.8834766805978403`*^9, 
  3.883476697058469*^9}},ExpressionUUID->"d86c426e-16be-411b-be20-\
0e5565bb6bb2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gram-Schmidt: Script", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}, {3.846760700320636*^9, 3.8467607095636463`*^9}, {
  3.8467625877455564`*^9, 3.8467625922734213`*^9}, {3.846763890848014*^9, 
  3.846763922282195*^9}, {3.8467642119446635`*^9, 3.84676421442906*^9}, {
  3.846764813698187*^9, 
  3.846764823045749*^9}},ExpressionUUID->"a6577eb3-7daa-4ab0-aece-\
92054417915c"],

Cell["Here is a preliminary script!", "Text",
 CellChangeTimes->{{3.8467641826220155`*^9, 3.8467642079006968`*^9}, {
  3.8467643746400757`*^9, 3.8467644017947073`*^9}, {3.846764830963998*^9, 
  3.846764844313582*^9}},ExpressionUUID->"c28b2bc3-3ce7-4e69-99c5-\
46a569202406"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"14", ",", "12"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Set", " ", "up", " ", "Storage"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Q", "=", 
    RowBox[{"0", "*", "A"}]}], ";", " ", 
   RowBox[{"R", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Loop", " ", "through", " ", "columns"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Grab", " ", "next", " ", "column"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"A", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"project", " ", "out", " ", "previous", " ", "columns"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"R", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"v", ".", 
          RowBox[{"Q", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"v", "-", 
          RowBox[{
           RowBox[{"R", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"Q", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}]}]}]}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Scale", " ", "and", " ", "save", " ", "orthogonalized", " ", 
       "columns"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R", "\[LeftDoubleBracket]", 
       RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Norm", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Q", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"v", "/", 
       RowBox[{"R", "\[LeftDoubleBracket]", 
        RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]}]}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "that", " ", "we", " ", "computed", " ", "a", " ", "QR", " ",
     "Decomposition"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{"Norm", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "-", 
       RowBox[{"Q", ".", "R"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Q", "\[Transpose]"}], ".", "Q"}], "-", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"OrthogonalMatrixQ", "[", "Q", "]"}], ",", 
     RowBox[{"UpperTriangularMatrixQ", "[", "R", "]"}]}], "}"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", "R", "]"}]}], "Input",
 CellChangeTimes->{{3.8467639306572237`*^9, 3.8467641776062603`*^9}, {
   3.8467642221950274`*^9, 3.8467643539107914`*^9}, 3.846764407546877*^9, {
   3.846764438391307*^9, 3.8467644433187313`*^9}, {3.8467645206527653`*^9, 
   3.8467645524084167`*^9}, {3.846764850477963*^9, 3.846765222381673*^9}, {
   3.846765289526026*^9, 3.846765348035287*^9}, {3.8467654543593063`*^9, 
   3.846765601160556*^9}, {3.846836389385992*^9, 3.846836406948695*^9}, {
   3.85221444735531*^9, 3.8522144494643764`*^9}, {3.8522209161196156`*^9, 
   3.85222092102075*^9}, {3.8522210678366776`*^9, 3.8522210689464054`*^9}, {
   3.852221272911091*^9, 3.8522212748827333`*^9}, 3.883670420451086*^9, {
   3.883670458922999*^9, 3.883670461206525*^9}, {3.8836705536633515`*^9, 
   3.8836705846268015`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"800666c3-dfd4-4d64-abe4-e1d9cc600fa0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.589776029259315`*^-16", ",", "2.495743351675009`*^-15"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8467652924417367`*^9, 3.846765348787366*^9}, {
   3.846765462632497*^9, 3.8467656017568426`*^9}, 3.84683642173706*^9, 
   3.852214258937074*^9, {3.852214436434308*^9, 3.852214449785695*^9}, 
   3.852221220321108*^9, 3.8522212756194887`*^9, 3.8834994593884225`*^9, 
   3.883670301174326*^9, 3.883670428978836*^9, 3.883670461902035*^9, {
   3.883670554775975*^9, 3.8836705851912584`*^9}},
 CellLabel->"Out[37]=",ExpressionUUID->"aaa116e6-3b06-4fc1-ae0f-d865a6ef486d"],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1: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
   "], {{0, 0}, {12, 12}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{11.5, 
       FormBox["1", TraditionalForm]}, {7.5, 
       FormBox["5", TraditionalForm]}, {0.5, 
       FormBox["12", TraditionalForm]}}, {{11.5, 
       FormBox["1", TraditionalForm]}, {7.5, 
       FormBox["5", TraditionalForm]}, {0.5, 
       FormBox["12", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {11.5, 
       FormBox["12", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {11.5, 
       FormBox["12", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.8467652924417367`*^9, 3.846765348787366*^9}, {
   3.846765462632497*^9, 3.8467656017568426`*^9}, 3.84683642173706*^9, 
   3.852214258937074*^9, {3.852214436434308*^9, 3.852214449785695*^9}, 
   3.852221220321108*^9, 3.8522212756194887`*^9, 3.8834994593884225`*^9, 
   3.883670301174326*^9, 3.883670428978836*^9, 3.883670461902035*^9, {
   3.883670554775975*^9, 3.883670585305149*^9}},
 CellLabel->"Out[38]=",ExpressionUUID->"4687baa7-3578-4c30-8676-b2e6e804b087"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Gram-Schmidt: Function", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}, {3.846760700320636*^9, 3.8467607095636463`*^9}, {
  3.8467625877455564`*^9, 3.8467625922734213`*^9}, {3.846763890848014*^9, 
  3.846763922282195*^9}, {3.8467642119446635`*^9, 3.84676421442906*^9}, {
  3.846764813698187*^9, 3.846764823045749*^9}, {3.8467656434229403`*^9, 
  3.8467656445521955`*^9}},ExpressionUUID->"8fca6c79-85dd-4694-b9ca-\
4e8b19db9b03"],

Cell["Here is a function to hide all the crud!", "Text",
 CellChangeTimes->{{3.846765720774468*^9, 3.84676572900263*^9}, {
  3.846833840474065*^9, 
  3.8468338433970947`*^9}},ExpressionUUID->"870d43ab-d39d-4188-b3ae-\
818f3e218f8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyGramSchmidt", "[", "A_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n", ",", "Q", ",", "R", ",", "v"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Set", " ", "up", " ", "Storage"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"0", "*", "A"}]}], ";", " ", 
     RowBox[{"R", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Loop", " ", "through", " ", "columns"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Grab", " ", "next", " ", "column"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"project", " ", "out", " ", "previous", " ", "columns"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"R", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"v", ".", 
             RowBox[{"Q", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"v", "=", 
            RowBox[{"v", "-", 
             RowBox[{
              RowBox[{"R", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], " ", 
              RowBox[{"Q", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}]}]}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Scale", " ", "and", " ", "save", " ", "orthogonalized", " ", 
          "columns"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"Norm", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Q", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"v", "/", 
          RowBox[{"R", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q", ",", "R"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8467656515499015`*^9, 3.846765707864214*^9}, {
   3.84683375127451*^9, 3.8468337517627373`*^9}, {3.8468364571277122`*^9, 
   3.846836476148757*^9}, 3.8522225424731083`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"7ee6952d-6437-4e30-9544-0390d915566d"],

Cell["Here is a test", "Text",
 CellChangeTimes->{{3.8467641826220155`*^9, 3.8467642079006968`*^9}, {
  3.8467643746400757`*^9, 3.8467644017947073`*^9}, {3.846764830963998*^9, 
  3.846764844313582*^9}, {3.8467657394475007`*^9, 
  3.846765739886342*^9}},ExpressionUUID->"908f49ed-0649-4c65-84f8-\
7231dfea1105"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"700", ",", "450"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q", ",", "R"}], "}"}], "=", 
    RowBox[{"MyGramSchmidt", "[", "A", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q2", ",", "R2"}], "}"}], "=", 
    RowBox[{"QRDecomposition", "[", "A", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{
    RowBox[{"Z", "=", 
     RowBox[{"Q2", "\[Transpose]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "that", " ", "we", " ", "computed", " ", "a", " ", "QR", " ",
     "Decomposition"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "-", 
      RowBox[{"Q", ".", "R"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Q", "\[Transpose]"}], ".", "Q"}], "-", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"UpperTriangularMatrixQ", "[", "R", "]"}]}], "Input",
 CellChangeTimes->{{3.8467639306572237`*^9, 3.8467641776062603`*^9}, {
   3.8467642221950274`*^9, 3.8467643539107914`*^9}, 3.846764407546877*^9, {
   3.846764438391307*^9, 3.8467644433187313`*^9}, {3.8467645206527653`*^9, 
   3.8467645524084167`*^9}, {3.846764850477963*^9, 3.846765222381673*^9}, {
   3.846765289526026*^9, 3.846765348035287*^9}, {3.8467654543593063`*^9, 
   3.846765601160556*^9}, {3.8467657495456624`*^9, 3.8467657966108394`*^9}, {
   3.8522217047735033`*^9, 3.8522218008823423`*^9}, {3.852221928510585*^9, 
   3.852221933282794*^9}, {3.883670922143078*^9, 3.8836709241827745`*^9}, {
   3.883671018602208*^9, 3.8836710661574197`*^9}, {3.883671185388757*^9, 
   3.8836712055100665`*^9}},ExpressionUUID->"06fc10c8-6265-48a7-a94a-\
c81dda26476a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.2263281`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.852221954912343*^9, 3.883670926727399*^9, 3.8836709760947733`*^9, {
   3.883671020863285*^9, 3.8836710780662127`*^9}},
 CellLabel->"Out[77]=",ExpressionUUID->"51adb17b-03dc-45d0-aa8a-bd08c83ca9dd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.017821`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.852221954912343*^9, 3.883670926727399*^9, 3.8836709760947733`*^9, {
   3.883671020863285*^9, 3.883671078131406*^9}},
 CellLabel->"Out[78]=",ExpressionUUID->"9107f728-857d-4122-a34e-c4d81c0f8d33"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0009307`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.852221954912343*^9, 3.883670926727399*^9, 3.8836709760947733`*^9, {
   3.883671020863285*^9, 3.883671078133998*^9}},
 CellLabel->"Out[79]=",ExpressionUUID->"11712611-23fc-4931-bb82-24395331b49d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.017602374908764`*^-14", ",", "2.047651136155052`*^-15"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.852221954912343*^9, 3.883670926727399*^9, 3.8836709760947733`*^9, {
   3.883671020863285*^9, 3.883671078191553*^9}},
 CellLabel->"Out[80]=",ExpressionUUID->"da6ef9f8-e540-4374-b271-e124a9dc51df"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.852221954912343*^9, 3.883670926727399*^9, 3.8836709760947733`*^9, {
   3.883671020863285*^9, 3.883671078196227*^9}},
 CellLabel->"Out[81]=",ExpressionUUID->"0deb7e29-ef80-4bfd-9f61-5fff39ace033"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Efficiency: Math Libraries", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}, {3.846760700320636*^9, 3.8467607095636463`*^9}, {
  3.8467625877455564`*^9, 3.8467625922734213`*^9}, {3.846763890848014*^9, 
  3.846763922282195*^9}, {3.8467642119446635`*^9, 3.84676421442906*^9}, {
  3.846764813698187*^9, 3.846764823045749*^9}, {3.8467656434229403`*^9, 
  3.8467656445521955`*^9}, {3.846833864197178*^9, 3.8468338671411343`*^9}, {
  3.846833905140592*^9, 
  3.846833910892561*^9}},ExpressionUUID->"76cec2be-7791-499b-a16a-\
25146eac08c4"],

Cell["\<\
The built in QR decomposition is going to be MUCH faster than any code we \
write. The reason is that the basic QR computation is the foundation for a \
lot of other fancier computations.  As a result, a substantial effort has \
been made to make it as efficient as possible.  This includes economizing \
storage and computation and communication.\
\>", "Text",
 CellChangeTimes->{{3.846765720774468*^9, 3.84676572900263*^9}, {
  3.846833840474065*^9, 3.8468338433970947`*^9}, {3.846833873644988*^9, 
  3.8468340724936237`*^9}, {3.8518757104023438`*^9, 
  3.851875717044406*^9}},ExpressionUUID->"74b639f6-380b-4af7-b486-\
79d63b035f89"],

Cell["\<\
All the higher level tools rely on libraries of math functions.  The lowest \
level is called BLAS for Basic Linear Algebra Subprograms which are designed \
to squeeze every possible bit of performance out of all sorts of hardware.  \
\>", "Text",
 CellChangeTimes->{{3.84683407517903*^9, 
  3.84683419605682*^9}},ExpressionUUID->"14692e71-cd16-41ac-a897-\
0606ad96d47d"],

Cell[TextData[{
 "One of the reasons Julia is fast (the Julia folks use the word performant) \
and one of the reasons we are going to look at Julia is that it makes it easy \
to access these libraries. ",
 StyleBox["Good code uses these libraries!",
  FontColor->RGBColor[1, 0, 0]]
}], "Text",
 CellChangeTimes->{{3.846834221165494*^9, 3.846834293799685*^9}, 
   3.846834362331464*^9, {3.8834767869800587`*^9, 
   3.883476804141344*^9}},ExpressionUUID->"91e113dc-7c3b-4f09-8c3e-\
690b3d287ce3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1500", ",", "111"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q", ",", "R"}], "}"}], "=", 
    RowBox[{"MyGramSchmidt", "[", "A", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q", ",", "R"}], "}"}], "=", 
    RowBox[{"QRDecomposition", "[", "A", "]"}]}], ";"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8467639306572237`*^9, 3.8467641776062603`*^9}, {
   3.8467642221950274`*^9, 3.8467643539107914`*^9}, 3.846764407546877*^9, {
   3.846764438391307*^9, 3.8467644433187313`*^9}, {3.8467645206527653`*^9, 
   3.8467645524084167`*^9}, {3.846764850477963*^9, 3.846765222381673*^9}, {
   3.846765289526026*^9, 3.846765348035287*^9}, {3.8467654543593063`*^9, 
   3.846765601160556*^9}, {3.8467657495456624`*^9, 3.8467657966108394`*^9}, {
   3.8522149041114936`*^9, 3.8522149648661137`*^9}, 3.8834767518316383`*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"df8bbb95-9715-454f-aadf-bca172e00f18"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.515625`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.852214916774312*^9, 3.8522149625022097`*^9}, 
   3.8522150046815577`*^9, {3.883476737599891*^9, 3.8834767528557115`*^9}, {
   3.8836714921464014`*^9, 3.8836714966448755`*^9}},
 CellLabel->"Out[88]=",ExpressionUUID->"88c62381-7c1b-4699-a9e6-3546741fc959"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.015625`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.852214916774312*^9, 3.8522149625022097`*^9}, 
   3.8522150046815577`*^9, {3.883476737599891*^9, 3.8834767528557115`*^9}, {
   3.8836714921464014`*^9, 3.8836714966532717`*^9}},
 CellLabel->"Out[89]=",ExpressionUUID->"152f5d26-0416-4eef-84a7-f41e6551cedc"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Math Libraries", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
   3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
   3.8467587419585333`*^9}, {3.846760700320636*^9, 3.8467607095636463`*^9}, {
   3.8467625877455564`*^9, 3.8467625922734213`*^9}, {3.846763890848014*^9, 
   3.846763922282195*^9}, {3.8467642119446635`*^9, 3.84676421442906*^9}, {
   3.846764813698187*^9, 3.846764823045749*^9}, {3.8467656434229403`*^9, 
   3.8467656445521955`*^9}, {3.846833864197178*^9, 3.8468338671411343`*^9}, {
   3.846833905140592*^9, 3.846833910892561*^9}, 
   3.8468347633459063`*^9},ExpressionUUID->"38d79272-1c73-4c04-a4ea-\
5d4bf98e09ba"],

Cell["\<\
Math libraries (BLAS, MKL, ...) are portable, fast, and an all round good \
idea!\
\>", "Text",
 CellChangeTimes->{{3.846765720774468*^9, 3.84676572900263*^9}, {
  3.846833840474065*^9, 3.8468338433970947`*^9}, {3.846833873644988*^9, 
  3.8468340724936237`*^9}, {3.846834776714039*^9, 
  3.846834853296599*^9}},ExpressionUUID->"c83f9386-24d8-45c2-b3d5-\
3351a7af5b30"],

Cell["\<\
We are about to see that subtle algorithmic differences can significantly \
impact stability and performance!\
\>", "Text",
 CellChangeTimes->{{3.8468348587455587`*^9, 
  3.8468349341603193`*^9}},ExpressionUUID->"41c034f7-d1f8-409f-8527-\
a1d635d00699"],

Cell["\<\
Real QR codes would never do GS (7.1) when MGS (8.1) is better and almost the \
same amount of work. Both treat R as the main product and Q as a byproduct.\
\>", "Text",
 CellChangeTimes->{{3.84683407517903*^9, 3.84683419605682*^9}, {
  3.846834943456018*^9, 3.8468349879138613`*^9}, {3.8523649515187116`*^9, 
  3.8523650420139046`*^9}, {3.852365199699083*^9, 
  3.8523652007799654`*^9}},ExpressionUUID->"e260bb19-13ae-4d40-a9bc-\
c8f856c0b2cc"],

Cell["\<\
Most of the time Q is the thing folks want and R is just thrown away. In this \
case the Householder algorithm we are going to talk about later which targets \
Q gives more orthogonal matrices.\
\>", "Text",
 CellChangeTimes->{{3.8523650488502116`*^9, 3.8523651513791494`*^9}, {
  3.913549605157681*^9, 
  3.913549640515304*^9}},ExpressionUUID->"7e6434a9-c424-48ad-89cc-\
dc8a4c27178d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modified Gram-Schmidt", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}, {3.846760700320636*^9, 3.8467607095636463`*^9}, {
  3.8467625877455564`*^9, 3.8467625922734213`*^9}, {3.846763890848014*^9, 
  3.846763922282195*^9}, {3.8467642119446635`*^9, 3.84676421442906*^9}, {
  3.846764813698187*^9, 3.846764823045749*^9}, {3.8467656434229403`*^9, 
  3.8467656445521955`*^9}, {3.84683473367485*^9, 
  3.8468347383059807`*^9}},ExpressionUUID->"97b689af-798b-4fa4-812f-\
3178db238fc7"],

Cell["Here is our implementation of GS 7.1", "Text",
 CellChangeTimes->{{3.846834698441736*^9, 3.846834719754471*^9}, {
  3.846834992656495*^9, 
  3.846834993584051*^9}},ExpressionUUID->"b0e757b4-3b30-4a68-884c-\
382bc891e716"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyGramSchmidt", "[", "A_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n", ",", "Q", ",", "R", ",", "v"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Set", " ", "up", " ", "Storage"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"0", "*", "A"}]}], ";", " ", 
     RowBox[{"R", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Loop", " ", "through", " ", "columns"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Grab", " ", "next", " ", "column"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"project", " ", "out", " ", "previous", " ", "columns"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"R", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"Q", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ".", 
             RowBox[{"A", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"v", "=", 
            RowBox[{"v", "-", 
             RowBox[{
              RowBox[{"R", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], " ", 
              RowBox[{"Q", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}]}]}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Scale", " ", "and", " ", "save", " ", "orthogonalized", " ", 
          "columns"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"Norm", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Q", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"v", "/", 
          RowBox[{"R", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]}]}], ";"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q", ",", "R"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8467656515499015`*^9, 3.846765707864214*^9}, {
  3.84683375127451*^9, 3.8468337517627373`*^9}, {3.8468364571277122`*^9, 
  3.846836476148757*^9}, {3.913549922670175*^9, 3.9135499366844273`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"89cd7a86-dde4-4298-9a67-5fa9634b9867"],

Cell["Here is an implementation of Modified GS 8.1", "Text",
 CellChangeTimes->{{3.846835023787282*^9, 3.846835036346856*^9}, {
  3.8468365488074427`*^9, 
  3.846836548982708*^9}},ExpressionUUID->"b3a762f7-da54-4d29-971f-\
2aa7fda3959b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyModifiedGramSchmidt", "[", "A_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n", ",", "Q", ",", "R", ",", "V"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"V", "=", "A"}], ";", 
     RowBox[{"Q", "=", 
      RowBox[{"0", "*", "A"}]}], ";", " ", 
     RowBox[{"R", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"R", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"Norm", "[", 
          RowBox[{"V", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Q", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"V", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "/", 
          RowBox[{"R", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"R", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"Q", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ".", 
             RowBox[{"V", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"V", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"V", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{
              RowBox[{"R", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], " ", 
              RowBox[{"Q", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}]}]}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q", ",", "R"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8467656515499015`*^9, 3.846765707864214*^9}, {
  3.84683375127451*^9, 3.8468337517627373`*^9}, {3.8468364571277122`*^9, 
  3.846836476148757*^9}, {3.846836814115588*^9, 3.846836871576635*^9}, {
  3.846836933291901*^9, 3.846837090148581*^9}, {3.846837128247136*^9, 
  3.846837183609017*^9}, {3.846837446330399*^9, 3.846837482800641*^9}, {
  3.846837524148149*^9, 3.846837551549325*^9}, {3.8468378364516478`*^9, 
  3.8468378505927753`*^9}, {3.846837977569462*^9, 3.846837984279319*^9}, {
  3.846838103717701*^9, 3.8468381124815407`*^9}, {3.8468381493629932`*^9, 
  3.846838149714014*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"b1d6ceb3-01c6-4978-abba-e696d3740791"],

Cell["Testing and comparing the two versions! Both work.", "Text",
 CellChangeTimes->{{3.84683723786547*^9, 3.846837259128289*^9}, {
  3.8468382241655073`*^9, 3.846838232636698*^9}, {3.8468387780960617`*^9, 
  3.846838792816424*^9}, {3.8469328072911587`*^9, 
  3.8469328101459885`*^9}},ExpressionUUID->"66eb4571-a05f-4b88-b580-\
69df004570f7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"400", ",", "399"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{
        RowBox[{"AbsoluteTiming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Q", ",", "R"}], "}"}], "=", 
           RowBox[{"qr", "[", "A", "]"}]}], ";"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      RowBox[{"{", 
       RowBox[{"qr", ",", "time", ",", 
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Q", "\[Transpose]"}], ".", "Q"}], "-", 
          RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}], ",", 
        RowBox[{"Norm", "[", 
         RowBox[{"A", "-", 
          RowBox[{"Q", ".", "R"}]}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"qr", ",", 
       RowBox[{"{", 
        RowBox[{"MyGramSchmidt", ",", "MyModifiedGramSchmidt"}], "}"}]}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Algorithm\>\"", ",", "\"\<Sec\>\"", ",", "\"\<Orth Res\>\"", ",", 
        "\"\<Residual\>\""}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.846837266604294*^9, 3.846837341315323*^9}, {
  3.8468374145638027`*^9, 3.846837416485979*^9}, {3.846837561322863*^9, 
  3.8468375845563927`*^9}, {3.8468376177792597`*^9, 3.8468377106943417`*^9}, {
  3.8468378058281918`*^9, 3.846837806352317*^9}, {3.846837862441346*^9, 
  3.846837912621393*^9}, {3.846838059705749*^9, 3.846838070646092*^9}, {
  3.846838160189015*^9, 3.846838464239791*^9}, {3.8469327748876905`*^9, 
  3.8469327813160224`*^9}, {3.851875960786418*^9, 3.851875984506371*^9}, {
  3.8518761089632072`*^9, 3.851876223429838*^9}, {3.851876292140052*^9, 
  3.851876325233396*^9}, {3.852386901368766*^9, 3.8523869959636865`*^9}, {
  3.8834771900963564`*^9, 3.8834772037556086`*^9}, {3.913549831953661*^9, 
  3.913549832527995*^9}, {3.9135499891801147`*^9, 3.913550030362281*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"312b82ce-fd75-4028-b143-0f86cc9e3918"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"Algorithm\"\>",
       HoldForm], 
      TagBox["\<\"Sec\"\>",
       HoldForm], 
      TagBox["\<\"Orth Res\"\>",
       HoldForm], 
      TagBox["\<\"Residual\"\>",
       HoldForm]},
     {"MyGramSchmidt", "0.771077`", "1.7885654683396337`*^-12", 
      "1.4677973326441156`*^-14"},
     {"MyModifiedGramSchmidt", "1.1246`", "2.0747476320156298`*^-13", 
      "1.457697821653048`*^-14"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {
     None, {"Algorithm", "Sec", "Orth Res", "Residual"}}]]]], "Output",
 CellChangeTimes->{
  3.8523870003392515`*^9, 3.883476932030363*^9, 3.8834772053985453`*^9, 
   3.883672042720066*^9, {3.913549722619021*^9, 3.913549729532825*^9}, 
   3.913549844542153*^9, {3.91354997889675*^9, 3.9135500387667*^9}},
 CellLabel->
  "Out[32]//TableForm=",ExpressionUUID->"f91a278b-6bab-414a-926e-\
3979df6d9447"]
}, Open  ]],

Cell["Just for comparison!", "Text",
 CellChangeTimes->{{3.846838480877927*^9, 
  3.846838492342313*^9}},ExpressionUUID->"0ac8a84d-4c77-4456-8d6d-\
a67c44b92bb8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"time", "=", 
   RowBox[{
    RowBox[{"AbsoluteTiming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q", ",", "R"}], "}"}], "=", 
       RowBox[{"QRDecomposition", "[", "A", "]"}]}], ";"}], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Q", "=", 
    RowBox[{"Q", "\[Transpose]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"time", ",", 
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Q", "\[Transpose]"}], ".", "Q"}], "-", 
     RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}], ",", 
   RowBox[{"Norm", "[", 
    RowBox[{"A", "-", 
     RowBox[{"Q", ".", "R"}]}], "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.846838501535293*^9, 3.8468385909171257`*^9}, {
   3.846841965393587*^9, 3.8468419754037943`*^9}, {3.85187627473284*^9, 
   3.851876276137361*^9}, {3.851876342700591*^9, 3.851876355440237*^9}, 
   3.851876491357464*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"c02faaf0-51a2-4224-bc1c-f9fe44c95ae8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.018914`", ",", "4.551566532700787`*^-15", ",", 
   "5.1045986656019566`*^-14"}], "}"}]], "Output",
 CellChangeTimes->{{3.846838510966564*^9, 3.8468385916684093`*^9}, {
   3.846841954431088*^9, 3.846841975778646*^9}, 3.846932790845515*^9, 
   3.851876277017208*^9, 3.851876413601968*^9, 3.851876500134737*^9, 
   3.8523872930404243`*^9, 3.8834769464398146`*^9, 3.913550046714129*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"597b6d39-eb3a-4c0d-b089-ec78b0e98247"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modified vs Classical Gram-Schmidt vs QR implementation", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}, {3.846760700320636*^9, 3.8467607095636463`*^9}, {
  3.8467625877455564`*^9, 3.8467625922734213`*^9}, {3.846763890848014*^9, 
  3.846763922282195*^9}, {3.8467642119446635`*^9, 3.84676421442906*^9}, {
  3.846764813698187*^9, 3.846764823045749*^9}, {3.8467656434229403`*^9, 
  3.8467656445521955`*^9}, {3.84683473367485*^9, 3.8468347383059807`*^9}, {
  3.846838828729298*^9, 3.846838831912829*^9}, {3.913549526028751*^9, 
  3.913549539140708*^9}},ExpressionUUID->"ae003b2b-c819-48ea-a09f-\
c814529daf69"],

Cell["\<\
One of them is better! Neither is the best! The issues are subtle but real!  \
There are two main problems: small entries in R can be computed inaccurately \
and the Q could lose orthogonality due to only 16 digits of computer \
arithmetic!  MKS is better at resolving R accurately (we will pay more \
attention to this later) but both struggle to generate fully accurate \
orthogonal matrices  when the going gets tough\
\>", "Text",
 CellChangeTimes->{{3.846834698441736*^9, 3.846834719754471*^9}, {
  3.846834992656495*^9, 3.846834993584051*^9}, {3.8468388385929832`*^9, 
  3.8468388445688353`*^9}, {3.846838892553521*^9, 3.846838915817556*^9}, {
  3.846839060891328*^9, 3.846839154699402*^9}, {3.8469332849597325`*^9, 
  3.846933355569313*^9}, {3.851876016080203*^9, 3.8518760572308817`*^9}, {
  3.9135495499000587`*^9, 
  3.913549573204239*^9}},ExpressionUUID->"e6fdff34-0f62-463e-82f5-\
7e81a6d404b6"],

Cell["\<\
Random matrices are unlikely to highlight these problems.  We need to make \
tricksy matrices. \
\>", "Text",
 CellChangeTimes->{{3.8468392253750477`*^9, 3.846839256556739*^9}, {
  3.846839759822864*^9, 
  3.846839775270204*^9}},ExpressionUUID->"b1d73711-fb3b-4305-b645-\
27bf10e92a02"],

Cell[CellGroupData[{

Cell["Nearly Parallel Columns ", "Subsubsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
  3.846841365233275*^9, 
  3.8468413765615253`*^9}},ExpressionUUID->"1d884874-4ed9-474c-9ebc-\
b3ddd1db5d3b"],

Cell["\<\
Both of our Gram-Schmidt algorithms struggle with nearly parallel columns.   \
The important thing is that better algorithms are used in built-in QR calls. \
\>", "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
  3.8469333722095346`*^9, 
  3.846933456294175*^9}},ExpressionUUID->"5aad33d4-520e-417f-bdc3-\
01754289fd08"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "32"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]", " ", "=", "0.0000001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u", ",", "v"}], "}"}], "=", " ", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"u", ",", "v"}], "]"}], "+", 
    RowBox[{"\[Epsilon]", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixPlot", "[", "A", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q", ",", "R"}], "}"}], "=", 
   RowBox[{"QRDecomposition", "[", "A", "]"}]}], ";", 
  RowBox[{"Q", "=", 
   RowBox[{"Q", "\[Transpose]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Qgs", ",", "Rgs"}], "}"}], "=", 
   RowBox[{"MyGramSchmidt", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Qmgs", ",", "Rmgs"}], "}"}], "=", 
   RowBox[{"MyModifiedGramSchmidt", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[Transpose]"}]}], "-", 
          RowBox[{"IdentityMatrix", "[", "m", "]"}]}], "]"}], ",", 
        RowBox[{"Norm", "[", 
         RowBox[{"A", "-", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
         "]"}]}], "}"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q", ",", "R"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Qgs", ",", "Rgs"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Qmgs", ",", "Rmgs"}], "}"}]}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<QR\>\"", ",", "\"\<GS\>\"", ",", "\"\<MGS\>\""}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\"\<||Q.Q\[Transpose]-I||\>\"", ",", "\"\<||A-Q.R||\>\""}], 
       "}"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8468389997114983`*^9, 3.846839019217857*^9}, {
   3.846839160756357*^9, 3.8468392191895733`*^9}, {3.846839783432633*^9, 
   3.8468399204248657`*^9}, {3.8468400453055897`*^9, 3.846840074585751*^9}, {
   3.846840134681684*^9, 3.846840340804895*^9}, 3.846840413094673*^9, {
   3.846841390238985*^9, 3.846841740353991*^9}, {3.846841783565114*^9, 
   3.8468418957052183`*^9}, {3.846932933371254*^9, 3.846933261831498*^9}, {
   3.851878928165082*^9, 3.85187898869608*^9}, {3.851879023892612*^9, 
   3.851879129409175*^9}, 3.852387521290205*^9, {3.8523875991080403`*^9, 
   3.8523876374342012`*^9}, {3.8523877100278444`*^9, 
   3.8523877464978495`*^9}, {3.883476996999087*^9, 3.883477108717985*^9}, {
   3.8834771411859884`*^9, 3.8834771416080103`*^9}, {3.8834772439066296`*^9, 
   3.8834772444856534`*^9}, {3.883477286619887*^9, 3.883477372740509*^9}, {
   3.8836721831560907`*^9, 3.883672212103499*^9}, {3.883672252544086*^9, 
   3.88367225280085*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"95924ea1-6de5-42ee-be64-ece45bed4e4c"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"||Q.Q\[Transpose]-I||\"\>",
       HoldForm], 
      TagBox["\<\"||A-Q.R||\"\>",
       HoldForm]},
     {
      TagBox["\<\"QR\"\>",
       HoldForm], "1.5685678618968215`*^-15", "6.165558050457658`*^-15"},
     {
      TagBox["\<\"GS\"\>",
       HoldForm], "3.131251087900877`*^-8", "8.942984351522827`*^-16"},
     {
      TagBox["\<\"MGS\"\>",
       HoldForm], "3.131251087900877`*^-8", "8.942984351522827`*^-16"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, 
      "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{"QR", "GS", "MGS"}, {
      "||Q.Q\[Transpose]-I||", "||A-Q.R||"}}]]]], "Output",
 CellChangeTimes->{{3.846841833012285*^9, 3.846841858868346*^9}, 
   3.846841896571064*^9, 3.84693283581735*^9, {3.8469331241193385`*^9, 
   3.8469331649037824`*^9}, {3.846933199215472*^9, 3.846933223796196*^9}, {
   3.846933256678528*^9, 3.84693326387796*^9}, 3.851876079563039*^9, 
   3.851876635984374*^9, {3.851879052844522*^9, 3.851879075400175*^9}, {
   3.851879106741527*^9, 3.851879130128931*^9}, {3.8523875998912697`*^9, 
   3.8523876381889424`*^9}, {3.852387712314814*^9, 3.8523877472164702`*^9}, {
   3.883476981633308*^9, 3.8834770272631626`*^9}, {3.8834770885478573`*^9, 
   3.8834771108941154`*^9}, 3.8834772405888443`*^9, {3.883477340474697*^9, 
   3.8834773733959*^9}, {3.883672189057679*^9, 3.8836722126676364`*^9}, 
   3.8836722535078087`*^9},
 CellLabel->
  "Out[122]//TableForm=",ExpressionUUID->"998936aa-f99a-498c-b890-\
b5b28c6a3c12"]
}, Open  ]],

Cell[TextData[{
 "This better algorithm designs and accumulates a sequence of orthogonal \
matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Q", "1"], ",", 
    SubscriptBox["Q", "2"], ",", "\[Ellipsis]"}], TraditionalForm]],
  ExpressionUUID->"f01914da-8fc1-4877-98d5-78272bb1b081"],
 " at each stage!  The simplest version of this is a \
\[OpenCurlyDoubleQuote]Householder\[CloseCurlyDoubleQuote] reflector."
}], "Text",
 CellChangeTimes->{{3.8469338830029125`*^9, 
  3.846934066446987*^9}},ExpressionUUID->"2e1f4dab-1e03-45d3-bdc8-\
9cbf4b3eb668"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Householder Refelector", "Subsection",
 CellChangeTimes->{{3.846677344345183*^9, 3.846677356916223*^9}, {
  3.84675870063579*^9, 3.8467587032474008`*^9}, {3.8467587405099*^9, 
  3.8467587419585333`*^9}, {3.846760700320636*^9, 3.8467607095636463`*^9}, {
  3.8467625877455564`*^9, 3.8467625922734213`*^9}, {3.846763890848014*^9, 
  3.846763922282195*^9}, {3.8467642119446635`*^9, 3.84676421442906*^9}, {
  3.846764813698187*^9, 3.846764823045749*^9}, {3.8467656434229403`*^9, 
  3.8467656445521955`*^9}, {3.84683473367485*^9, 3.8468347383059807`*^9}, {
  3.846838828729298*^9, 3.846838831912829*^9}, {3.913549526028751*^9, 
  3.913549539140708*^9}, {3.9149300548435993`*^9, 
  3.9149300686188545`*^9}},ExpressionUUID->"f4609e26-d615-451c-b151-\
0e5f442a6b13"],

Cell[TextData[{
 "We have already seen that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", "=", 
    RowBox[{"I", "-", 
     RowBox[{"2", "P"}]}]}], TraditionalForm]],ExpressionUUID->
  "f9e7c589-4a75-4ebd-92cb-ff424dd339ef"],
 " is a symmetric orthogonal matrix if P is an orthogonal projection.   Since \
it is straight-forward lets do it again.  Assume ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "=", 
    RowBox[{"P", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "257049d7-81a1-4349-8154-1c499dac2b60"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", ".", "P"}], "=", "P"}], TraditionalForm]],ExpressionUUID->
  "e8202414-9988-4ffd-908e-4c717dc7ac17"],
 " then\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"H", "\[Transpose]"}], ".", "H"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"I", "-", 
         RowBox[{"2", "P"}]}], ")"}], "\[Transpose]"}], ".", 
      RowBox[{"(", 
       RowBox[{"I", "-", 
        RowBox[{"2", "P"}]}], ")"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"I", "-", 
         RowBox[{"2", "P"}]}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"I", "-", 
         RowBox[{"2", "P"}]}], ")"}]}], "=", 
      RowBox[{
       RowBox[{"I", "-", 
        RowBox[{"2", "P"}], "-", 
        RowBox[{"2", "P"}], "+", 
        RowBox[{"4", 
         RowBox[{"P", ".", "P"}]}]}], "=", 
       RowBox[{
        RowBox[{"I", "-", 
         RowBox[{"4", "P"}], "+", 
         RowBox[{"4", "p"}]}], "=", "I"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"1ecb3561-fc63-41e6-b356-e66959486368"],
 ".\nA Householder reflection chooses the first projection ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "1"], TraditionalForm]],ExpressionUUID->
  "78cfec24-692d-48fd-84b8-396edb6172d6"],
 " so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "1"], "=", 
    RowBox[{"I", "-", 
     RowBox[{"2", 
      SubscriptBox["P", "1"]}]}]}], TraditionalForm]],ExpressionUUID->
  "08283817-821a-4d12-a40a-55a3f5690889"],
 "satisfies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["H", "1"], ".", 
     SubscriptBox["a", "1"]}], "=", 
    RowBox[{"\[PlusMinus]", 
     RowBox[{"||", 
      SubscriptBox["a", "1"], "||", 
      SubscriptBox["e", "1"]}]}]}], TraditionalForm]],ExpressionUUID->
  "96895254-2f71-42fc-ba53-347e47ccd363"],
 ". You then repeat  the process (with some bookkeeping) until you run out of \
columns!"
}], "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 
   3.8469353408127766`*^9},ExpressionUUID->"34b0a18e-986b-4cbd-8acd-\
3db773ef752e"],

Cell[TextData[{
 "Given ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "7c75434b-208e-4b1d-98d9-47547f43f1ed"],
 " we need to choose ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]],ExpressionUUID->
  "6c1286fa-e6b5-4955-8e55-1ef54681199c"],
 " to make \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"I", "-", 
       RowBox[{"2", " ", "P"}]}], ")"}], ".", "a"}], "=", 
    RowBox[{"\[PlusMinus]", 
     RowBox[{"||", "a", "||", 
      SubscriptBox["e", "1"]}]}]}], TraditionalForm]],ExpressionUUID->
  "6e398447-c000-44a0-9138-c31bcafd63b0"],
 "\nor equivalently\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"P", ".", "a"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "a"}], "\[PlusMinus]"}], "||", "a", "||", 
     SubscriptBox["e", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "e6e3eaaf-dd68-4e2f-a125-dd75a0249807"],
 "\nor equivalently\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"P", ".", "a"}]}], "=", 
    RowBox[{
     RowBox[{"a", "\[MinusPlus]"}], "||", "a", "||", 
     SubscriptBox["e", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "3124c3fc-d489-460a-a48c-e0ae704b5514"],
 "\nIf ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],ExpressionUUID->
  "1c1eaa35-24b8-435d-a37a-f75fc987286c"],
 " is a unit vector the projection ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "=", 
    RowBox[{"I", "-", 
     RowBox[{"v", "\[CircleTimes]", "v"}]}]}], TraditionalForm]],
  ExpressionUUID->"f55e6849-00ea-4c7e-aadd-6b9b1f920222"],
 " has ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "-", "1"}], TraditionalForm]],ExpressionUUID->
  "84052d59-28c9-4a04-95ed-61bef4145e33"],
 " Degrees Of Freedom (DOF). It is possible to choose ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],ExpressionUUID->
  "18903750-c22f-41ec-b101-9d2400895685"],
 " to do what we want!  We want ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],ExpressionUUID->
  "aae5f91e-e276-482c-a2a4-50596dcb3e6b"],
 " to satisfy\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"I", "-", 
        RowBox[{"v", "\[CircleTimes]", "v"}]}], ")"}], ".", "a"}]}], "=", 
    RowBox[{
     RowBox[{"a", "\[MinusPlus]"}], "||", "a", "||", 
     SubscriptBox["e", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "528472c3-60ef-44f3-88b2-38cce82a03bb"],
 "\nor equivalently\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "a"}], "-", 
     RowBox[{"2", "v", " ", 
      RowBox[{"(", 
       RowBox[{"v", ".", "a"}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{"a", "\[MinusPlus]"}], "||", "a", "||", 
     SubscriptBox["e", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "d6971205-b65b-4b02-bd9a-5576d2946dc6"],
 "\nor equivalently\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], "v", " ", 
     RowBox[{"(", 
      RowBox[{"v", ".", "a"}], ")"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "a"}], "\[MinusPlus]"}], "||", "a", "||", 
      RowBox[{
       SubscriptBox["e", "1"], " ", "\[DoubleLongRightArrow]", " ", 
       RowBox[{"v", "(", 
        RowBox[{"v", ".", "a"}], ")"}]}]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[PlusMinus]"}], "||", "a", "||", 
        SubscriptBox["e", "1"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"a7fd80a1-d428-41a9-b364-f3c9d4557cb5"],
 "\nIn words, ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],ExpressionUUID->
  "7cb6891c-4915-44b6-93e1-5830462f838b"],
 " is a unit vector parallel to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"a", "\[PlusMinus]"}], "||", "a", "||", 
    SubscriptBox["e", "1"]}], TraditionalForm]],ExpressionUUID->
  "c4b023e3-2456-4b22-9294-cdf9ba309206"],
 ".\n\nIt is easy to check that this works."
}], "Text",
 CellChangeTimes->{{3.846934311769712*^9, 3.8469344896884375`*^9}, {
  3.8469345536116276`*^9, 3.8469346138535595`*^9}, {3.8469346472876625`*^9, 
  3.846934711904707*^9}, {3.8469347976115527`*^9, 3.8469348300645943`*^9}, {
  3.8469350254896955`*^9, 3.846935213724557*^9}, {3.8469353044298973`*^9, 
  3.846935738156933*^9}, {3.8469357815515995`*^9, 3.8469357833754406`*^9}, {
  3.846936020157773*^9, 3.8469360247196536`*^9}, {3.846936184717481*^9, 
  3.846936197569708*^9}, {3.8523880721963453`*^9, 3.8523880721963453`*^9}, {
  3.852463480048267*^9, 3.852463484748486*^9}, {3.8524635378230677`*^9, 
  3.852463548607829*^9}},ExpressionUUID->"c7ca9a0c-2184-4154-993d-\
1ad86e4a20a4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "=", "a"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
   RowBox[{
    RowBox[{"v", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
    RowBox[{"Norm", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"Normalize", "[", "v", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "m", "]"}], "-", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"v", ",", "v"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "m", "]"}], "-", " ", 
    RowBox[{"2", " ", "P"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"H", ".", 
    RowBox[{"H", "\[Transpose]"}]}], " ", "-", 
   RowBox[{"IdentityMatrix", "[", "m", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{"H", ".", "a"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8469344920592456`*^9, 3.846934549496911*^9}, {
   3.846934695265825*^9, 3.84693478417249*^9}, {3.8469348408859897`*^9, 
   3.8469348959831905`*^9}, {3.846935793743067*^9, 3.8469360029439135`*^9}, {
   3.84693604642768*^9, 3.846936076847455*^9}, {3.852463597709271*^9, 
   3.852463609771864*^9}, {3.852645123539444*^9, 3.8526451968861046`*^9}, {
   3.8526521161357856`*^9, 3.8526521799026585`*^9}, 3.8838445164833093`*^9, {
   3.8838448542839575`*^9, 3.8838448985449796`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"a3327748-2e8a-451f-af3b-6ce7a6b4e070"],

Cell[BoxData["9.25563700681522`*^-16"], "Output",
 CellChangeTimes->{{3.8469347456744127`*^9, 3.846934784853061*^9}, {
   3.8469348749702806`*^9, 3.846934897011094*^9}, {3.8469359227697563`*^9, 
   3.846936003979722*^9}, {3.846936047516919*^9, 3.8469360774412975`*^9}, 
   3.8518791590911217`*^9, {3.8524636035558443`*^9, 3.852463610367593*^9}, {
   3.8526450996076574`*^9, 3.852645197423024*^9}, {3.8526521043989124`*^9, 
   3.852652180332286*^9}, 3.88347739011048*^9, {3.883844491890283*^9, 
   3.8838445252133656`*^9}, {3.883844893691965*^9, 3.883844899362171*^9}},
 CellLabel->"Out[64]=",ExpressionUUID->"df9132db-376d-4f57-bf02-6db599a83cc7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.1504485568413823`"}], ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8469347456744127`*^9, 3.846934784853061*^9}, {
   3.8469348749702806`*^9, 3.846934897011094*^9}, {3.8469359227697563`*^9, 
   3.846936003979722*^9}, {3.846936047516919*^9, 3.8469360774412975`*^9}, 
   3.8518791590911217`*^9, {3.8524636035558443`*^9, 3.852463610367593*^9}, {
   3.8526450996076574`*^9, 3.852645197423024*^9}, {3.8526521043989124`*^9, 
   3.852652180332286*^9}, 3.88347739011048*^9, {3.883844491890283*^9, 
   3.8838445252133656`*^9}, {3.883844893691965*^9, 3.883844899370162*^9}},
 CellLabel->"Out[65]=",ExpressionUUID->"b69b6844-51a6-4c1f-b25f-12afad7a91cd"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Householder QR (lecture 10)", "Section",
 CellChangeTimes->{{3.8465884180627756`*^9, 3.846588429089326*^9}, {
  3.84666883912605*^9, 3.846668864267633*^9}, {3.846670417593573*^9, 
  3.846670436952243*^9}, {3.846672726384389*^9, 3.8466727270705147`*^9}, {
  3.8466757090828*^9, 3.846675717466256*^9}, {3.846758673014533*^9, 
  3.8467586795609393`*^9}, {3.846761881784243*^9, 3.8467618862742233`*^9}, {
  3.8469363463111053`*^9, 3.846936358196007*^9}, {3.914930347891659*^9, 
  3.914930355539194*^9}},ExpressionUUID->"d74c6881-be7d-4792-bd37-\
6a586fef0485"],

Cell[CellGroupData[{

Cell["\<\
Householder Reflector
Matrix Functions \
\>", "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
   3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
   3.8469335254269605`*^9}, {3.8469372186478972`*^9, 3.84693725068496*^9}, {
   3.9149304971810927`*^9, 3.9149304973683453`*^9}, 
   3.914930549272145*^9},ExpressionUUID->"b7acec07-0a09-4a83-80a7-\
89636d0b0313"],

Cell[TextData[{
 "If ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],ExpressionUUID->
  "477d6f68-b42a-41f7-9f34-2144f7f2e7ab"],
 " is a unit vector parallel to \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"sign", "(", 
     RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ")"}], "||", "a", "||", 
    RowBox[{
     SubscriptBox["e", "1"], "+", "a"}]}], TraditionalForm]],ExpressionUUID->
  "f0fd717b-2f4c-43e1-aadf-3378ccbf566f"],
 "\nthen the orthogonal matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "=", 
    RowBox[{"I", "-", 
     RowBox[{"2", " ", 
      RowBox[{"v", "\[CircleTimes]", "v"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"b6aa5ffd-78e1-49d8-be21-8b28c27718fb"],
 " satisfies\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Q", ".", "a"}], "=", 
    RowBox[{"||", "a", "||", 
     SubscriptBox["e", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "a8c966da-8edc-4d6c-a3f4-d6c002e8744a"],
 "\nIn other words, Q rotates the vector ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "0fdeb38b-595e-44c8-aca9-b9943c657cab"],
 " to align with the vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]],ExpressionUUID->
  "c5816e55-74fb-4e1f-95f0-449d89fade5c"],
 ". "
}], "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}},ExpressionUUID->"02cc558b-0d68-4ea7-ac19-\
ac5fccf288e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HouseVec", "[", "a_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", "a"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+=", 
      RowBox[{
       RowBox[{"Sign", "[", 
        RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], 
       RowBox[{"Norm", "[", "a", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "/", 
      RowBox[{"Norm", "[", "v", "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HouseMat", "[", "a_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"HouseVec", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"Length", "[", "a", "]"}], "]"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"v", ",", "v"}], "]"}]}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.852652481943019*^9, 3.852652485802258*^9}, {3.852652528051162*^9, 
  3.8526525335935163`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"8aed62a9-14a6-4cee-8493-5bef2ab3aeaf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "23"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"HouseMat", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"Q", ".", 
    RowBox[{"Q", "\[Transpose]"}]}], " ", "-", 
   RowBox[{"IdentityMatrix", "[", "m", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{"Q", ".", "a"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8469344920592456`*^9, 3.846934549496911*^9}, {
  3.846934695265825*^9, 3.84693478417249*^9}, {3.8469348408859897`*^9, 
  3.8469348959831905`*^9}, {3.846935793743067*^9, 3.8469360029439135`*^9}, {
  3.84693604642768*^9, 3.846936076847455*^9}, {3.846936965909218*^9, 
  3.846937023968395*^9}, {3.8469371785953503`*^9, 3.8469372092136116`*^9}, {
  3.852645821644829*^9, 3.852645866066623*^9}, {3.8841026447511578`*^9, 
  3.884102644907821*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"ded16b89-239b-45d2-9e7e-559579845caf"],

Cell[BoxData["8.729067052853047`*^-16"], "Output",
 CellChangeTimes->{{3.8469347456744127`*^9, 3.846934784853061*^9}, {
   3.8469348749702806`*^9, 3.846934897011094*^9}, {3.8469359227697563`*^9, 
   3.846936003979722*^9}, {3.846936047516919*^9, 3.8469360774412975`*^9}, 
   3.846936977602109*^9, {3.846937019399043*^9, 3.846937024637398*^9}, {
   3.846937199885892*^9, 3.8469372098126545`*^9}, {3.8526458084559917`*^9, 
   3.852645872849594*^9}, 3.8526526421536818`*^9, 3.8841025894072027`*^9, 
   3.88410264573911*^9, 3.91493038860645*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"81d5ea21-51ad-402b-b56e-d17d888fdf59"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.7470373156727685`"}], ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8469347456744127`*^9, 3.846934784853061*^9}, {
   3.8469348749702806`*^9, 3.846934897011094*^9}, {3.8469359227697563`*^9, 
   3.846936003979722*^9}, {3.846936047516919*^9, 3.8469360774412975`*^9}, 
   3.846936977602109*^9, {3.846937019399043*^9, 3.846937024637398*^9}, {
   3.846937199885892*^9, 3.8469372098126545`*^9}, {3.8526458084559917`*^9, 
   3.852645872849594*^9}, 3.8526526421536818`*^9, 3.8841025894072027`*^9, 
   3.88410264573911*^9, 3.91493038860645*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"96a2b429-6d4e-44ba-bdaa-0144aa080cc0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Householder Reflector
Action Functions \
\>", "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
   3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
   3.8469335254269605`*^9}, {3.8469372186478972`*^9, 
   3.8469372557172794`*^9}, {3.914930445306966*^9, 3.9149304471604347`*^9}, 
   3.914930487732974*^9},ExpressionUUID->"f903db84-4b9d-4620-a1ff-\
9eee48f96d57"],

Cell["\<\
There is no need to build the Householder matrix.  All we need to be able to \
do is apply the matrix to a vector x. \
\>", "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}, {3.846937265493534*^9, 3.846937331605727*^9}, {
   3.8469374675167007`*^9, 3.846937467905089*^9}, {3.846997349464962*^9, 
   3.8469973750898113`*^9}, 
   3.846997922783347*^9},ExpressionUUID->"ba4ec5ca-f217-4401-a93d-\
c8ebcb64c4c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HouseActionVec", "[", 
   RowBox[{"x_", ",", "a_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"HouseVec", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "-", 
      RowBox[{"2", " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{"v", ".", "x"}], ")"}]}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.846937334732747*^9, 3.846937390283722*^9}, {3.8469384128336287`*^9, 
  3.8469384133697815`*^9}, {3.846997913942161*^9, 3.8469979182321243`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"7a6700b5-b206-4e8e-9154-420f2015fbbb"],

Cell["As always TEST!", "Text",
 CellChangeTimes->{{3.846997389733158*^9, 
  3.846997408281502*^9}},ExpressionUUID->"d950ca1b-0cb7-472c-9535-\
9c5adfe20f29"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "12467"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "a"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Q", "=", 
    RowBox[{"HouseMat", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"Q", ".", "x"}], ";"}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HouseActionVec", "[", 
    RowBox[{"x", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8469344920592456`*^9, 3.846934549496911*^9}, {
  3.846934695265825*^9, 3.84693478417249*^9}, {3.8469348408859897`*^9, 
  3.8469348959831905`*^9}, {3.846935793743067*^9, 3.8469360029439135`*^9}, {
  3.84693604642768*^9, 3.846936076847455*^9}, {3.846936965909218*^9, 
  3.846937023968395*^9}, {3.8469371785953503`*^9, 3.8469372092136116`*^9}, {
  3.8469374172100105`*^9, 3.846937433066861*^9}, {3.846938419410689*^9, 
  3.8469384200015383`*^9}, {3.846997937325851*^9, 3.8469981314106503`*^9}, {
  3.852646072571396*^9, 3.8526460731410913`*^9}, {3.8841028833717575`*^9, 
  3.884102969822586*^9}, {3.8841030206745524`*^9, 3.8841030217040253`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"cb519017-f697-4c4a-a508-ae16aaad098e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.1280073`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.884102938052385*^9, 3.884102982236786*^9}, 
   3.8841030256216135`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"e1fc4895-e4e6-4a48-93be-c9d3ffce8bc8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0003506`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.884102938052385*^9, 3.884102982236786*^9}, 
   3.884103025629099*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"fa125682-004d-4f64-95b5-b6a7713e841a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Householder QR:
Script Version 1\
\>", "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
   3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
   3.8469335254269605`*^9}, {3.8469372186478972`*^9, 
   3.8469372557172794`*^9}, {3.8469375026313*^9, 3.846937508278796*^9}, {
   3.846937553989224*^9, 3.8469375682672977`*^9}, {3.846938893485902*^9, 
   3.8469388943058777`*^9}, {3.8469391846402254`*^9, 3.8469391856207337`*^9}, 
   3.8469995795065403`*^9, {3.847003188285324*^9, 
   3.847003189781329*^9}},ExpressionUUID->"4b283f6b-3554-41ca-a3b8-\
f015b0f92b63"],

Cell["\<\
Here is a manual reduction of a Tall Skinny matrix A to upper triangular \
using Householder reflections. We are writing over the top of A to save \
space.  The fancy word for this is an \[OpenCurlyDoubleQuote]in-place\
\[CloseCurlyDoubleQuote] computation.\
\>", "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}, {3.846937265493534*^9, 3.846937331605727*^9}, {
   3.8469374675167007`*^9, 3.846937467905089*^9}, {3.846937515791397*^9, 
   3.8469375232198505`*^9}, {3.8469380625211287`*^9, 3.846938170660471*^9}, {
   3.8469384910505347`*^9, 
   3.8469385428820353`*^9}},ExpressionUUID->"61957444-2cad-436f-aadb-\
98b7e1cd9c0c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A0", "=", 
   RowBox[{"A", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q", ",", "R"}], "}"}], "=", 
   RowBox[{"QRDecomposition", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", 
      RowBox[{"-", "1"}]}], ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", 
      RowBox[{"-", "1"}]}], ",", "1"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"HouseActionVec", "[", 
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", 
        RowBox[{"-", "1"}]}], ",", "1"}], "\[RightDoubleBracket]"}], ",", 
     "a1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", 
      RowBox[{"-", "1"}]}], ",", "2"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"HouseActionVec", "[", 
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", 
        RowBox[{"-", "1"}]}], ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     "a1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", 
      RowBox[{"-", "1"}]}], ",", "3"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"HouseActionVec", "[", 
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", 
        RowBox[{"-", "1"}]}], ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     "a1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixPlot", "[", 
   RowBox[{
    RowBox[{"Chop", "[", "A", "]"}], ",", 
    RowBox[{"Mesh", "->", "All"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", "=", 
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"2", ";;", 
      RowBox[{"-", "1"}]}], ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"2", ";;", 
      RowBox[{"-", "1"}]}], ",", "2"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"HouseActionVec", "[", 
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"2", ";;", 
        RowBox[{"-", "1"}]}], ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     "a2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"2", ";;", 
      RowBox[{"-", "1"}]}], ",", "3"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"HouseActionVec", "[", 
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"2", ";;", 
        RowBox[{"-", "1"}]}], ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     "a2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixPlot", "[", 
   RowBox[{
    RowBox[{"Chop", "[", "A", "]"}], ",", 
    RowBox[{"Mesh", "->", "All"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a3", "=", 
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"3", ";;", 
      RowBox[{"-", "1"}]}], ",", "3"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"3", ";;", 
      RowBox[{"-", "1"}]}], ",", "3"}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"HouseActionVec", "[", 
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", ";;", 
        RowBox[{"-", "1"}]}], ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     "a3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"MatrixPlot", "[", 
    RowBox[{
     RowBox[{"Chop", "[", "A", "]"}], ",", 
     RowBox[{"Mesh", "->", "All"}]}], "]"}], ",", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{"R", ",", 
     RowBox[{"Mesh", "->", "All"}]}], "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
   3.846937334732747*^9, 3.846937390283722*^9}, {3.846938221952484*^9, 
   3.846938350861267*^9}, {3.8469384054659576`*^9, 3.846938481047811*^9}, {
   3.8469385642503386`*^9, 3.8469388748245225`*^9}, {3.846939753022072*^9, 
   3.846939793671465*^9}, {3.84699814720088*^9, 3.846998201973194*^9}, 
   3.8526462242391977`*^9, 3.852646289349926*^9, 3.852646371775311*^9, {
   3.852646404123517*^9, 3.852646415063883*^9}, 3.852646543109111*^9, 
   3.852653226122402*^9, {3.852653290449294*^9, 3.8526532934413896`*^9}, {
   3.8526533287957797`*^9, 3.8526533567807274`*^9}, 3.8841032176001883`*^9, 
   3.884103337871437*^9, {3.884103429342661*^9, 3.884103432795635*^9}, {
   3.8841035090531263`*^9, 3.8841035124372005`*^9}, {3.884103643580618*^9, 
   3.884103692704342*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"a2724d64-3e94-4a01-98ac-0dfb1a66766b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDgAGJmKIaAD/aj9OCiT6qfyhSLfGOvc3rqM6OKp/aXJarz
raXPEtT3sEpknfvDW1A+A8My8YZFQkuu2us9DbVOSXxsv+bi3QXNAq/stx46
onQl7YL9nKaTHXMEbti7C9f9CA57Yz/JdWXD2U9P7H2cymoeXnpp/5jX7V11
+Bv7G1fWMk8/9tZeqsA9dknSa/tsNsvN66yf2AMAtTiD1Q==
      "], {{0, 0}, {3, 8}}, {0, 1}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 8}, {3, 8}}, {{0, 7}, {3, 7}}, {{0, 6}, {3, 6}}, {{0, 
         5}, {3, 5}}, {{0, 4}, {3, 4}}, {{0, 3}, {3, 3}}, {{0, 2}, {3, 2}}, {{
         0, 1}, {3, 1}}, {{0, 0}, {3, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 8}}, {{1, 0}, {1, 8}}, {{2, 0}, {2, 8}}, {{3, 
         0}, {3, 8}}}],
        Antialiasing->False]}}},
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{7.5, 
         FormBox["1", TraditionalForm]}, {6.5, 
         FormBox["2", TraditionalForm]}, {5.5, 
         FormBox["3", TraditionalForm]}, {4.5, 
         FormBox["4", TraditionalForm]}, {3.5, 
         FormBox["5", TraditionalForm]}, {2.5, 
         FormBox["6", TraditionalForm]}, {1.5, 
         FormBox["7", TraditionalForm]}, {0.5, 
         FormBox["8", TraditionalForm]}}, {{7.5, 
         FormBox["1", TraditionalForm]}, {6.5, 
         FormBox["2", TraditionalForm]}, {5.5, 
         FormBox["3", TraditionalForm]}, {4.5, 
         FormBox["4", TraditionalForm]}, {3.5, 
         FormBox["5", TraditionalForm]}, {2.5, 
         FormBox["6", TraditionalForm]}, {1.5, 
         FormBox["7", TraditionalForm]}, {0.5, 
         FormBox["8", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   GraphicsBox[{
     RasterBox[{{{1., 1., 1.}, {1., 1., 1.}, {0.8858749452785953, 
      0.6709227088561864, 0.22739355986977317`}}, {{1., 1., 1.}, {1., 0.42, 
      0.}, {0.33813920849967827`, 0.6056386145493542, 0.8145158903048944}}, {{
      0.2562761630570478, 0.37601388319129986`, 0.8855380872124464}, {
      0.6546390068926251, 0.8069922858140416, 0.8856792119772163}, {
      0.9304919311386142, 0.8557912656647233, 0.632285451931421}}}, {{0, 0}, {
      3, 3}}, {0, 1}], {
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 3}, {3, 3}}, {{0, 2}, {3, 2}}, {{0, 1}, {3, 1}}, {{0, 
         0}, {3, 0}}}],
        Antialiasing->False]}, 
      {GrayLevel[
        NCache[-1 + GoldenRatio, 0.6180339887498949]], 
       StyleBox[
        LineBox[{{{0, 0}, {0, 3}}, {{1, 0}, {1, 3}}, {{2, 0}, {2, 3}}, {{3, 
         0}, {3, 3}}}],
        Antialiasing->False]}}},
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{2.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {0.5, 
         FormBox["3", TraditionalForm]}}, {{2.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {0.5, 
         FormBox["3", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8526532270117197`*^9, {3.852653311934763*^9, 3.852653332443078*^9}, 
   3.884103222695467*^9, 3.884103472510414*^9, 3.8841035131639533`*^9, {
   3.8841036653041067`*^9, 3.884103693649914*^9}},
 CellLabel->
  "Out[119]=",ExpressionUUID->"5ea007f6-bb8a-49f8-b04a-0cf824f79586"]
}, Open  ]],

Cell["\<\
We have worked out what the QR algorithm (at least for R) is!\
\>", "Text",
 CellChangeTimes->{{3.8469389033438005`*^9, 
  3.8469389493339624`*^9}},ExpressionUUID->"8243787c-c484-449a-adea-\
a86829017a50"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{
    RowBox[{"QRDecomposition", "[", "A0", "]"}], "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A", "\[LeftDoubleBracket]", 
     RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}], ",", "R"}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.846937334732747*^9, 3.846937390283722*^9}, {3.846938221952484*^9, 
  3.846938350861267*^9}, {3.8469384054659576`*^9, 3.846938481047811*^9}, {
  3.8469385642503386`*^9, 3.84693886759904*^9}, {3.852646577201172*^9, 
  3.852646580413863*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"3b2210e6-67f4-4bf3-8d71-6a62d6996567"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.7885095640113482`"}], ",", 
       RowBox[{"-", "0.06853011859915437`"}], ",", "0.154593246609467`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1.9666543779767087`", ",", 
       RowBox[{"-", "0.45836261883432394`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0.6914894621184026`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.7885095640113478`"}], ",", 
       RowBox[{"-", "0.06853011859915425`"}], ",", "0.154593246609467`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1.9666543779767096`", ",", 
       RowBox[{"-", "0.45836261883432416`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0.6914894621184025`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.846938794009699*^9, 3.8469388551402955`*^9}, 
   3.846938914778987*^9, 3.8469392985886045`*^9, 3.8469397971566057`*^9, 
   3.846998209327832*^9, 3.8526465474368997`*^9, 3.8526465812321205`*^9, 
   3.8526535070989904`*^9, 3.884103799680687*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"e9e43f54-a113-42ca-8fee-5d8da6960dc4"]
}, Open  ]],

Cell["Notes: ", "Text",
 CellChangeTimes->{{3.846938972480877*^9, 3.8469391690606585`*^9}, {
  3.8469393424215326`*^9, 3.8469393792634354`*^9}, {3.846997446307859*^9, 
  3.846997485918006*^9}},ExpressionUUID->"f34d525f-10f2-40fc-b72d-\
16e9e4e335ef"],

Cell["We should do the columns together.  ", "Item",
 CellChangeTimes->{{3.846938972480877*^9, 3.8469391690606585`*^9}, {
  3.8469393424215326`*^9, 3.8469393792634354`*^9}, {3.846997446307859*^9, 
  3.846997496779839*^9}, {3.8469986386830673`*^9, 
  3.846998654336666*^9}},ExpressionUUID->"1929dd45-84fb-4b19-94e7-\
fadf0a1d7f53"],

Cell[TextData[{
 "We do not have Q because we did not save it!  It is not a good idea to \
compute it at the end as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "=", 
    RowBox[{"A", ".", 
     SuperscriptBox["R", 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]],ExpressionUUID->
  "85c0e4a0-726f-4f86-a352-5efe048ccdf1"]
}], "Item",
 CellChangeTimes->{{3.846938972480877*^9, 3.8469391690606585`*^9}, {
  3.8469393424215326`*^9, 3.8469393792634354`*^9}, {3.846997446307859*^9, 
  3.846997538597426*^9}},ExpressionUUID->"fb2847f4-c189-4d8e-b8f1-\
4a17a327380c"],

Cell["\<\
Performant library code saves the Householder vectors (on top of the newly \
created zeros) and only builds an explicit Q matrix if needed.   \
\>", "Item",
 CellChangeTimes->{{3.846938972480877*^9, 3.8469391690606585`*^9}, {
  3.8469393424215326`*^9, 3.8469393792634354`*^9}, {3.846997446307859*^9, 
  3.846997604464456*^9}},ExpressionUUID->"34a0fed1-cc77-4301-81b2-\
791ca052705d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Householder QR:
Script Version 2\
\>", "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
   3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
   3.8469335254269605`*^9}, {3.8469372186478972`*^9, 
   3.8469372557172794`*^9}, {3.8469375026313*^9, 3.846937508278796*^9}, {
   3.846937553989224*^9, 3.8469375682672977`*^9}, {3.846938893485902*^9, 
   3.8469388943058777`*^9}, {3.8469391846402254`*^9, 
   3.8469391856207337`*^9}, {3.846998705312707*^9, 3.846998705498599*^9}, 
   3.8469995700335617`*^9},ExpressionUUID->"3e6ef0af-a043-4ec2-9dd3-\
294bc3701927"],

Cell["\<\
Here is a less-manual script reducing a Tall Skinny matrix A to upper \
triangular using Householder reflections again overwriting A.\
\>", "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}, {3.846937265493534*^9, 3.846937331605727*^9}, {
   3.8469374675167007`*^9, 3.846937467905089*^9}, {3.846937515791397*^9, 
   3.8469375232198505`*^9}, {3.8469380625211287`*^9, 3.846938170660471*^9}, {
   3.8469384910505347`*^9, 3.8469385428820353`*^9}, {3.846998730239862*^9, 
   3.846998776872889*^9}, {3.846999386291897*^9, 
   3.846999397060482*^9}},ExpressionUUID->"fd0318c3-ad7d-4ee2-81c8-\
afcdf79ebe56"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"15", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A0", "=", 
   RowBox[{"A", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "=", 
     RowBox[{"HouseVec", "[", 
      RowBox[{"A", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"i", ";;", 
         RowBox[{"-", "1"}]}], ",", "i"}], "\[RightDoubleBracket]"}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"i", ";;", 
          RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{
        RowBox[{"A", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"i", ";;", 
           RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{"2", " ", "v", " ", 
         RowBox[{"(", 
          RowBox[{"v", ".", 
           RowBox[{"A", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", ";;", 
              RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}]}], 
          ")"}]}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"j", ",", "i", ",", "n"}], "}"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q", ",", "R"}], "}"}], " ", "=", 
   RowBox[{"QRDecomposition", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TabView", "[", 
  RowBox[{"Map", "[", 
   RowBox[{"MatrixForm", ",", 
    RowBox[{"Chop", "[", 
     RowBox[{"{", 
      RowBox[{"R", ",", 
       RowBox[{"A", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"1", ";;", "n"}], ",", 
         RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}]}], "}"}], 
     "]"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", 
  RowBox[{
   RowBox[{"Chop", "[", "A", "]"}], ",", 
   RowBox[{"Mesh", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.846937334732747*^9, 3.846937390283722*^9}, {3.846938221952484*^9, 
  3.846938350861267*^9}, {3.8469384054659576`*^9, 3.846938481047811*^9}, {
  3.8469385642503386`*^9, 3.8469388748245225`*^9}, {3.846939753022072*^9, 
  3.846939793671465*^9}, {3.84699814720088*^9, 3.846998201973194*^9}, {
  3.8469987410107327`*^9, 3.8469988430402117`*^9}, {3.846998894736611*^9, 
  3.84699922195962*^9}, {3.8469992846020947`*^9, 3.8469993005897093`*^9}, {
  3.8469993528345346`*^9, 3.846999376461938*^9}, {3.8526467273859196`*^9, 
  3.8526467312951713`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"9b2e8605-4e42-4c20-b1c7-2a52c3c34a33"],

Cell[BoxData[
 TabViewBox[{{1,"1"->
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"-", "2.688671171982942`"}], "0.017540771853036798`", 
       "0.29917069569799803`", "1.0155513535356113`"},
      {"0", 
       RowBox[{"-", "2.108002113333122`"}], 
       RowBox[{"-", "0.2206647316709585`"}], 
       RowBox[{"-", "0.15387579196152196`"}]},
      {"0", "0", 
       RowBox[{"-", "1.923261471840725`"}], "0.28110593752991797`"},
      {"0", "0", "0", 
       RowBox[{"-", "2.203389850748947`"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}, {2,"2"->
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"2.688671171982942`", 
       RowBox[{"-", "0.017540771853036707`"}], 
       RowBox[{"-", "0.29917069569799815`"}], 
       RowBox[{"-", "1.0155513535356113`"}]},
      {"0", "2.108002113333122`", "0.2206647316709585`", "0.153875791961522`"},
      {"0", "0", "1.923261471840725`", 
       RowBox[{"-", "0.281105937529918`"}]},
      {"0", "0", "0", "2.203389850748947`"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}}, 2]], "Output",
 CellChangeTimes->{{3.8469991707631903`*^9, 3.8469992223011093`*^9}, {
   3.846999292007669*^9, 3.846999301315362*^9}, {3.846999353243291*^9, 
   3.846999377043378*^9}, 3.8526467013875484`*^9, 3.852646731743549*^9, 
   3.852653641243424*^9, 3.8841040654320993`*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"ce5a40ed-5781-461b-a4f0-16342ff42567"],

Cell[BoxData[
 GraphicsBox[{RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDgB2IWIAaxIeCD/Sg9So/SozStaNObn271r3xrv/3J/MuW
bfftP7W1i2ScziXZHN2a67qrj722//PKlPXJ90f2DUsS352/s8m+Zkpx8OSC
x/acnvaHJ/x4YS/E7Zy57+prnOakewv/OJ38xj4wuspmB9tD+9LjdzV3MZbb
x6akX88/99Z+wv8mE++G1/bXZ8xSPN/xxH7bavMZr/Te2f/bfKfg7ps39neW
7JMTt30BN+9hlcg694e3oHwGhprMZ4pLO17Zh8Q67pX8/cZeREH2wSnzd/ah
W1uC6/Tv2XcZq27vbH5m//2384838a/sD3xNvbFnxWX7pPVR+7kzH9lXLHlm
uRQoDgAFXi26
    "], {{0, 0}, {4, 15}}, {0, 1}], {
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 15}, {4, 15}}, {{0, 14}, {4, 14}}, {{0, 13}, {4, 13}}, {{
       0, 12}, {4, 12}}, {{0, 11}, {4, 11}}, {{0, 10}, {4, 10}}, {{0, 9}, {4, 
       9}}, {{0, 8}, {4, 8}}, {{0, 7}, {4, 7}}, {{0, 6}, {4, 6}}, {{0, 5}, {4,
        5}}, {{0, 4}, {4, 4}}, {{0, 3}, {4, 3}}, {{0, 2}, {4, 2}}, {{0, 1}, {
       4, 1}}, {{0, 0}, {4, 0}}}],
      Antialiasing->False]}, 
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 0}, {0, 15}}, {{1, 0}, {1, 15}}, {{2, 0}, {2, 15}}, {{3, 
       0}, {3, 15}}, {{4, 0}, {4, 15}}}],
      Antialiasing->False]}}},
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{14.5, 
       FormBox["1", TraditionalForm]}, {10.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["10", TraditionalForm]}, {0.5, 
       FormBox["15", TraditionalForm]}}, {{14.5, 
       FormBox["1", TraditionalForm]}, {10.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["10", TraditionalForm]}, {0.5, 
       FormBox["15", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.8469991707631903`*^9, 3.8469992223011093`*^9}, {
   3.846999292007669*^9, 3.846999301315362*^9}, {3.846999353243291*^9, 
   3.846999377043378*^9}, 3.8526467013875484`*^9, 3.852646731743549*^9, 
   3.852653641243424*^9, 3.8841040655226765`*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"3bf636a1-1243-453a-bc1a-cacfeb038e99"]
}, Open  ]],

Cell["\<\
We are going to save the Householder vectors (so that we can build Q) in the \
next version! \
\>", "Item",
 CellChangeTimes->{{3.846938972480877*^9, 3.8469391690606585`*^9}, {
  3.8469393424215326`*^9, 3.8469393792634354`*^9}, {3.846997446307859*^9, 
  3.846997496779839*^9}, {3.8469986386830673`*^9, 3.846998654336666*^9}, {
  3.8469994761376762`*^9, 
  3.8469995574909067`*^9}},ExpressionUUID->"1302b0b5-a93b-4eb7-b260-\
58325f92c484"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Householder QR:
Script Version 3\
\>", "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
  3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
  3.8469335254269605`*^9}, {3.8469372186478972`*^9, 3.8469372557172794`*^9}, {
  3.8469375026313*^9, 3.846937508278796*^9}, {3.846937553989224*^9, 
  3.8469375682672977`*^9}, {3.846938893485902*^9, 3.8469388943058777`*^9}, {
  3.8469391846402254`*^9, 3.8469391856207337`*^9}, {3.846998705312707*^9, 
  3.846998705498599*^9}, {3.846999571002205*^9, 
  3.846999573291185*^9}},ExpressionUUID->"894b92ea-3669-4b3c-81ec-\
6ad261e419a8"],

Cell["\<\
Here is a less-manual script reducing a Tall Skinny matrix A to upper \
triangular overwriting A and saving the Householder vectors. \
\>", "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}, {3.846937265493534*^9, 3.846937331605727*^9}, {
   3.8469374675167007`*^9, 3.846937467905089*^9}, {3.846937515791397*^9, 
   3.8469375232198505`*^9}, {3.8469380625211287`*^9, 3.846938170660471*^9}, {
   3.8469384910505347`*^9, 3.8469385428820353`*^9}, {3.846998730239862*^9, 
   3.846998776872889*^9}, {3.846999386291897*^9, 3.846999397060482*^9}, {
   3.846999786209866*^9, 
   3.8469998173543663`*^9}},ExpressionUUID->"2e8dadb7-1253-4cb2-9b5e-\
477f71931c68"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"15", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A0", "=", 
   RowBox[{"A", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}]}], ";", " ", 
  RowBox[{"V", "=", 
   RowBox[{"0.0", "*", "A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "=", 
     RowBox[{"HouseVec", "[", 
      RowBox[{"A", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"i", ";;", 
         RowBox[{"-", "1"}]}], ",", "i"}], "\[RightDoubleBracket]"}], "]"}]}],
     ";", " ", 
    RowBox[{
     RowBox[{"V", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"i", ";;", 
        RowBox[{"-", "1"}]}], ",", "i"}], "\[RightDoubleBracket]"}], "=", 
     "v"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"i", ";;", 
          RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{
        RowBox[{"A", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"i", ";;", 
           RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{"2", " ", "v", " ", 
         RowBox[{"(", 
          RowBox[{"v", ".", 
           RowBox[{"A", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", ";;", 
              RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}]}], 
          ")"}]}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"j", ",", "i", ",", "n"}], "}"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q", ",", "R"}], "}"}], " ", "=", 
   RowBox[{"QRDecomposition", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TabView", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixPlot", "[", 
      RowBox[{"#", ",", " ", 
       RowBox[{"Mesh", "->", "All"}]}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Chop", "[", "A", "]"}], ",", "V"}], "}"}]}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.846937334732747*^9, 3.846937390283722*^9}, {3.846938221952484*^9, 
  3.846938350861267*^9}, {3.8469384054659576`*^9, 3.846938481047811*^9}, {
  3.8469385642503386`*^9, 3.8469388748245225`*^9}, {3.846939753022072*^9, 
  3.846939793671465*^9}, {3.84699814720088*^9, 3.846998201973194*^9}, {
  3.8469987410107327`*^9, 3.8469988430402117`*^9}, {3.846998894736611*^9, 
  3.84699922195962*^9}, {3.8469992846020947`*^9, 3.8469993005897093`*^9}, {
  3.8469993528345346`*^9, 3.846999376461938*^9}, {3.846999588292577*^9, 
  3.846999689999892*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"6ce91ab3-5568-4497-88f1-353271e81d55"],

Cell[BoxData[
 TabViewBox[{{1,"1"->
  GraphicsBox[{RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDgB2IWIAaxIeCD/Sg9So/SozSt6Hv6Vx5UnnttP5NDcCqH
1GP7mn9qj7593UKyOdEPjvOa3H9nv+PjjNvc8nft77xesX/XwRj7+bXMm2J0
39o37NvU1CDx0r7wZSnbgQt3cJoTqsizprb5rX1/aDHX3Yv37WWFFLyWbMi3
n+3jqF5a8cK+zOjZsa4Lr+1TpHvaYtve2lfsYr57/N8l+5pTR1feFH1kHzol
pUm96pW9lnzTqourL9gnCURYbjlxzf62sMq23e1v7C9sa/pquOGt/YvQ3Pks
fK/tW2+dLpgY/9h+abhzUub96/Y9ryYEClY+sf9ceC81bftL+7fcj/6EXX5k
n33tj9iG+S/s9cWUvr9Z8NoeAKTXMdc=
     "], {{0, 0}, {4, 15}}, {0, 1}], {
     {GrayLevel[
       NCache[-1 + GoldenRatio, 0.6180339887498949]], 
      StyleBox[
       LineBox[{{{0, 15}, {4, 15}}, {{0, 14}, {4, 14}}, {{0, 13}, {4, 13}}, {{
        0, 12}, {4, 12}}, {{0, 11}, {4, 11}}, {{0, 10}, {4, 10}}, {{0, 9}, {4,
         9}}, {{0, 8}, {4, 8}}, {{0, 7}, {4, 7}}, {{0, 6}, {4, 6}}, {{0, 5}, {
        4, 5}}, {{0, 4}, {4, 4}}, {{0, 3}, {4, 3}}, {{0, 2}, {4, 2}}, {{0, 
        1}, {4, 1}}, {{0, 0}, {4, 0}}}],
       Antialiasing->False]}, 
     {GrayLevel[
       NCache[-1 + GoldenRatio, 0.6180339887498949]], 
      StyleBox[
       LineBox[{{{0, 0}, {0, 15}}, {{1, 0}, {1, 15}}, {{2, 0}, {2, 15}}, {{3, 
        0}, {3, 15}}, {{4, 0}, {4, 15}}}],
       Antialiasing->False]}}},
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{14.5, 
        FormBox["1", TraditionalForm]}, {10.5, 
        FormBox["5", TraditionalForm]}, {5.5, 
        FormBox["10", TraditionalForm]}, {0.5, 
        FormBox["15", TraditionalForm]}}, {{14.5, 
        FormBox["1", TraditionalForm]}, {10.5, 
        FormBox["5", TraditionalForm]}, {5.5, 
        FormBox["10", TraditionalForm]}, {0.5, 
        FormBox["15", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {1.5, 
        FormBox["2", TraditionalForm]}, {2.5, 
        FormBox["3", TraditionalForm]}, {3.5, 
        FormBox["4", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {1.5, 
        FormBox["2", TraditionalForm]}, {2.5, 
        FormBox["3", TraditionalForm]}, {3.5, 
        FormBox["4", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}, {2,"2"->
  GraphicsBox[{RasterBox[CompressedData["
1:eJyVjms01AkAxWcQg8QeSlsn1rBLyittstQtMVvHq/WKZCsJFUptjUfCFDNr
i/VYCtuGzRBKVrvheBxUk07ew4yUGGNe//+gTaWtrN2ve/qw95x7fvfTvdck
9LjPYVUKhaK7aLVF/5NjCzSnlkaSKBZYPAp/L0Mg39ggrvA5NO9kjrB8SLBX
SUpVqmXQUJkdS780BiLWoHToohLnaNyae95KGKjWqjsLFPCibZRWJ5PIGI2v
rA6Q45q7eK6aNY66M58G9FwaxNM62yEr4QR4ZWapcic50hZUkrtMBxA8srfg
tfkErhfy7hz8Tg5H3ewTtHICxWceDtXyphDNOTRu0DCAgbAmjeCix0jnHr26
s3IMu133iHztFLAJ0avoukfgGKXVPddXgo7WF3r+T/gorQi3YQfJsIF2P6rD
m0Cal0/Emz4Sj7ccPaHOncD9pz/nlKVLEWUQbqqVo0CpXbN7/ggJb9nbno03
FXBUmWY4UcSwNEmb7ZYQCHISNvhLJTAq+8YwykyA4ONvBBorCaQM8Q/XBU+C
sawpxTWkEw4mHP4udyVyiwV79QNJnBa89HrpKwM964cI1dE+ZPKyXS+wxzGY
ZH4rlStHjKNuh/UXJBbe+y2smpeiY+0V5g7/URSL2791OSgBQ2VHfsMGBfbf
vk/mWpCg93apNdcOw2ipW/zm0EmESq00b7bI4PmMefsufwBCn9lneskT+D6x
bWlJoByvgh9bnK8i4Zvbe8PnnRzZDzpKM+xEcIyotx94ocC+aSH5/q4IHsdv
4kFjCxQ8u6YZNSXyPv86H14EOHobH52/NgVuhbrv9h4hfDraVyoZYjQlVlTc
K5NhxViDq00eiQsBx6LX/yrHiazsqe0eE6CrnjJxU32GNdlFy7SYUwhhpiUk
L/5p85RIHVwIXM0Ki7I1EMNj5tYTNq0LBhGvM5K4Ipj7EdZFhjK883futpUq
QPvk4R5OKAEBI7InpUQMbR3lWbMD3bDnHZorcpiCtjNnX0KGHH7r//ipoJMA
nKNHzs6QaGl9d/EVhYC3yckvk4bFsKYlDDTtk4JRm0oda1OgwubKEZ0kEldV
qJut1hHY9CFds0ZCwn5oSXhopxLFa7oZdD4fDQKWZ2S8COVZJddHaXJMVu7Y
lpjYj0HmxT9z+eNgamVvKs2Ug8iwzzdUXdzVcjtZvl+KfEuLoPp5IeqEMb9R
TitxidumXT9HoiZghj5HykGrtGaPpZDoL+HM91UokVVoy7J0mEbmZ19ZrDg6
BIu18i0+7SIsT6rVKZmVoZF3UrTaXIG8MCPTaj8Sl89zZpZEKyHbu1z/nMYw
VjjXJO/XnUS2jErqC2XQ6u8fuN5KIsaKwo/cqUBM94Ulp16LEDYbsUdLZxSe
29RrVsrESDBOUpipyTEc8NytwGUcOW83qFs2S6BvtLvSa5UC8W/WUxX2fFCr
C68kWYqQ4lchodLlaC/UbSjX7kOhuJGZZjKOOO3G01SeHGrK3CPDLZPQc2Yz
WXdksI5x4mgwCGgaBa62ju3FurOGIUfGhhF4sKqyOYSAabxwsoiuRMH8eFtw
C4GuD5fDjTslMP+Fm663WYlT0x4LMbokhA5uedQCKSyNWTf6qnoRqhfoWM8b
whN9s9+b2AQo/2rmP1StjG6bZRGomjQ9ttVmCr0P6WaZIX3wDS5klu/qxV+p
sXHuRQK01QR1x2z/eM/HmDN4zWVrixLOJawS9oGn+NH6Rdyc2oH/3fMx/g1E
D6Ox
     "], {{0, 0}, {4, 15}}, {0, 1}], {
     {GrayLevel[
       NCache[-1 + GoldenRatio, 0.6180339887498949]], 
      StyleBox[
       LineBox[{{{0, 15}, {4, 15}}, {{0, 14}, {4, 14}}, {{0, 13}, {4, 13}}, {{
        0, 12}, {4, 12}}, {{0, 11}, {4, 11}}, {{0, 10}, {4, 10}}, {{0, 9}, {4,
         9}}, {{0, 8}, {4, 8}}, {{0, 7}, {4, 7}}, {{0, 6}, {4, 6}}, {{0, 5}, {
        4, 5}}, {{0, 4}, {4, 4}}, {{0, 3}, {4, 3}}, {{0, 2}, {4, 2}}, {{0, 
        1}, {4, 1}}, {{0, 0}, {4, 0}}}],
       Antialiasing->False]}, 
     {GrayLevel[
       NCache[-1 + GoldenRatio, 0.6180339887498949]], 
      StyleBox[
       LineBox[{{{0, 0}, {0, 15}}, {{1, 0}, {1, 15}}, {{2, 0}, {2, 15}}, {{3, 
        0}, {3, 15}}, {{4, 0}, {4, 15}}}],
       Antialiasing->False]}}},
   Frame->True,
   FrameLabel->{None, None},
   FrameTicks->{{{{14.5, 
        FormBox["1", TraditionalForm]}, {10.5, 
        FormBox["5", TraditionalForm]}, {5.5, 
        FormBox["10", TraditionalForm]}, {0.5, 
        FormBox["15", TraditionalForm]}}, {{14.5, 
        FormBox["1", TraditionalForm]}, {10.5, 
        FormBox["5", TraditionalForm]}, {5.5, 
        FormBox["10", TraditionalForm]}, {0.5, 
        FormBox["15", TraditionalForm]}}}, {{{0.5, 
        FormBox["1", TraditionalForm]}, {1.5, 
        FormBox["2", TraditionalForm]}, {2.5, 
        FormBox["3", TraditionalForm]}, {3.5, 
        FormBox["4", TraditionalForm]}}, {{0.5, 
        FormBox["1", TraditionalForm]}, {1.5, 
        FormBox["2", TraditionalForm]}, {2.5, 
        FormBox["3", TraditionalForm]}, {3.5, 
        FormBox["4", TraditionalForm]}}}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
     "RangePadding" -> Scaled[0.05]}]}}, 1]], "Output",
 CellChangeTimes->{3.846999716475766*^9, 3.8526468474424376`*^9, 
  3.852653725045539*^9, 3.884104114415045*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"b44a012a-d205-4c25-875d-6fedc5f813ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Note: Performant code stuffs the reduced A and Householder vectors V together \
in a single rectangular matrix. \
\>", "Item",
 CellChangeTimes->{{3.846999845740571*^9, 
  3.846999942579816*^9}},ExpressionUUID->"268a94b1-a05e-4ab6-9c18-\
bad6e38ee2a8"],

Cell["\<\
Yes they overlap! You either need a little extra storage vector (for the \
diagonals) or you need to remember that since the Householder vectors are \
unit vectors they have one less Degree of Freedom.  \
\>", "Subitem",
 CellChangeTimes->{{3.846999845740571*^9, 3.847000081377425*^9}, {
  3.8470002189988747`*^9, 
  3.847000218999571*^9}},ExpressionUUID->"d703270a-e679-49ac-86c6-\
60cda86a26b8"]
}, Open  ]],

Cell["\<\
Next we are going to work out how to build the Householder Q from all the \
Householder vectors in V. \
\>", "Item",
 CellChangeTimes->{{3.846999845740571*^9, 3.847000081377425*^9}, {
  3.847000222997814*^9, 
  3.847000263197782*^9}},ExpressionUUID->"1c58fa42-4b97-476a-aa44-\
9e8cb8f2f8b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Householder QR:
Function\
\>", "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
  3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
  3.8469335254269605`*^9}, {3.8469372186478972`*^9, 3.8469372557172794`*^9}, {
  3.8469375026313*^9, 3.846937508278796*^9}, {3.846937553989224*^9, 
  3.8469375682672977`*^9}, {3.846938893485902*^9, 3.8469388943058777`*^9}, {
  3.8469391846402254`*^9, 3.8469391856207337`*^9}, {3.846998705312707*^9, 
  3.846998705498599*^9}, {3.846999571002205*^9, 3.846999573291185*^9}, {
  3.847000307144331*^9, 
  3.847000308223342*^9}},ExpressionUUID->"ce453186-fb2a-4a81-ac9f-\
13721d217fd1"],

Cell["\<\
Here is a function reducing a Tall Skinny matrix A to upper triangular which \
overwrites A and returns the Householder vectors. \
\>", "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}, {3.846937265493534*^9, 3.846937331605727*^9}, {
   3.8469374675167007`*^9, 3.846937467905089*^9}, {3.846937515791397*^9, 
   3.8469375232198505`*^9}, {3.8469380625211287`*^9, 3.846938170660471*^9}, {
   3.8469384910505347`*^9, 3.8469385428820353`*^9}, {3.846998730239862*^9, 
   3.846998776872889*^9}, {3.846999386291897*^9, 3.846999397060482*^9}, {
   3.846999786209866*^9, 3.8469998173543663`*^9}, {3.847000320359261*^9, 
   3.847000377158641*^9}},ExpressionUUID->"8843b395-b110-4d0b-a289-\
793a4c4a47bf"],

Cell["\<\
Here is an in-place Mathematica code.  HoldFirst prevents evaluation of the \
first argument A! As a result, the name (memory address) of the matrix A is \
handed to the function rather than making a copy of the matrix A and handing \
the copy off to the function!  The specified operations are done on the \
\[OpenCurlyDoubleQuote]original\[CloseCurlyDoubleQuote] matrix and we do not \
need to return anything! Since matrices can be (in the real world almost \
always are) very large this is much more efficient. \
\>", "Text",
 CellChangeTimes->{{3.8470007739388027`*^9, 
  3.847000818702736*^9}},ExpressionUUID->"a7ab2941-48d9-4e39-94bd-\
cfcfed4cd73a"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"MyQR", ",", "HoldFirst"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyQR", "[", "A_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n", ",", "v", ",", "V"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Householder", " ", "Reduction", " ", "from", " ", "Script", " ", 
       "Version", " ", "3"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"HouseVec", "[", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"i", ";;", 
             RowBox[{"-", "1"}]}], ",", "i"}], "\[RightDoubleBracket]"}], 
          "]"}]}], ";", " ", 
        RowBox[{
         RowBox[{"V", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"i", ";;", 
            RowBox[{"-", "1"}]}], ",", "i"}], "\[RightDoubleBracket]"}], "=", 
         "v"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", ";;", 
              RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"i", ";;", 
               RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{"2", " ", "v", " ", 
             RowBox[{"(", 
              RowBox[{"v", ".", 
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"i", ";;", 
                  RowBox[{"-", "1"}]}], ",", "j"}], 
                "\[RightDoubleBracket]"}]}], ")"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i", ",", "n"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Returns", " ", "Householder", " ", "vectors", " ", "in", " ", "V"}], 
      " ", "*)"}], "\[IndentingNewLine]", "V"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.847000382632509*^9, 3.8470005491366158`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"0180d11a-6739-4bc7-9069-c8804345f24e"],

Cell["\<\
As always TEST as best you can!  To test properly we need the Q!\
\>", "Text",
 CellChangeTimes->{{3.847000562255906*^9, 3.847000584836035*^9}, {
  3.847000684434866*^9, 3.847000717038898*^9}, {3.84700083990224*^9, 
  3.847000849420988*^9}},ExpressionUUID->"62ef8c72-26b9-4229-9830-\
1c82700eca91"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"15", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A0", "=", 
   RowBox[{"A", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}]}], ";", " ", 
  RowBox[{"V", "=", 
   RowBox[{"0.0", "*", "A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"MyQR", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"R", "=", 
  RowBox[{"Chop", "[", 
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "n"}], ",", 
     RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.846937334732747*^9, 3.846937390283722*^9}, {3.846938221952484*^9, 
  3.846938350861267*^9}, {3.8469384054659576`*^9, 3.846938481047811*^9}, {
  3.8469385642503386`*^9, 3.8469388748245225`*^9}, {3.846939753022072*^9, 
  3.846939793671465*^9}, {3.84699814720088*^9, 3.846998201973194*^9}, {
  3.8469987410107327`*^9, 3.8469988430402117`*^9}, {3.846998894736611*^9, 
  3.84699922195962*^9}, {3.8469992846020947`*^9, 3.8469993005897093`*^9}, {
  3.8469993528345346`*^9, 3.846999376461938*^9}, {3.846999588292577*^9, 
  3.846999689999892*^9}, {3.847000600420092*^9, 3.847000630378351*^9}, {
  3.85265404407162*^9, 3.852654048605777*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"d78f4f99-54cb-4b11-950a-336fad172243"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.5176733485672553`"}], ",", 
     RowBox[{"-", "0.5327248272796387`"}], ",", "0.29487992503507954`", ",", 
     "0.0791780497684118`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "2.1162904326394023`"}], ",", "0.1445017433450505`", ",", 
     RowBox[{"-", "0.5459201496522901`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "2.261904968807382`"}], ",", "0.8431946067016476`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1.4921254673835922`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.847000631667244*^9, 3.847015722983993*^9, 3.852647404940618*^9, {
   3.8526540287627316`*^9, 3.852654049058592*^9}},
 CellLabel->"Out[86]=",ExpressionUUID->"5d35ee92-9081-4073-9be8-fb3808a23c9e"]
}, Open  ]],

Cell["\<\
Next we are going to work out how to build the Householder Q from all the \
Householder vectors in V. \
\>", "Item",
 CellChangeTimes->{{3.846999845740571*^9, 3.847000081377425*^9}, {
  3.847000222997814*^9, 
  3.847000263197782*^9}},ExpressionUUID->"5dac283c-38c9-4226-ad77-\
363c121e95e0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Householder Q", "Section",
 CellChangeTimes->{{3.847003158823649*^9, 3.8470031858812227`*^9}, 
   3.847003217192071*^9},ExpressionUUID->"b0cb362d-2ca7-4c2d-a252-\
bbb690d4fcc4"],

Cell[CellGroupData[{

Cell["\<\
Building Q from V 
Plan 1\
\>", "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
   3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
   3.8469335254269605`*^9}, {3.8469372186478972`*^9, 
   3.8469372557172794`*^9}, {3.8469375026313*^9, 3.846937508278796*^9}, {
   3.846937553989224*^9, 3.8469375682672977`*^9}, {3.846938893485902*^9, 
   3.8469388943058777`*^9}, {3.8469391846402254`*^9, 
   3.8469391856207337`*^9}, {3.846998705312707*^9, 3.846998705498599*^9}, {
   3.846999571002205*^9, 3.846999573291185*^9}, {3.847000307144331*^9, 
   3.847000308223342*^9}, {3.847000894372295*^9, 3.847000922486709*^9}, {
   3.847003109087948*^9, 3.847003110334525*^9}, 3.847003261542013*^9, {
   3.8470129573713503`*^9, 
   3.847012957703704*^9}},ExpressionUUID->"666ca539-312f-4d21-8b6e-\
6d7e36e0ef75"],

Cell[TextData[{
 "We reduce the tall-skinny ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "459c37dd-18c1-4231-a6ae-588c79ef0abb"],
 " matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "0"], TraditionalForm]],ExpressionUUID->
  "056528dc-8d20-4f78-a636-0bfe0de74792"],
 " with a sequence of Householder reflectors that created zeros in the lower \
triangle of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "0"], TraditionalForm]],ExpressionUUID->
  "d81a8ead-088a-4260-a435-5fe6d91ad03b"]
}], "Text",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
   3.847001787114211*^9, 3.847001813862543*^9}, {3.8470018672624083`*^9, 
   3.847001867807458*^9}, 3.8470019394360247`*^9, {3.847002119781258*^9, 
   3.847002123898239*^9}, 
   3.847002681254529*^9},ExpressionUUID->"296346b7-63b8-4efe-b1f1-\
ecb9dcfe759e"],

Cell[TextData[{
 "The first reflector ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "1"], "=", 
    RowBox[{"I", "-", 
     RowBox[{
      SubscriptBox["v", "1"], "\[CircleTimes]", 
      SubscriptBox["v", "1"]}]}]}], TraditionalForm]],ExpressionUUID->
  "abf3b82f-af9d-43d2-8886-17b8948838cc"],
 "is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "m"}], TraditionalForm]],ExpressionUUID->
  "cd7e5cce-b666-4e76-af1f-43d29f7c5254"],
 ".  After the first step we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "1"], "=", 
    RowBox[{
     SubscriptBox["H", "1"], ".", 
     SubscriptBox["A", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "8d245a9f-6042-489a-aa71-61d5cf55c832"],
 " with a reduced first column. "
}], "Item",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.8470020974449587`*^9, 3.847002238999034*^9}, {
  3.847007309209022*^9, 
  3.847007319305571*^9}},ExpressionUUID->"7cedb3d0-40ec-4ca4-a90a-\
6f7445d70b87"],

Cell[CellGroupData[{

Cell[TextData[{
 "The second one ",
 Cell[BoxData[
  FormBox[
   RowBox[{"I", "-", 
    RowBox[{
     SubscriptBox["v", "2"], "\[CircleTimes]", 
     SubscriptBox["v", "2"]}]}], TraditionalForm]],ExpressionUUID->
  "eb5a5e50-cb40-4c3f-a5ad-bf3b05b74105"],
 "is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", "-", "1"}], ")"}], "\[Times]", 
    RowBox[{"(", 
     RowBox[{"m", "-", "1"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "9dbf69a1-bfe8-4cfa-808f-44addb8b91c0"],
 " which acts only on the lower ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", "-", "1"}], ")"}], "\[Times]", "n"}], TraditionalForm]],
  ExpressionUUID->"39fb6ec1-efb6-4dc2-8318-8d18433ccd37"],
 " portion of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "1"], TraditionalForm]],ExpressionUUID->
  "c71e413a-7be8-4250-a456-0642e2280c4c"],
 "to give ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "2"], TraditionalForm]],ExpressionUUID->
  "42c79628-b9e8-46ad-9731-c399e143cb47"],
 ". "
}], "Item",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470023631795473`*^9}, {3.847002700829611*^9, 
  3.84700271145413*^9}},ExpressionUUID->"b3564f53-268d-4b77-9e37-\
54500ce260b5"],

Cell[TextData[{
 "Embedding it in the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "m"}], TraditionalForm]],ExpressionUUID->
  "b96d08e4-118f-4b33-880a-989204c56150"],
 " reflector ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "2"], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0"},
       {"0", 
        RowBox[{"Id", "-", 
         RowBox[{
          SubscriptBox["v", "2"], "\[CircleTimes]", 
          SubscriptBox["v", "2"]}]}]}
      },
      GridBoxDividers->{
       "Columns" -> {False, {True}, False}, 
        "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"feefa5d1-99ec-489e-9660-b56f69ec5635"],
 " lets us write ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "2"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["H", "2"], ".", 
      SubscriptBox["A", "1"]}], "=", 
     RowBox[{
      SubscriptBox["H", "2"], ".", 
      SubscriptBox["H", "1"], ".", 
      SubscriptBox["A", "0"]}]}]}], TraditionalForm]],ExpressionUUID->
  "1657c84c-31ef-4c78-9a34-2f49767e2620"],
 "."
}], "Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.84700256764564*^9}, {3.847007330687872*^9, 
  3.847007348275137*^9}},ExpressionUUID->"b20cb555-b42f-431f-9b62-\
f0dd57cfd154"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The third one ",
 Cell[BoxData[
  FormBox[
   RowBox[{"I", "-", 
    RowBox[{
     SubscriptBox["v", "3"], "\[CircleTimes]", 
     SubscriptBox["v", "3"]}]}], TraditionalForm]],ExpressionUUID->
  "57597edb-0156-4ce1-a489-977d4432d569"],
 "is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", "-", "2"}], ")"}], "\[Times]", 
    RowBox[{"(", 
     RowBox[{"m", "-", "2"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "cb9bd903-1905-4b5f-8058-a93a366fca8d"],
 " which acts only on the lower ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", "-", "2"}], ")"}], "\[Times]", "n"}], TraditionalForm]],
  ExpressionUUID->"9ba84d57-ec96-41f1-97b2-3b4d5426c74b"],
 " portion of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "2"], TraditionalForm]],ExpressionUUID->
  "00c83876-29d9-47ee-aa83-3ace9a6d2871"],
 " to give ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "3"], TraditionalForm]],ExpressionUUID->
  "ba9b44b7-6f3e-48c0-b668-5ee0863bbe8e"],
 ".  "
}], "Item",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470023631795473`*^9}, {3.8470025891409683`*^9, 
  3.847002613569109*^9}, {3.8470027168201237`*^9, 
  3.847002723123845*^9}},ExpressionUUID->"53aa9822-4707-4c1c-a80f-\
7a72a8e68c15"],

Cell[TextData[{
 "Embedding it in the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "m"}], TraditionalForm]],ExpressionUUID->
  "6fb4477d-dc08-43b0-b23c-a0d0154c6b3a"],
 " reflector ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "3"], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"1", "0"},
           {"0", "1"}
          },
          
          GridBoxDividers->{
           "Columns" -> {False, {True}, False}, 
            "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0"},
           {"0", "0"}
          },
          
          GridBoxDividers->{
           "Columns" -> {False, {True}, False}, 
            "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}]},
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0"},
           {"0", "0"}
          },
          
          GridBoxDividers->{
           "Columns" -> {False, {True}, False}, 
            "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}], 
        RowBox[{"Id", "-", 
         RowBox[{
          SubscriptBox["v", "3"], "\[CircleTimes]", 
          SubscriptBox["v", "3"]}]}]}
      },
      GridBoxDividers->{
       "Columns" -> {False, {True}, False}, 
        "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"fee4c6d2-d48c-4df1-819d-da0bfb656321"],
 " lets us write ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "3"], "=", 
    RowBox[{
     SubscriptBox["H", "3"], ".", 
     SubscriptBox["H", "2"], ".", 
     SubscriptBox["H", "1"], ".", 
     SubscriptBox["A", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "b4ed76a0-9de3-4919-8940-00679fac1926"],
 "."
}], "Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.84700256764564*^9}, {3.84700262270265*^9, 
  3.847002676708994*^9}, {3.8470027297845173`*^9, 3.8470027346210203`*^9}, {
  3.847007359928317*^9, 
  3.847007376235608*^9}},ExpressionUUID->"30fa95d3-bb99-42d8-a2b8-\
a74d6636a919"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 " When we are done we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"R"},
       {"0"}
      },
      GridBoxDividers->{
       "Columns" -> {False, {True}, False}, 
        "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}], "=", 
    RowBox[{
     SubscriptBox["A", "n"], "=", 
     RowBox[{
      SubscriptBox["H", "n"], ".", 
      SubscriptBox["H", 
       RowBox[{"n", "-", "1"}]], ".", 
      SubscriptBox["\[Ellipsis]H", "2"], ".", 
      SubscriptBox["H", "1"], ".", 
      SubscriptBox["A", "0"]}]}]}], TraditionalForm]],ExpressionUUID->
  "67dce6f9-8c22-4319-8758-6a07a5d86149"],
 " "
}], "Item",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470025670314703`*^9}, {3.8470027417806873`*^9, 
  3.847002830982769*^9}, {3.847002897043707*^9, 3.847002897044158*^9}, {
  3.8470073989402742`*^9, 
  3.847007416944419*^9}},ExpressionUUID->"a8d9f65e-651b-4428-b43f-\
63e2904b9560"],

Cell[TextData[{
 "By construction the product ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    FormBox[
     RowBox[{"H", "=", 
      RowBox[{
       SubscriptBox["H", "n"], ".", 
       SubscriptBox["H", 
        RowBox[{"n", "-", "1"}]], ".", 
       SubscriptBox["\[Ellipsis]H", "2"], ".", 
       SubscriptBox["H", "1"]}]}],
     TraditionalForm]}], TraditionalForm]],ExpressionUUID->
  "897ed0fe-c960-437f-84ac-11410a6b8906"],
 "satisfies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", ".", 
     SubscriptBox["A", "0"]}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"R"},
       {"0"}
      },
      GridBoxDividers->{
       "Columns" -> {False, {True}, False}, 
        "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"6742cf47-4e48-4c5c-929f-92ab8f32b586"]
}], "Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470025670314703`*^9}, {3.8470027417806873`*^9, 
  3.847002830982769*^9}, {3.8470028986497183`*^9, 3.847003036713876*^9}, {
  3.8470074250831957`*^9, 
  3.8470074439900017`*^9}},ExpressionUUID->"216087c5-f7c2-4814-ab74-\
b33bd921ee28"],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"H", "\[Transpose]"}], ".", "H"}], "=", "Id"}], 
   TraditionalForm]],ExpressionUUID->"ad79fa6f-219a-4304-be09-0c015adb02e1"],
 " we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "0"], "=", 
    RowBox[{
     RowBox[{"H", "\[Transpose]"}], ".", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"R"},
        {"0"}
       },
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, 
         "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"dd47faa9-492b-47f4-aace-d5824234aa98"]
}], "Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470025670314703`*^9}, {3.8470027417806873`*^9, 
  3.847002830982769*^9}, {3.8470028986497183`*^9, 3.8470030951642447`*^9}, {
  3.847003289249433*^9, 3.847003289250148*^9}, {3.847007449254537*^9, 
  3.8470074607113333`*^9}, {3.847007540013317*^9, 
  3.847007540014333*^9}},ExpressionUUID->"36bd8c73-c653-4add-a004-\
2d20d03c84fe"],

Cell[TextData[{
 "If Q\[Transpose] is the first n rows of H i.e ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Q", "\[Transpose]"}], "=", 
    RowBox[{"H", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{
       RowBox[{"1", ";"}], " ", ";", "n"}], ",", 
      RowBox[{
       RowBox[{"1", ";"}], " ", ";", "m"}]}], "\[RightDoubleBracket]"}], 
    " "}], TraditionalForm]],ExpressionUUID->
  "69ea549e-6847-45d2-8bc2-726e1c96d567"],
 " then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "0"], "=", 
    RowBox[{"Q", ".", "R"}]}], TraditionalForm]],ExpressionUUID->
  "5182236a-2c75-4c4d-b9e8-721d744dea51"]
}], "Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470025670314703`*^9}, {3.8470027417806873`*^9, 
  3.847002830982769*^9}, {3.8470028986497183`*^9, 3.8470030951642447`*^9}, {
  3.847003289249433*^9, 3.847003289250148*^9}, {3.847007449254537*^9, 
  3.8470074607113333`*^9}, {3.847007542109439*^9, 3.847007617406598*^9}, {
  3.847007677597034*^9, 3.847007791013453*^9}, {3.8470078736748238`*^9, 
  3.847007876354158*^9}, {3.8470079212165213`*^9, 3.847007931361175*^9}, {
  3.847007988815695*^9, 
  3.847007991432273*^9}},ExpressionUUID->"eb164d3e-7ddf-4760-a347-\
2627a8ac14ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["There are actually two things we might be interested in", "Item",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470025670314703`*^9}, {3.8470027417806873`*^9, 
  3.847002830982769*^9}, {3.8470028986497183`*^9, 3.8470030951642447`*^9}, {
  3.8470032919096727`*^9, 3.847003299699671*^9}, {3.847003333309095*^9, 
  3.847003347114327*^9}},ExpressionUUID->"0fadd674-1c15-4122-85e7-\
126d35651527"],

Cell[TextData[{
 "The entire square matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Q", "big"], "=", 
    RowBox[{
     RowBox[{"H", "\[Transpose]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["H", "n"], ".", 
         SubscriptBox["H", 
          RowBox[{"n", "-", "1"}]], ".", 
         SubscriptBox["\[Ellipsis]H", "2"], ".", 
         SubscriptBox["H", "1"]}], ")"}], "\[Transpose]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["H", "1"], ".", 
         SubscriptBox["H", "2"]}], "..."}], ".", 
       SubscriptBox["H", "n"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "3afc6cfa-d04e-4030-b0b9-af6db23b0bb8"]
}], "Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470025670314703`*^9}, {3.8470027417806873`*^9, 
  3.847002830982769*^9}, {3.8470028986497183`*^9, 3.8470030951642447`*^9}, {
  3.8470032919096727`*^9, 3.847003299699671*^9}, {3.847003333309095*^9, 
  3.847003370189354*^9}, {3.8470072109024763`*^9, 3.847007253242709*^9}, {
  3.847007466711025*^9, 3.847007479895153*^9}, {3.8470081073656807`*^9, 
  3.847008235099778*^9}},ExpressionUUID->"07312013-09f6-4de0-a1e5-\
c25de07f8882"],

Cell[TextData[{
 "The tall skinny ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "c2cfc320-07cf-4892-8d4f-b3e0c946d139"],
 " matrix Q from the QR decomposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "=", 
    RowBox[{
     SubscriptBox["Q", "big"], "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{
       RowBox[{"1", ";"}], " ", ";", "m"}], ",", 
      RowBox[{
       RowBox[{"1", ";"}], " ", ";", "n"}]}], "\[RightDoubleBracket]"}]}], 
   TraditionalForm]],ExpressionUUID->"ba79b4ce-dcdd-4d71-a03b-c4d7890a1f78"],
 "."
}], "Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470025670314703`*^9}, {3.8470027417806873`*^9, 
  3.847002830982769*^9}, {3.8470028986497183`*^9, 3.8470030951642447`*^9}, {
  3.8470032919096727`*^9, 3.847003299699671*^9}, {3.847003333309095*^9, 
  3.847003370189354*^9}, {3.8470072109024763`*^9, 3.8470072307841187`*^9}, {
  3.847007262800291*^9, 3.84700729837572*^9}, {3.847007486471471*^9, 
  3.847007519420209*^9}, {3.847007948002748*^9, 3.8470080471513577`*^9}, {
  3.847008085204179*^9, 3.8470080879673*^9}, {3.847008256393942*^9, 
  3.847008304264284*^9}},ExpressionUUID->"5bf311e1-295c-4744-ab2f-\
d46eb201be94"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Householder H:
Function\
\>", "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
  3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
  3.8469335254269605`*^9}, {3.8469372186478972`*^9, 3.8469372557172794`*^9}, {
  3.8469375026313*^9, 3.846937508278796*^9}, {3.846937553989224*^9, 
  3.8469375682672977`*^9}, {3.846938893485902*^9, 3.8469388943058777`*^9}, {
  3.8469391846402254`*^9, 3.8469391856207337`*^9}, {3.846998705312707*^9, 
  3.846998705498599*^9}, {3.846999571002205*^9, 3.846999573291185*^9}, {
  3.847000307144331*^9, 3.847000308223342*^9}, {3.847008563700644*^9, 
  3.847008578444953*^9}},ExpressionUUID->"370c8ed7-8ec2-4150-a873-\
3974a32bcd8d"],

Cell["\<\
Here is a function reducing a Tall Skinny matrix A to upper triangular which \
overwrites A and returns the entire Householder H. \
\>", "Text",
 CellChangeTimes->{{3.846932854787759*^9, 3.8469329103313017`*^9}, {
   3.8469333722095346`*^9, 3.846933456294175*^9}, {3.846933532225792*^9, 
   3.8469336109655237`*^9}, {3.846933662678347*^9, 3.84693387213366*^9}, {
   3.8469340875665607`*^9, 3.846934291563596*^9}, {3.8469350079034543`*^9, 
   3.8469350094851847`*^9}, 3.8469353408127766`*^9, {3.846936659235436*^9, 
   3.846936939960298*^9}, {3.846937265493534*^9, 3.846937331605727*^9}, {
   3.8469374675167007`*^9, 3.846937467905089*^9}, {3.846937515791397*^9, 
   3.8469375232198505`*^9}, {3.8469380625211287`*^9, 3.846938170660471*^9}, {
   3.8469384910505347`*^9, 3.8469385428820353`*^9}, {3.846998730239862*^9, 
   3.846998776872889*^9}, {3.846999386291897*^9, 3.846999397060482*^9}, {
   3.846999786209866*^9, 3.8469998173543663`*^9}, {3.847000320359261*^9, 
   3.847000377158641*^9}, {3.847008584484722*^9, 
   3.84700859251709*^9}},ExpressionUUID->"f25cb99a-71d2-4146-95d8-\
f10f5c178924"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"QRH", ",", "HoldFirst"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QRH", "[", "A_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n", ",", "v", ",", "H"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"IdentityMatrix", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Householder", " ", "Reduction", " ", "from", " ", "Script", " ", 
       "Version", " ", "3"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"HouseVec", "[", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"i", ";;", 
             RowBox[{"-", "1"}]}], ",", "i"}], "\[RightDoubleBracket]"}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Reduces", " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", ";;", 
              RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"i", ";;", 
               RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{"2", " ", "v", " ", 
             RowBox[{"(", 
              RowBox[{"v", ".", 
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"i", ";;", 
                  RowBox[{"-", "1"}]}], ",", "j"}], 
                "\[RightDoubleBracket]"}]}], ")"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Updates", " ", "H", " ", "with", " ", 
          RowBox[{"v", ".", " ", "Note"}], " ", "it", " ", "needs", " ", "to",
           " ", "do", " ", "all", " ", "the", " ", "columns"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"H", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", ";;", 
              RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{
            RowBox[{"H", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"i", ";;", 
               RowBox[{"-", "1"}]}], ",", "j"}], "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{"2", " ", "v", " ", 
             RowBox[{"(", 
              RowBox[{"v", ".", 
               RowBox[{"H", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"i", ";;", 
                  RowBox[{"-", "1"}]}], ",", "j"}], 
                "\[RightDoubleBracket]"}]}], ")"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Returns", " ", "Accumulated", " ", "Householder", " ", "H"}], 
      " ", "*)"}], "\[IndentingNewLine]", "H"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.847000382632509*^9, 3.8470005491366158`*^9}, {
  3.84700860936919*^9, 3.847008756783255*^9}, {3.847008814057878*^9, 
  3.84700883006345*^9}, {3.847008860203185*^9, 3.8470088610900183`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"4a910f2b-72c3-489c-adbf-85963a08255a"],

Cell["As always TEST!  T", "Text",
 CellChangeTimes->{{3.847000562255906*^9, 3.847000584836035*^9}, {
  3.847000684434866*^9, 3.847000717038898*^9}, {3.84700083990224*^9, 
  3.847000849420988*^9}, {3.84701284844525*^9, 
  3.847012855070857*^9}},ExpressionUUID->"24955d86-0f27-47b2-9319-\
dff202390229"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"15", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A0", "=", 
   RowBox[{"A", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}]}], ";", " ", 
  RowBox[{"V", "=", 
   RowBox[{"0.0", "*", "A"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"QRH", "[", "A", "]"}]}], ";", 
  RowBox[{"QBig", "=", 
   RowBox[{"H", "\[Transpose]"}]}], ";", " ", 
  RowBox[{"R", "=", 
   RowBox[{"A", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "n"}], ",", 
     RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}]}], ";", " ", 
  RowBox[{"Q", "=", 
   RowBox[{"QBig", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", 
     RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"H", "\[Transpose]"}], ".", "H"}], "-", 
      RowBox[{"IdentityMatrix", "[", "m", "]"}]}], ",", 
     RowBox[{"A", "-", 
      RowBox[{"H", ".", "A0"}]}], ",", 
     RowBox[{"A0", "-", 
      RowBox[{"QBig", ".", "A"}]}], ",", " ", 
     RowBox[{"A0", "-", 
      RowBox[{"Q", ".", "R"}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"H", "\[Transpose]"}], ".", "H"}], "-", 
      RowBox[{"IdentityMatrix", "[", "m", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"QBig", "\[Transpose]"}], ".", "QBig"}], " ", "-", 
      RowBox[{"IdentityMatrix", "[", "m", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Q", "\[Transpose]"}], ".", "Q"}], " ", "-", " ", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8469370323032928`*^9, 3.8469371705899577`*^9}, {
  3.846937334732747*^9, 3.846937390283722*^9}, {3.846938221952484*^9, 
  3.846938350861267*^9}, {3.8469384054659576`*^9, 3.846938481047811*^9}, {
  3.8469385642503386`*^9, 3.8469388748245225`*^9}, {3.846939753022072*^9, 
  3.846939793671465*^9}, {3.84699814720088*^9, 3.846998201973194*^9}, {
  3.8469987410107327`*^9, 3.8469988430402117`*^9}, {3.846998894736611*^9, 
  3.84699922195962*^9}, {3.8469992846020947`*^9, 3.8469993005897093`*^9}, {
  3.8469993528345346`*^9, 3.846999376461938*^9}, {3.846999588292577*^9, 
  3.846999689999892*^9}, {3.847000600420092*^9, 3.847000630378351*^9}, {
  3.84700877539044*^9, 3.847008797080518*^9}, {3.8470088423685207`*^9, 
  3.847008843390177*^9}, {3.8470088752101297`*^9, 3.847009118367351*^9}, {
  3.847012773201426*^9, 3.847012831528084*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"58d846b2-9d18-41fc-843d-86003b114249"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6.192567283340852`*^-16", ",", "9.520367681376745`*^-16", ",", 
   "1.048669461727064`*^-15", ",", "1.0295898633192871`*^-15"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.847000631667244*^9, {3.847008782229096*^9, 3.847008797805624*^9}, {
   3.847008837232683*^9, 3.847008953414874*^9}, 3.847008998214591*^9, {
   3.8470090450220833`*^9, 3.8470091201145353`*^9}, {3.847012777390975*^9, 
   3.847012786500555*^9}, 3.847012836028627*^9, 3.8529909414059324`*^9, 
   3.852997784207328*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"4a3771eb-4b82-4e55-80e8-9e9f948112e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6.192567283340852`*^-16", ",", "5.939593420478372`*^-16", ",", 
   "2.372239310195052`*^-16"}], "}"}]], "Output",
 CellChangeTimes->{
  3.847000631667244*^9, {3.847008782229096*^9, 3.847008797805624*^9}, {
   3.847008837232683*^9, 3.847008953414874*^9}, 3.847008998214591*^9, {
   3.8470090450220833`*^9, 3.8470091201145353`*^9}, {3.847012777390975*^9, 
   3.847012786500555*^9}, 3.847012836028627*^9, 3.8529909414059324`*^9, 
   3.852997784225441*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"2814bb67-8b1f-496a-ad85-c72b45fe9c8b"]
}, Open  ]],

Cell["\<\
This is very inefficient for tall-skinny matrices if you only need the \
tall-skinny Q.  \
\>", "Item",
 CellChangeTimes->{{3.846999845740571*^9, 3.847000081377425*^9}, {
  3.847000222997814*^9, 3.847000263197782*^9}, {3.8470091392623587`*^9, 
  3.847009149366041*^9}, {3.847012623119878*^9, 3.847012726950128*^9}, {
  3.8470128684370613`*^9, 
  3.847012884438087*^9}},ExpressionUUID->"2a1206b6-bcf5-408b-8a9d-\
7d482785ee5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Building Q from V 
Plan 2\
\>", "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
   3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
   3.8469335254269605`*^9}, {3.8469372186478972`*^9, 
   3.8469372557172794`*^9}, {3.8469375026313*^9, 3.846937508278796*^9}, {
   3.846937553989224*^9, 3.8469375682672977`*^9}, {3.846938893485902*^9, 
   3.8469388943058777`*^9}, {3.8469391846402254`*^9, 
   3.8469391856207337`*^9}, {3.846998705312707*^9, 3.846998705498599*^9}, {
   3.846999571002205*^9, 3.846999573291185*^9}, {3.847000307144331*^9, 
   3.847000308223342*^9}, {3.847000894372295*^9, 3.847000922486709*^9}, {
   3.847003109087948*^9, 3.847003110334525*^9}, 3.847003261542013*^9, {
   3.8470129573713503`*^9, 3.847012957703704*^9}, {3.847013267188018*^9, 
   3.8470132677675667`*^9}},ExpressionUUID->"041c091f-5d41-4ce8-9f98-\
a63b636f913e"],

Cell[TextData[{
 "We reduce the tall-skinny ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "79ed1f0f-0a0b-4600-aa68-df2a446b4b61"],
 " matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "0"], TraditionalForm]],ExpressionUUID->
  "7276c77c-dd5b-4608-889a-1018a3320726"],
 " with a sequence of Householder reflectors that created zeros in the lower \
triangle of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "0"], TraditionalForm]],ExpressionUUID->
  "1144d6d9-b96c-4118-bbe6-1c890cd1865c"]
}], "Text",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
   3.847001787114211*^9, 3.847001813862543*^9}, {3.8470018672624083`*^9, 
   3.847001867807458*^9}, 3.8470019394360247`*^9, {3.847002119781258*^9, 
   3.847002123898239*^9}, 
   3.847002681254529*^9},ExpressionUUID->"966d80e7-1232-4256-ba8a-\
80b2f8e8e857"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"H", "=", 
    RowBox[{
     SubscriptBox["H", "n"], ".", 
     SubscriptBox["H", 
      RowBox[{"n", "-", "1"}]], ".", 
     SubscriptBox["\[Ellipsis]H", "2"], ".", 
     SubscriptBox["H", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "c317d697-a1f3-4d49-b522-a97d120b4b09"],
 " satisfies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", ".", 
     SubscriptBox["A", "0"]}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"R"},
       {"0"}
      },
      GridBoxDividers->{
       "Columns" -> {False, {True}, False}, 
        "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"238bba01-67b0-430d-8fbf-5b0b793cf666"],
 "  where  "
}], "Item",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.8470020974449587`*^9, 3.847002238999034*^9}, {
  3.847007309209022*^9, 3.847007319305571*^9}, {3.8470134190548773`*^9, 
  3.847013572242815*^9}, {3.847013662324134*^9, 
  3.847013662972641*^9}},ExpressionUUID->"ab9382e2-78d7-47fb-875d-\
0d83862e431d"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "1"], "=", 
    RowBox[{"I", "-", 
     RowBox[{
      SubscriptBox["v", "1"], "\[CircleTimes]", 
      SubscriptBox["v", "1"]}]}]}], TraditionalForm]],ExpressionUUID->
  "f1a9acf8-6805-4f99-b3bc-2ebfb1fea285"],
 " and more generally "
}], "Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.8470020974449587`*^9, 3.847002238999034*^9}, {
  3.847007309209022*^9, 3.847007319305571*^9}, {3.8470134190548773`*^9, 
  3.847013609628285*^9}, {3.847013648900453*^9, 
  3.847013651204852*^9}},ExpressionUUID->"b183f334-4006-4b40-9fee-\
dc3e45b8335a"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["H", "i"], "=", 
   RowBox[{
    SubscriptBox["H", "3"], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        SubscriptBox["I", 
         RowBox[{"i", "-", "1"}]], "0"},
       {"0", 
        RowBox[{
         SubscriptBox["I", "i"], "-", 
         RowBox[{
          SubscriptBox["v", "i"], "\[CircleTimes]", 
          SubscriptBox["v", "i"]}]}]}
      },
      GridBoxDividers->{
       "Columns" -> {False, {True}, False}, 
        "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}]}]}], 
  TraditionalForm]],ExpressionUUID->"d69be9b4-7d55-44db-a635-b3b52f969489"]], \
"Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.8470020974449587`*^9, 3.847002238999034*^9}, {
  3.847007309209022*^9, 3.847007319305571*^9}, {3.8470134190548773`*^9, 
  3.847013669044176*^9}},ExpressionUUID->"dab590de-3e44-4aac-b5d1-\
c77da37eed5d"]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"QBig", "=", 
    RowBox[{
     RowBox[{"H", "\[Transpose]"}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["H", "1"], ".", 
       SubscriptBox["H", "2"]}], 
      SubscriptBox["\[Ellipsis]H", "n"]}]}]}], TraditionalForm]],
  ExpressionUUID->"c571f419-b8be-4f2e-9714-d793c1e16838"],
 " and the first n columns of ",
 Cell[BoxData[
  FormBox["QBig", TraditionalForm]],ExpressionUUID->
  "8abe002a-7dfb-4e36-95f7-fdab638a8387"],
 " which gives the QR decomposition"
}], "Item",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.8470020974449587`*^9, 3.847002238999034*^9}, {
  3.847007309209022*^9, 3.847007319305571*^9}, {3.8470134190548773`*^9, 
  3.84701374954873*^9}, {3.847014026125988*^9, 3.84701403977743*^9}, {
  3.84701408555226*^9, 3.8470140954715652`*^9}, {3.847014154855421*^9, 
  3.847014227032043*^9}},ExpressionUUID->"72fca0e6-ceb5-4d90-aacb-\
20f538aeff60"],

Cell["The key is to remember that ", "Text",
 CellChangeTimes->{{3.847014108550984*^9, 
  3.847014122886251*^9}},ExpressionUUID->"2ca9b1c4-7f85-443f-8e39-\
3d16b2b1a141"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", ".", 
    SubscriptBox["e", "i"]}], TraditionalForm]],ExpressionUUID->
  "b240ce74-35fa-4e36-ac42-59cf1dc2e19c"],
 " gives column i  of any matrix ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "97d5c2d3-e09a-413e-b921-59d3bd32a678"]
}], "Item",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470023631795473`*^9}, {3.847002700829611*^9, 
  3.84700271145413*^9}, {3.84701376277626*^9, 3.847013807577464*^9}, {
  3.847013860662315*^9, 3.8470140193226547`*^9}, {3.8470142399844637`*^9, 
  3.847014240224729*^9}},ExpressionUUID->"5cc437c9-9798-4536-a43b-\
b4cced1678ea"],

Cell[TextData[{
 "If I compute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["H", "1"], ".", " ", 
     SubscriptBox["H", "2"]}], " ", 
    RowBox[{
     SubscriptBox["\[Ellipsis]H", "n"], ".", 
     SubscriptBox["e", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "5286298e-6f19-49ba-8471-92572620ccda"],
 " I get the first column of ",
 Cell[BoxData[
  FormBox["QBig", TraditionalForm]],ExpressionUUID->
  "dd08ad97-0944-42d8-9f17-10e99887b5c1"],
 "."
}], "Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470023631795473`*^9}, {3.847002700829611*^9, 
  3.84700271145413*^9}, {3.84701376277626*^9, 3.847013807577464*^9}, {
  3.847013860662315*^9, 3.847014017917593*^9}, {3.8470142427516937`*^9, 
  3.8470143372571497`*^9}, {3.847014380778393*^9, 
  3.847014435588339*^9}},ExpressionUUID->"ef8d1056-0bd5-45bf-a22e-\
a6003887575d"],

Cell[TextData[{
 "If I compute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["H", "1"], ".", " ", 
     SubscriptBox["H", "2"]}], " ", 
    RowBox[{
     SubscriptBox["\[Ellipsis]H", "n"], ".", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         SubscriptBox["I", 
          RowBox[{"n", "\[Times]", "n"}]]},
        {
         SubscriptBox["0", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "n"}], ")"}], "\[Times]", "n"}]]}
       },
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, 
         "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"01e0228e-eca4-4f71-b1bd-7be59d822f0d"],
 " I get the first n columns of ",
 Cell[BoxData[
  FormBox["QBig", TraditionalForm]],ExpressionUUID->
  "2a39c1b0-30cd-4c9e-b890-ab3e77bdb70d"],
 " otherwise known as ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "76cfd617-dd8a-4c05-9f87-257b646c60ad"]
}], "Subitem",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470023631795473`*^9}, {3.847002700829611*^9, 
  3.84700271145413*^9}, {3.84701376277626*^9, 3.847013807577464*^9}, {
  3.847013860662315*^9, 3.847014017917593*^9}, {3.8470142427516937`*^9, 
  3.8470143372571497`*^9}, {3.847014380778393*^9, 
  3.847014520072586*^9}},ExpressionUUID->"99b5d72e-7890-4622-b251-\
079f14f324e3"]
}, Open  ]],

Cell[TextData[{
 "I am going to build a function that computes ",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", ".", "X"}], TraditionalForm]],ExpressionUUID->
  "f58c6b36-4d5a-4bb9-8348-748058fe8405"],
 " where ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]],ExpressionUUID->
  "a88e1a0f-e51d-4a14-82da-c1d47190ce45"],
 " is specified by the tall skinny matrix of Householder ",
 Cell[BoxData[
  FormBox["Vs", TraditionalForm]],ExpressionUUID->
  "37829743-22f1-4eb2-a241-929401adf023"],
 ". "
}], "Item",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470023631795473`*^9}, {3.847002700829611*^9, 
  3.84700271145413*^9}, {3.84701376277626*^9, 3.847013807577464*^9}, {
  3.847013860662315*^9, 3.847014017917593*^9}, {3.8470142427516937`*^9, 
  3.8470143372571497`*^9}, {3.847014380778393*^9, 3.8470147182734337`*^9}, {
  3.847014748909618*^9, 
  3.8470147489121227`*^9}},ExpressionUUID->"0a6f3897-cdca-42db-9639-\
50348e77d4a6"],

Cell["\<\
It looks very similar to the H bit in plan2 but the loop runs backwards.\
\>", "Item",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
  3.847001787114211*^9, 3.8470018486271467`*^9}, {3.8470018910558863`*^9, 
  3.8470018910559607`*^9}, {3.847001928870655*^9, 3.847002030500515*^9}, {
  3.847002249303072*^9, 3.8470023631795473`*^9}, {3.847002700829611*^9, 
  3.84700271145413*^9}, {3.84701376277626*^9, 3.847013807577464*^9}, {
  3.847013860662315*^9, 3.847014017917593*^9}, {3.8470142427516937`*^9, 
  3.8470143372571497`*^9}, {3.847014380778393*^9, 3.8470147182734337`*^9}, {
  3.8470147503383017`*^9, 
  3.8470147877773933`*^9}},ExpressionUUID->"1a844fa9-4383-4fe6-9f03-\
1c09b85bdf58"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Building Q from V:
Function\
\>", "Subsection",
 CellChangeTimes->{{3.8468400908517523`*^9, 3.846840125313773*^9}, {
  3.846841365233275*^9, 3.8468413765615253`*^9}, {3.8469334869596004`*^9, 
  3.8469335254269605`*^9}, {3.8469372186478972`*^9, 3.8469372557172794`*^9}, {
  3.8469375026313*^9, 3.846937508278796*^9}, {3.846937553989224*^9, 
  3.8469375682672977`*^9}, {3.846938893485902*^9, 3.8469388943058777`*^9}, {
  3.8469391846402254`*^9, 3.8469391856207337`*^9}, {3.846998705312707*^9, 
  3.846998705498599*^9}, {3.846999571002205*^9, 3.846999573291185*^9}, {
  3.847000307144331*^9, 3.847000308223342*^9}, {3.847000894372295*^9, 
  3.847000922486709*^9}, {3.847003109087948*^9, 3.847003110334525*^9}, {
  3.847003261542013*^9, 3.847003277133894*^9}, {3.8470084823674583`*^9, 
  3.84700849813335*^9}, {3.8470148217773933`*^9, 
  3.847014825176989*^9}},ExpressionUUID->"cf152260-9201-4ded-b25e-\
73f99118999a"],

Cell["\<\
As before we update X in place.  I got fancy and tested if the dimensions \
matched!\
\>", "Text",
 CellChangeTimes->{{3.8470017425160723`*^9, 3.847001746973474*^9}, {
   3.847001787114211*^9, 3.847001813862543*^9}, {3.8470018672624083`*^9, 
   3.847001867807458*^9}, 3.8470019394360247`*^9, {3.847002119781258*^9, 
   3.847002123898239*^9}, 3.847002681254529*^9, {3.8470150365391483`*^9, 
   3.8470150672431183`*^9}},ExpressionUUID->"2449f0b9-66cd-4ed3-81fc-\
126f813c0941"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"ApplyHouseholderV", ",", "HoldFirst"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyHouseholderV", "[", 
   RowBox[{"X_", ",", "V_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n", ",", "mr", ",", "r", ",", "v"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mr", ",", "r"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mr", "\[NotEqual]", "m"}], ",", 
       RowBox[{
       "Return", "[", "\"\<ApplyHousholderV: Dimension mismatch!\>\"", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"V", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"X", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{"X", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "-", 
            RowBox[{"2", " ", "v", " ", 
             RowBox[{"(", 
              RowBox[{"v", ".", 
               RowBox[{"X", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}]}], 
              ")"}]}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "r"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "n", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8470148561597767`*^9, 3.847015027595871*^9}, {
   3.847015076021435*^9, 3.847015214202137*^9}, {3.847015780178227*^9, 
   3.847015783149487*^9}, {3.847017080755742*^9, 3.847017081038899*^9}, 
   3.8470177565416517`*^9, {3.847017791329029*^9, 3.84701779387226*^9}, {
   3.8529910491061296`*^9, 3.8529910639898586`*^9}, {3.852997994491023*^9, 
   3.852997998602651*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"0a4403a0-db07-4572-b8fb-cdb7ab2db1b6"],

Cell["As always test! First the intended use case! ", "Text",
 CellChangeTimes->{{3.847015236228566*^9, 3.847015271459536*^9}, {
  3.847015822554329*^9, 3.847015822827859*^9}, {3.847015997043367*^9, 
  3.847016004541134*^9}},ExpressionUUID->"14e67011-4020-43a9-8f14-\
fe5ce3a11c55"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"12", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"A0", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"MyQR", "[", "A0", "]"}]}], ";", " ", 
  RowBox[{"R", "=", 
   RowBox[{"A0", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "n"}], ",", 
     RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"0", "*", "V"}]}], ";", 
  RowBox[{
   RowBox[{"Q", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "n"}], ",", 
     RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyHouseholderV", "[", 
  RowBox[{"Q", ",", "V"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixPlot", "[", "Q", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Q", "\[Transpose]"}], ".", "Q"}], "-", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", 
     RowBox[{"A", "-", 
      RowBox[{"Q", ".", "R"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.847015274762681*^9, 3.847015302597802*^9}, {
  3.847015339281795*^9, 3.847015634482554*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"def187d4-411b-404f-b594-410bb58383be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.870068108343679`*^-16", ",", "1.27855712627874`*^-15"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8470155102032747`*^9, 3.847015562577816*^9, 
  3.8470156352959967`*^9, 3.847015787524362*^9, 3.847017083921646*^9, 
  3.8470173205859537`*^9, 3.847017796625648*^9, 3.8529911694220843`*^9, 
  3.8529912809806356`*^9, 3.8529982323934402`*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"2952c0e1-6437-4ae4-9f21-e2940de26314"]
}, Open  ]],

Cell["Now we get to test the error message as well. ", "Text",
 CellChangeTimes->{
  3.847015826125305*^9},ExpressionUUID->"14fe33d5-5839-46f1-82b2-\
ccebb8351b34"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"12", ",", "4"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mr", ",", "nr"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"11", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", " ", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mr", ",", "nr"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyHouseholderV", "[", 
  RowBox[{"X", ",", "V"}], "]"}]}], "Input",
 CellChangeTimes->{{3.847015274762681*^9, 3.847015302597802*^9}, {
  3.847015339281795*^9, 3.847015634482554*^9}, {3.847016019323677*^9, 
  3.8470160756361227`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"73075bd1-7c27-4a74-9dc5-15b34ceb1875"],

Cell[BoxData["\<\"ApplyHousholderV: Dimension mismatch!\"\>"], "Output",
 CellChangeTimes->{3.84701607617198*^9, 3.847017085957489*^9, 
  3.847017799635929*^9, 3.8529912843187003`*^9, 3.8529982753749285`*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"5aefcb62-c103-4729-ad78-0126b743e64e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bonus: Fast Orthogonal Vectors", "Section",
 CellChangeTimes->{{3.8470163858137627`*^9, 
  3.847016401997815*^9}},ExpressionUUID->"51a318e2-eec3-4c48-bd37-\
9db3eb0ed816"],

Cell[TextData[{
 "Suppose I would like ",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],ExpressionUUID->
  "d68c7fd4-46b7-4795-9a99-c4d6dae93529"],
 " vectors (r is very small compared to ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "326856b3-f12b-4523-9cfa-20823c2e7fbb"],
 " and small compared to ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "dce06021-1df9-45cd-8132-75cfec56c1ae"],
 ") that are orthogonal to the column space of tall-skinny ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "0b805e29-d837-4557-a5e8-888a5a01eafe"],
 " matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "."}], TraditionalForm]],ExpressionUUID->
  "b6c846ff-476e-4e7f-87e9-d6815fd8995e"],
 " We will see places later where this is not a weird thing to want. "
}], "Text",
 CellChangeTimes->{
  3.847015826125305*^9, {3.847016098604271*^9, 3.847016110668367*^9}, {
   3.847016147884646*^9, 3.847016328428022*^9}, {3.847016407901997*^9, 
   3.847016627699272*^9}},ExpressionUUID->"4be4d83e-990f-4cc6-b10d-\
5a088ccacfdf"],

Cell["\<\
Compute the Householder reduction of A and save the Householder vectors V.\
\>", "Item",
 CellChangeTimes->{
  3.847015826125305*^9, {3.847016098604271*^9, 3.847016110668367*^9}, {
   3.847016147884646*^9, 3.847016328428022*^9}, {3.847016407901997*^9, 
   3.847016647808181*^9}},ExpressionUUID->"0ae38005-8fbb-4615-bb11-\
64ecc6658249"],

Cell[CellGroupData[{

Cell[TextData[{
 "Applying the Householder vectors V to any set of vectors ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        SubscriptBox["0", 
         RowBox[{"n", "\[Times]", "r"}]]},
       {
        SubscriptBox["Y", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "-", "n"}], ")"}], "\[Times]", "r"}]]}
      },
      GridBoxDividers->{
       "Columns" -> {False, {True}, False}, 
        "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"5a2b8478-09ec-4fab-9f86-fb8f58dde6c6"],
 " to compute ",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", ".", "X"}], TraditionalForm]],ExpressionUUID->
  "55759c42-3476-475e-91b7-db242b9f3605"],
 " gives a set of ",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],ExpressionUUID->
  "5c695deb-21b7-47e1-89d7-94a92bdac40e"],
 " vectors orthogonal to the orthogonal basis Q for the column space of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "15071444-09cf-4cf1-b69b-95a353865960"],
 ".    "
}], "Item",
 CellChangeTimes->{
  3.847015826125305*^9, {3.847016098604271*^9, 3.847016110668367*^9}, {
   3.847016147884646*^9, 3.847016328428022*^9}, {3.847016407901997*^9, 
   3.847016842910445*^9}, {3.847017159382094*^9, 3.847017159385585*^9}, {
   3.847017191109583*^9, 
   3.847017197838286*^9}},ExpressionUUID->"8607cb25-e1f8-454f-832d-\
f8a57775379d"],

Cell[CellGroupData[{

Cell[TextData[{
 "Even better, if Y is orthogonal then so is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", ".", "X"}], TraditionalForm]],ExpressionUUID->
  "ac6f8c44-7ea0-41d9-9a6e-9b28f1de3888"],
 "  and as a result ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    RowBox[{"Q", ",", "X"}], "]"}], TraditionalForm]],ExpressionUUID->
  "3b717725-5e92-488c-9013-f6548593de28"],
 " is orthogonal! "
}], "Subitem",
 CellChangeTimes->{
  3.847015826125305*^9, {3.847016098604271*^9, 3.847016110668367*^9}, {
   3.847016147884646*^9, 3.847016328428022*^9}, {3.847016407901997*^9, 
   3.847016842910445*^9}, {3.847017160452091*^9, 3.847017236846594*^9}, {
   3.8470175105259867`*^9, 
   3.847017533574479*^9}},ExpressionUUID->"a73f660e-c6a1-4c1a-ac77-\
f5d38756ecb3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n", ",", "r"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"12", ",", "4", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"MyQR", "[", "A", "]"}]}], ";", " ", 
  RowBox[{"VOld", "=", "V"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"0", "*", "V"}]}], ";", 
  RowBox[{
   RowBox[{"Q", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "n"}], ",", 
     RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyHouseholderV", "[", 
   RowBox[{"Q", ",", "V"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"QRDecomposition", "[", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"m", "-", "n"}], ",", "r"}], "}"}]}], "]"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
    "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "r"}], "}"}]}], "]"}]},
       {"Y"}
      },
      GridBoxDividers->{
       "Columns" -> {False, {True}, False}, 
        "Rows" -> {False, {True}, False}}], "\[NoBreak]", ")"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyHouseholderV", "[", 
   RowBox[{"X", ",", "V"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QX", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"Q", ",", "X"}], "}"}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.847015274762681*^9, 3.847015302597802*^9}, {
   3.847015339281795*^9, 3.847015634482554*^9}, {3.84701614146137*^9, 
   3.847016145486871*^9}, {3.8470168563570757`*^9, 3.847017057749138*^9}, {
   3.847017104342992*^9, 3.847017138838571*^9}, {3.8470172414606953`*^9, 
   3.847017298744269*^9}, {3.847017340755322*^9, 3.847017388942168*^9}, {
   3.847017433197275*^9, 3.8470174974395733`*^9}, {3.847017541585578*^9, 
   3.847017738332775*^9}, {3.847017812523897*^9, 3.847017853265358*^9}, 
   3.852998379399825*^9, {3.852998413543391*^9, 
   3.8529984240455217`*^9}},ExpressionUUID->"789f0454-097b-421c-9017-\
ed0f391f7ea0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1141, 525},
WindowMargins->{{1520.5, Automatic}, {Automatic, -318}},
TaggingRules-><|
 "PresenterSettings" -> <|"Dialogs" -> {}|>, "TryRealOnly" -> False|>,
SpellingDictionaries->{"CorrectWords"->{"Schatten"}},
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5feffcf5-3f88-429d-97ea-945731425bd1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 500, 8, 146, "Title",ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],
Cell[1083, 32, 550, 10, 87, "Text",ExpressionUUID->"81b47a30-cbf5-44a1-b035-840c4d1878c2"],
Cell[CellGroupData[{
Cell[1658, 46, 463, 7, 100, "Section",ExpressionUUID->"2c54ee19-3f0a-4f3e-9333-ab8c9a1832bc"],
Cell[CellGroupData[{
Cell[2146, 57, 255, 4, 81, "Subsection",ExpressionUUID->"ff5a9bb7-5436-4220-93e6-34e47a0c6a5e"],
Cell[2404, 63, 2121, 62, 336, "Text",ExpressionUUID->"1b41932c-f3d2-45e2-970f-0c5f9f42a32f"],
Cell[4528, 127, 211, 4, 48, "ItemNumbered",ExpressionUUID->"3603a0d5-f3c6-4f21-90ff-f5b5261c3363"],
Cell[4742, 133, 278, 8, 48, "ItemNumbered",ExpressionUUID->"2163908e-9a17-4b3e-8a66-80835f2a01a1"]
}, Closed]],
Cell[CellGroupData[{
Cell[5057, 146, 321, 5, 55, "Subsection",ExpressionUUID->"c904312e-b770-481e-84bd-a64d0c9f7cdb"],
Cell[5381, 153, 640, 14, 121, "Text",ExpressionUUID->"e3038d8a-e661-4720-8822-dee33edcfb62"],
Cell[6024, 169, 668, 18, 52, "Text",ExpressionUUID->"bdf2e5b4-11f9-4e09-8da0-1c628c1d971b"],
Cell[6695, 189, 600, 16, 48, "Item",ExpressionUUID->"90b74020-1d74-4206-8694-cad55ad99b65"],
Cell[7298, 207, 633, 17, 48, "Item",ExpressionUUID->"ef716ba5-fa20-41ba-8dfc-7bf44ebc1e60"]
}, Closed]],
Cell[CellGroupData[{
Cell[7968, 229, 902, 13, 55, "Subsection",ExpressionUUID->"df32ca66-4a4c-40d8-b7c9-17a9d4cda6f3"],
Cell[8873, 244, 1009, 30, 87, "Text",ExpressionUUID->"e7431805-16b9-49c0-a30d-1c8df7dffbf0"],
Cell[9885, 276, 614, 18, 52, "Text",ExpressionUUID->"bfcf968c-dac0-4e7f-8a61-27d5c970ea88"],
Cell[10502, 296, 455, 14, 52, "Text",ExpressionUUID->"7f3f46a5-58eb-43a8-896e-0cb8b7d4bb56"],
Cell[10960, 312, 462, 11, 52, "Text",ExpressionUUID->"e20a2a99-8868-4810-8203-a217a7fc3aa1"]
}, Closed]],
Cell[CellGroupData[{
Cell[11459, 328, 909, 13, 55, "Subsection",ExpressionUUID->"f8306d6e-3ab0-4292-a643-77ea9de1bbcd"],
Cell[12371, 343, 925, 24, 87, "Text",ExpressionUUID->"b07a03a8-a520-44b9-ac67-3cd864f484f0"]
}, Closed]],
Cell[CellGroupData[{
Cell[13333, 372, 1051, 17, 95, "Subsection",ExpressionUUID->"8a8ab895-d54f-41d5-8b65-6993af5e690c"],
Cell[14387, 391, 1034, 27, 52, "Text",ExpressionUUID->"2817a0b5-4878-4a9e-8630-f9e3c46ac468"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15458, 423, 1188, 19, 121, "Subsection",ExpressionUUID->"0316f89c-512d-41b7-8ba4-a05e32b12b2f"],
Cell[16649, 444, 1202, 33, 87, "Text",ExpressionUUID->"e9ddbcf1-3f84-4bb9-be30-da3172cb2448"],
Cell[17854, 479, 382, 9, 52, "Text",ExpressionUUID->"0008d66e-88c5-4fb9-a7e6-6ae2a102c183"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18273, 493, 466, 8, 81, "Subsection",ExpressionUUID->"22304631-56b1-40de-a5d0-ae0ed813fd0f"],
Cell[18742, 503, 165, 3, 52, "Text",ExpressionUUID->"3043691a-ea61-45e6-8932-6d9b078d98c8"],
Cell[CellGroupData[{
Cell[18932, 510, 1830, 51, 186, "Input",ExpressionUUID->"8b15d1a2-c605-43b6-8a07-5ae880008a92"],
Cell[20765, 563, 607, 13, 52, "Output",ExpressionUUID->"0561e071-17c4-4b84-a5ba-43b23343d25c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21409, 581, 1398, 37, 128, "Input",ExpressionUUID->"2a556117-580e-4a04-ad62-faba7a96701b"],
Cell[22810, 620, 1602, 32, 146, "Output",ExpressionUUID->"4601bb1e-32e5-446e-8dd1-6ee0c3731bb9"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24473, 659, 501, 8, 100, "Section",ExpressionUUID->"ce9659f7-3bfa-4381-a91e-90259a94bf6e"],
Cell[CellGroupData[{
Cell[24999, 671, 341, 5, 81, "Subsection",ExpressionUUID->"d0073533-1d40-4c73-9118-317d5fc15ff3"],
Cell[25343, 678, 2137, 58, 225, "Text",ExpressionUUID->"adbed981-d5eb-49f7-9fa0-a419e404c85f",
 InitializationCell->True],
Cell[27483, 738, 381, 8, 87, "Text",ExpressionUUID->"04775b4d-7115-4be4-9436-6e1d67a65d60"],
Cell[CellGroupData[{
Cell[27889, 750, 1695, 50, 214, "Input",ExpressionUUID->"ca0e1d13-ffd8-445f-9f0a-8858f7ceec78"],
Cell[29587, 802, 420, 7, 52, "Output",ExpressionUUID->"66c9201e-a2a3-42c7-b0ab-a879379e67f4"],
Cell[30010, 811, 33713, 582, 351, "Output",ExpressionUUID->"13f2deb2-8b07-4aa9-ba87-f6076f3a4501"]
}, Open  ]],
Cell[63738, 1396, 363, 8, 87, "Text",ExpressionUUID->"5c8476dc-d035-442c-9e64-5910a7edeb8e"]
}, Closed]],
Cell[CellGroupData[{
Cell[64138, 1409, 414, 6, 55, "Subsection",ExpressionUUID->"0114461c-fab5-401e-871a-10ac000b8fc7"],
Cell[64555, 1417, 589, 16, 119, "Text",ExpressionUUID->"1f3e13c9-dabe-4d80-9b0f-4daba8cf26f9"],
Cell[65147, 1435, 677, 22, 98, "Text",ExpressionUUID->"b989e3c3-2c79-4db8-833e-606faee57c53",
 InitializationCell->True],
Cell[65827, 1459, 1383, 45, 189, "Text",ExpressionUUID->"8a51ba5c-d247-42cb-abfb-c468949934bb",
 InitializationCell->True],
Cell[67213, 1506, 1806, 56, 280, "Text",ExpressionUUID->"1ea6b155-73fa-4a55-a2f7-abddeb698a49",
 InitializationCell->True],
Cell[69022, 1564, 1842, 59, 268, "Text",ExpressionUUID->"95fda020-fba7-45a9-acfd-85ae01e1bbbf",
 InitializationCell->True],
Cell[70867, 1625, 459, 9, 117, "Text",ExpressionUUID->"c88cfaea-9220-4bb8-9d7b-b01cf72ffd60"]
}, Closed]],
Cell[CellGroupData[{
Cell[71363, 1639, 464, 7, 55, "Subsection",ExpressionUUID->"b0cc2b66-83e4-4376-a6aa-1b7eef6fb23c"],
Cell[71830, 1648, 329, 7, 85, "Text",ExpressionUUID->"ef7e80b9-6f61-41d2-95fc-8bf47b78f0c7"],
Cell[CellGroupData[{
Cell[72184, 1659, 3264, 96, 698, "Input",ExpressionUUID->"e1bc5b4b-667b-48c2-8014-2c2ba957d3c8"],
Cell[75451, 1757, 693, 13, 48, "Output",ExpressionUUID->"23062bf8-a8d3-4428-b18b-1687f5d44e1f"]
}, Open  ]],
Cell[76159, 1773, 171, 3, 50, "Text",ExpressionUUID->"56da7002-83d8-4198-9fc3-bf08ecb04dfe"],
Cell[CellGroupData[{
Cell[76355, 1780, 616, 12, 71, "Input",ExpressionUUID->"411f756e-13df-4db0-99bd-0f48ae5e72ed"],
Cell[76974, 1794, 958, 20, 48, "Output",ExpressionUUID->"600baee5-cf0c-4e28-81c3-6c351141627f"]
}, Open  ]],
Cell[77947, 1817, 389, 8, 50, "Text",ExpressionUUID->"d86c426e-16be-411b-be20-0e5565bb6bb2"]
}, Closed]],
Cell[CellGroupData[{
Cell[78373, 1830, 513, 8, 55, "Subsection",ExpressionUUID->"a6577eb3-7daa-4ab0-aece-92054417915c"],
Cell[78889, 1840, 274, 4, 51, "Text",ExpressionUUID->"c28b2bc3-3ce7-4e69-99c5-46a569202406"],
Cell[CellGroupData[{
Cell[79188, 1848, 4743, 121, 667, "Input",ExpressionUUID->"800666c3-dfd4-4d64-abe4-e1d9cc600fa0"],
Cell[83934, 1971, 608, 10, 52, "Output",ExpressionUUID->"aaa116e6-3b06-4fc1-ae0f-d865a6ef486d"],
Cell[84545, 1983, 4343, 79, 564, "Output",ExpressionUUID->"4687baa7-3578-4c30-8676-b2e6e804b087"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[88937, 2068, 565, 8, 55, "Subsection",ExpressionUUID->"8fca6c79-85dd-4694-b9ca-4e8b19db9b03"],
Cell[89505, 2078, 232, 4, 51, "Text",ExpressionUUID->"870d43ab-d39d-4188-b3ae-818f3e218f8d"],
Cell[89740, 2084, 3593, 86, 598, "Input",ExpressionUUID->"7ee6952d-6437-4e30-9544-0390d915566d",
 InitializationCell->True],
Cell[93336, 2172, 310, 5, 50, "Text",ExpressionUUID->"908f49ed-0649-4c65-84f8-7231dfea1105"],
Cell[CellGroupData[{
Cell[93671, 2181, 2338, 61, 243, "Input",ExpressionUUID->"06fc10c8-6265-48a7-a94a-c81dda26476a"],
Cell[96012, 2244, 307, 6, 48, "Output",ExpressionUUID->"51adb17b-03dc-45d0-aa8a-bd08c83ca9dd"],
Cell[96322, 2252, 304, 6, 48, "Output",ExpressionUUID->"9107f728-857d-4122-a34e-c4d81c0f8d33"],
Cell[96629, 2260, 305, 6, 48, "Output",ExpressionUUID->"11712611-23fc-4931-bb82-24395331b49d"],
Cell[96937, 2268, 340, 7, 52, "Output",ExpressionUUID->"da6ef9f8-e540-4374-b271-e124a9dc51df"],
Cell[97280, 2277, 251, 4, 48, "Output",ExpressionUUID->"0deb7e29-ef80-4bfd-9f61-5fff39ace033"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[97580, 2287, 669, 10, 55, "Subsection",ExpressionUUID->"76cec2be-7791-499b-a16a-25146eac08c4"],
Cell[98252, 2299, 646, 11, 152, "Text",ExpressionUUID->"74b639f6-380b-4af7-b486-79d63b035f89"],
Cell[98901, 2312, 381, 7, 118, "Text",ExpressionUUID->"14692e71-cd16-41ac-a897-0606ad96d47d"],
Cell[99285, 2321, 494, 10, 85, "Text",ExpressionUUID->"91e113dc-7c3b-4f09-8c3e-690b3d287ce3"],
Cell[CellGroupData[{
Cell[99804, 2335, 1434, 36, 140, "Input",ExpressionUUID->"df8bbb95-9715-454f-aadf-bca172e00f18"],
Cell[101241, 2373, 361, 6, 48, "Output",ExpressionUUID->"88c62381-7c1b-4699-a9e6-3546741fc959"],
Cell[101605, 2381, 361, 6, 65, "Output",ExpressionUUID->"152f5d26-0416-4eef-84a7-f41e6551cedc"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[102015, 2393, 689, 10, 55, "Subsection",ExpressionUUID->"38d79272-1c73-4c04-a4ea-5d4bf98e09ba"],
Cell[102707, 2405, 378, 8, 52, "Text",ExpressionUUID->"c83f9386-24d8-45c2-b3d5-3351a7af5b30"],
Cell[103088, 2415, 263, 6, 87, "Text",ExpressionUUID->"41c034f7-d1f8-409f-8527-a1d635d00699"],
Cell[103354, 2423, 455, 8, 87, "Text",ExpressionUUID->"e260bb19-13ae-4d40-a9bc-c8f856c0b2cc"],
Cell[103812, 2433, 396, 8, 87, "Text",ExpressionUUID->"7e6434a9-c424-48ad-89cc-dc8a4c27178d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104245, 2446, 614, 9, 81, "Subsection",ExpressionUUID->"97b689af-798b-4fa4-812f-3178db238fc7"],
Cell[104862, 2457, 227, 4, 52, "Text",ExpressionUUID->"b0e757b4-3b30-4a68-884c-382bc891e716"],
Cell[105092, 2463, 3735, 88, 552, "Input",ExpressionUUID->"89cd7a86-dde4-4298-9a67-5fa9634b9867",
 InitializationCell->True],
Cell[108830, 2553, 237, 4, 52, "Text",ExpressionUUID->"b3a762f7-da54-4d29-971f-2aa7fda3959b"],
Cell[109070, 2559, 3750, 84, 381, "Input",ExpressionUUID->"b1d6ceb3-01c6-4978-abba-e696d3740791",
 InitializationCell->True],
Cell[112823, 2645, 343, 5, 52, "Text",ExpressionUUID->"66eb4571-a05f-4b88-b580-69df004570f7"],
Cell[CellGroupData[{
Cell[113191, 2654, 2675, 65, 271, "Input",ExpressionUUID->"312b82ce-fd75-4028-b143-0f86cc9e3918"],
Cell[115869, 2721, 1388, 39, 124, "Output",ExpressionUUID->"f91a278b-6bab-414a-926e-3979df6d9447"]
}, Open  ]],
Cell[117272, 2763, 162, 3, 52, "Text",ExpressionUUID->"0ac8a84d-4c77-4456-8d6d-a67c44b92bb8"],
Cell[CellGroupData[{
Cell[117459, 2770, 1110, 30, 100, "Input",ExpressionUUID->"c02faaf0-51a2-4224-bc1c-f9fe44c95ae8"],
Cell[118572, 2802, 506, 9, 52, "Output",ExpressionUUID->"597b6d39-eb3a-4c0d-b089-ec78b0e98247"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[119127, 2817, 743, 10, 81, "Subsection",ExpressionUUID->"ae003b2b-c819-48ea-a09f-c814529daf69"],
Cell[119873, 2829, 917, 15, 156, "Text",ExpressionUUID->"e6fdff34-0f62-463e-82f5-7e81a6d404b6"],
Cell[120793, 2846, 296, 7, 52, "Text",ExpressionUUID->"b1d73711-fb3b-4305-b645-27bf10e92a02"],
Cell[CellGroupData[{
Cell[121114, 2857, 228, 4, 67, "Subsubsection",ExpressionUUID->"1d884874-4ed9-474c-9ebc-b3ddd1db5d3b"],
Cell[121345, 2863, 359, 7, 87, "Text",ExpressionUUID->"5aad33d4-520e-417f-bdc3-01754289fd08"],
Cell[CellGroupData[{
Cell[121729, 2874, 4053, 108, 357, "Input",ExpressionUUID->"95924ea1-6de5-42ee-be64-ece45bed4e4c"],
Cell[125785, 2984, 2070, 50, 152, "Output",ExpressionUUID->"998936aa-f99a-498c-b890-b5b28c6a3c12"]
}, Open  ]],
Cell[127870, 3037, 568, 14, 87, "Text",ExpressionUUID->"2e1f4dab-1e03-45d3-bdc8-9cbf4b3eb668"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128487, 3057, 763, 11, 81, "Subsection",ExpressionUUID->"f4609e26-d615-451c-b151-0e5f442a6b13"],
Cell[129253, 3070, 2928, 90, 190, "Text",ExpressionUUID->"34b0a18e-986b-4cbd-8acd-3db773ef752e"],
Cell[132184, 3162, 4678, 139, 570, "Text",ExpressionUUID->"c7ca9a0c-2184-4154-993d-1ad86e4a20a4"],
Cell[CellGroupData[{
Cell[136887, 3305, 1946, 48, 271, "Input",ExpressionUUID->"a3327748-2e8a-451f-af3b-6ce7a6b4e070"],
Cell[138836, 3355, 647, 8, 48, "Output",ExpressionUUID->"df9132db-376d-4f57-bf02-6db599a83cc7"],
Cell[139486, 3365, 816, 13, 48, "Output",ExpressionUUID->"b69b6844-51a6-4c1f-b25f-12afad7a91cd"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[140363, 3385, 562, 8, 100, "Section",ExpressionUUID->"d74c6881-be7d-4792-bd37-6a586fef0485"],
Cell[CellGroupData[{
Cell[140950, 3397, 427, 9, 121, "Subsection",ExpressionUUID->"b7acec07-0a09-4a83-80a7-89636d0b0313"],
Cell[141380, 3408, 1749, 48, 190, "Text",ExpressionUUID->"02cc558b-0d68-4ea7-ac19-ac5fccf288e1"],
Cell[143132, 3458, 1405, 35, 210, "Input",ExpressionUUID->"8aed62a9-14a6-4cee-8493-5bef2ab3aeaf",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[144562, 3497, 1191, 28, 157, "Input",ExpressionUUID->"ded16b89-239b-45d2-9e7e-559579845caf"],
Cell[145756, 3527, 619, 8, 48, "Output",ExpressionUUID->"81d5ea21-51ad-402b-b56e-d17d888fdf59"],
Cell[146378, 3537, 901, 14, 48, "Output",ExpressionUUID->"96a2b429-6d4e-44ba-bdaa-0144aa080cc0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[147328, 3557, 428, 9, 121, "Subsection",ExpressionUUID->"f903db84-4b9d-4620-a1ff-9eee48f96d57"],
Cell[147759, 3568, 771, 13, 87, "Text",ExpressionUUID->"ba4ec5ca-f217-4401-a93d-c8ebcb64c4c6"],
Cell[148533, 3583, 785, 18, 124, "Input",ExpressionUUID->"7a6700b5-b206-4e8e-9154-420f2015fbbb",
 InitializationCell->True],
Cell[149321, 3603, 157, 3, 52, "Text",ExpressionUUID->"d950ca1b-0cb7-472c-9535-9c5adfe20f29"],
Cell[CellGroupData[{
Cell[149503, 3610, 1582, 34, 271, "Input",ExpressionUUID->"cb519017-f697-4c4a-a508-ae16aaad098e"],
Cell[151088, 3646, 258, 5, 48, "Output",ExpressionUUID->"e1fc4895-e4e6-4a48-93be-c9d3ffce8bc8"],
Cell[151349, 3653, 256, 5, 48, "Output",ExpressionUUID->"fa125682-004d-4f64-95b5-b6a7713e841a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151654, 3664, 623, 12, 121, "Subsection",ExpressionUUID->"4b283f6b-3554-41ca-a3b8-f015b0f92b63"],
Cell[152280, 3678, 991, 16, 87, "Text",ExpressionUUID->"61957444-2cad-436f-aadb-98b7e1cd9c0c"],
Cell[CellGroupData[{
Cell[153296, 3698, 5427, 154, 442, "Input",ExpressionUUID->"a2724d64-3e94-4a01-98ac-0dfb1a66766b"],
Cell[158726, 3854, 5141, 113, 351, "Output",ExpressionUUID->"5ea007f6-bb8a-49f8-b04a-0cf824f79586"]
}, Open  ]],
Cell[163882, 3970, 215, 5, 52, "Text",ExpressionUUID->"8243787c-c484-449a-adea-a86829017a50"],
Cell[CellGroupData[{
Cell[164122, 3979, 789, 18, 71, "Input",ExpressionUUID->"3b2210e6-67f4-4bf3-8d71-6a62d6996567"],
Cell[164914, 3999, 1295, 34, 77, "Output",ExpressionUUID->"e9e43f54-a113-42ca-8fee-5d8da6960dc4"]
}, Open  ]],
Cell[166224, 4036, 250, 4, 52, "Text",ExpressionUUID->"f34d525f-10f2-40fc-b72d-16e9e4e335ef"],
Cell[166477, 4042, 330, 5, 48, "Item",ExpressionUUID->"1929dd45-84fb-4b19-94e7-fadf0a1d7f53"],
Cell[166810, 4049, 562, 14, 48, "Item",ExpressionUUID->"fb2847f4-c189-4d8e-b8f1-4a17a327380c"],
Cell[167375, 4065, 393, 7, 79, "Item",ExpressionUUID->"34a0fed1-cc77-4301-81b2-791ca052705d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167805, 4077, 623, 12, 121, "Subsection",ExpressionUUID->"3e6ef0af-a043-4ec2-9dd3-294bc3701927"],
Cell[168431, 4091, 963, 15, 87, "Text",ExpressionUUID->"fd0318c3-ad7d-4ee2-81c8-afcdf79ebe56"],
Cell[CellGroupData[{
Cell[169419, 4110, 3142, 83, 328, "Input",ExpressionUUID->"9b2e8605-4e42-4c20-b1c7-2a52c3c34a33"],
Cell[172564, 4195, 2105, 52, 181, "Output",ExpressionUUID->"ce5a40ed-5781-461b-a4f0-16342ff42567"],
Cell[174672, 4249, 2918, 62, 673, "Output",ExpressionUUID->"3bf636a1-1243-453a-bc1a-cacfeb038e99"]
}, Open  ]],
Cell[177605, 4314, 448, 9, 48, "Item",ExpressionUUID->"1302b0b5-a93b-4eb7-b260-58325f92c484"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178090, 4328, 638, 12, 121, "Subsection",ExpressionUUID->"894b92ea-3669-4b3c-81ec-6ad261e419a8"],
Cell[178731, 4342, 1015, 16, 87, "Text",ExpressionUUID->"2e8dadb7-1253-4cb2-9b5e-477f71931c68"],
Cell[CellGroupData[{
Cell[179771, 4362, 3197, 86, 300, "Input",ExpressionUUID->"6ce91ab3-5568-4497-88f1-353271e81d55"],
Cell[182971, 4450, 6861, 140, 735, "Output",ExpressionUUID->"b44a012a-d205-4c25-875d-6fedc5f813ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189869, 4595, 262, 6, 79, "Item",ExpressionUUID->"268a94b1-a05e-4ab6-9c18-bad6e38ee2a8"],
Cell[190134, 4603, 407, 8, 67, "Subitem",ExpressionUUID->"d703270a-e679-49ac-86c6-60cda86a26b8"]
}, Open  ]],
Cell[190556, 4614, 301, 7, 48, "Item",ExpressionUUID->"1c58fa42-4b97-476a-aa44-9e8cb8f2f8b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190894, 4626, 679, 13, 121, "Subsection",ExpressionUUID->"ce453186-fb2a-4a81-ac9f-13721d217fd1"],
Cell[191576, 4641, 1057, 16, 87, "Text",ExpressionUUID->"8843b395-b110-4d0b-a289-793a4c4a47bf"],
Cell[192636, 4659, 667, 11, 190, "Text",ExpressionUUID->"a7ab2941-48d9-4e39-94bd-cfcfed4cd73a"],
Cell[193306, 4672, 2948, 77, 438, "Input",ExpressionUUID->"0180d11a-6739-4bc7-9069-c8804345f24e",
 InitializationCell->True],
Cell[196257, 4751, 308, 6, 52, "Text",ExpressionUUID->"62ef8c72-26b9-4229-9830-1c82700eca91"],
Cell[CellGroupData[{
Cell[196590, 4761, 1639, 38, 128, "Input",ExpressionUUID->"d78f4f99-54cb-4b11-950a-336fad172243"],
Cell[198232, 4801, 905, 22, 77, "Output",ExpressionUUID->"5d35ee92-9081-4073-9be8-fb3808a23c9e"]
}, Open  ]],
Cell[199152, 4826, 301, 7, 48, "Item",ExpressionUUID->"5dac283c-38c9-4226-ad77-363c121e95e0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[199502, 4839, 183, 3, 100, "Section",ExpressionUUID->"b0cb362d-2ca7-4c2d-a252-bbb690d4fcc4"],
Cell[CellGroupData[{
Cell[199710, 4846, 862, 16, 121, "Subsection",ExpressionUUID->"666ca539-312f-4d21-8b6e-6d7e36e0ef75"],
Cell[200575, 4864, 892, 23, 87, "Text",ExpressionUUID->"296346b7-63b8-4efe-b1f1-ecb9dcfe759e"],
Cell[201470, 4889, 1102, 32, 79, "Item",ExpressionUUID->"7cedb3d0-40ec-4ca4-a90a-6f7445d70b87"],
Cell[CellGroupData[{
Cell[202597, 4925, 1413, 42, 79, "Item",ExpressionUUID->"b3564f53-268d-4b77-9e37-54500ce260b5"],
Cell[204013, 4969, 1488, 44, 62, "Subitem",ExpressionUUID->"b20cb555-b42f-431f-9b62-f0dd57cfd154"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205538, 5018, 1468, 43, 79, "Item",ExpressionUUID->"53aa9822-4707-4c1c-a80f-7a72a8e68c15"],
Cell[207009, 5063, 2288, 67, 121, "Subitem",ExpressionUUID->"30fa95d3-bb99-42d8-a2b8-a74d6636a919"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209334, 5135, 1155, 31, 71, "Item",ExpressionUUID->"a8d9f65e-651b-4428-b43f-63e2904b9560"],
Cell[210492, 5168, 1333, 37, 62, "Subitem",ExpressionUUID->"216087c5-f7c2-4814-ab74-b33bd921ee28"],
Cell[211828, 5207, 1250, 32, 62, "Subitem",ExpressionUUID->"36bd8c73-c653-4add-a004-2d20d03c84fe"],
Cell[213081, 5241, 1423, 33, 39, "Subitem",ExpressionUUID->"eb164d3e-7ddf-4760-a347-2627a8ac14ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214541, 5279, 598, 8, 48, "Item",ExpressionUUID->"0fadd674-1c15-4122-85e7-126d35651527"],
Cell[215142, 5289, 1409, 34, 40, "Subitem",ExpressionUUID->"07312013-09f6-4de0-a1e5-c25de07f8882"],
Cell[216554, 5325, 1419, 31, 40, "Subitem",ExpressionUUID->"5bf311e1-295c-4744-ab2f-d46eb201be94"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[218022, 5362, 724, 13, 121, "Subsection",ExpressionUUID->"370c8ed7-8ec2-4150-a873-3974a32bcd8d"],
Cell[218749, 5377, 1107, 17, 87, "Text",ExpressionUUID->"f25cb99a-71d2-4146-95d8-f10f5c178924"],
Cell[219859, 5396, 4144, 101, 581, "Input",ExpressionUUID->"4a910f2b-72c3-489c-adbf-85963a08255a",
 InitializationCell->True],
Cell[224006, 5499, 302, 5, 52, "Text",ExpressionUUID->"24955d86-0f27-47b2-9319-dff202390229"],
Cell[CellGroupData[{
Cell[224333, 5508, 2988, 76, 186, "Input",ExpressionUUID->"58d846b2-9d18-41fc-843d-86003b114249"],
Cell[227324, 5586, 610, 12, 52, "Output",ExpressionUUID->"4a3771eb-4b82-4e55-80e8-9e9f948112e7"],
Cell[227937, 5600, 574, 11, 52, "Output",ExpressionUUID->"2814bb67-8b1f-496a-ad85-c72b45fe9c8b"]
}, Open  ]],
Cell[228526, 5614, 436, 9, 48, "Item",ExpressionUUID->"2a1206b6-bcf5-408b-8a9d-7d482785ee5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228999, 5628, 910, 16, 121, "Subsection",ExpressionUUID->"041c091f-5d41-4ce8-9f98-a63b636f913e"],
Cell[229912, 5646, 892, 23, 87, "Text",ExpressionUUID->"966d80e7-1232-4256-ba8a-80b2f8e8e857"],
Cell[CellGroupData[{
Cell[230829, 5673, 1188, 33, 71, "Item",ExpressionUUID->"ab9382e2-78d7-47fb-875d-0d83862e431d"],
Cell[232020, 5708, 752, 18, 39, "Subitem",ExpressionUUID->"b183f334-4006-4b40-9fee-dc3e45b8335a"],
Cell[232775, 5728, 1041, 27, 62, "Subitem",ExpressionUUID->"dab590de-3e44-4aac-b5d1-c77da37eed5d"]
}, Open  ]],
Cell[233831, 5758, 1059, 25, 48, "Item",ExpressionUUID->"72fca0e6-ceb5-4d90-aacb-20f538aeff60"],
Cell[234893, 5785, 170, 3, 52, "Text",ExpressionUUID->"2ca9b1c4-7f85-443f-8e39-3d16b2b1a141"],
Cell[CellGroupData[{
Cell[235088, 5792, 847, 18, 48, "Item",ExpressionUUID->"5cc437c9-9798-4536-a43b-b4cced1678ea"],
Cell[235938, 5812, 1064, 26, 39, "Subitem",ExpressionUUID->"ef8d1056-0bd5-45bf-a22e-a6003887575d"],
Cell[237005, 5840, 1584, 41, 64, "Subitem",ExpressionUUID->"99b5d72e-7890-4622-b251-079f14f324e3"]
}, Open  ]],
Cell[238604, 5884, 1127, 25, 79, "Item",ExpressionUUID->"0a6f3897-cdca-42db-9639-50348e77d4a6"],
Cell[239734, 5911, 721, 12, 48, "Item",ExpressionUUID->"1a844fa9-4383-4fe6-9f03-1c09b85bdf58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[240492, 5928, 924, 16, 121, "Subsection",ExpressionUUID->"cf152260-9201-4ded-b25e-73f99118999a"],
Cell[241419, 5946, 485, 9, 52, "Text",ExpressionUUID->"2449f0b9-66cd-4ed3-81fc-126f813c0941"],
Cell[241907, 5957, 2596, 62, 352, "Input",ExpressionUUID->"0a4403a0-db07-4572-b8fb-cdb7ab2db1b6",
 InitializationCell->True],
Cell[244506, 6021, 282, 4, 52, "Text",ExpressionUUID->"14e67011-4020-43a9-8f14-fe5ce3a11c55"],
Cell[CellGroupData[{
Cell[244813, 6029, 1754, 52, 214, "Input",ExpressionUUID->"def187d4-411b-404f-b594-410bb58383be"],
Cell[246570, 6083, 463, 9, 52, "Output",ExpressionUUID->"2952c0e1-6437-4ae4-9f21-e2940de26314"]
}, Open  ]],
Cell[247048, 6095, 164, 3, 52, "Text",ExpressionUUID->"14fe33d5-5839-46f1-82b2-ccebb8351b34"],
Cell[CellGroupData[{
Cell[247237, 6102, 1209, 39, 128, "Input",ExpressionUUID->"73075bd1-7c27-4a74-9dc5-15b34ceb1875"],
Cell[248449, 6143, 291, 4, 48, "Output",ExpressionUUID->"5aefcb62-c103-4729-ad78-0126b743e64e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[248801, 6154, 177, 3, 100, "Section",ExpressionUUID->"51a318e2-eec3-4c48-bd37-9db3eb0ed816"],
Cell[248981, 6159, 1108, 29, 121, "Text",ExpressionUUID->"4be4d83e-990f-4cc6-b10d-5a088ccacfdf"],
Cell[250092, 6190, 346, 7, 48, "Item",ExpressionUUID->"0ae38005-8fbb-4615-bb11-64ecc6658249"],
Cell[CellGroupData[{
Cell[250463, 6201, 1441, 40, 105, "Item",ExpressionUUID->"8607cb25-e1f8-454f-832d-f8a57775379d"],
Cell[CellGroupData[{
Cell[251929, 6245, 760, 20, 39, "Subitem",ExpressionUUID->"a73f660e-c6a1-4c1a-ac77-f5d38756ecb3"],
Cell[252692, 6267, 2868, 80, 298, "Input",ExpressionUUID->"789f0454-097b-421c-9017-ed0f391f7ea0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

