(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     69093,       1805]
NotebookOptionsPosition[     64676,       1727]
NotebookOutlinePosition[     65306,       1748]
CellTagsIndexPosition[     65263,       1745]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Differentiating Matrix Decompositions", "Title",
 CellChangeTimes->{{3.905433199790596*^9, 
  3.9054332141796827`*^9}},ExpressionUUID->"86c65eeb-29ba-463c-83b4-\
272a963ce65b"],

Cell[TextData[{
 "A matrix decomposition splits a matrix ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d4dfddb9-cf3f-4100-a87f-9011b6597455"],
 " up into a useful product of structured matrices.  For example:"
}], "Text",
 CellChangeTimes->{{3.905433219670884*^9, 
  3.9054332747558823`*^9}},ExpressionUUID->"b87d2f4c-f7c3-4db1-bbfb-\
5111d818b4d9"],

Cell[CellGroupData[{

Cell[TextData[{
 "Singular Value Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"U", ".", "\[CapitalSigma]", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0310c896-d85c-412c-9625-8beca44ec78b"],
 "  where ",
 Cell[BoxData[
  FormBox["\[CapitalSigma]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b1af86d7-c7f2-4e0b-9cbb-1b0f254a7f9e"],
 " is diagonal with ordered non-negative entries and U and V are orthogonal;"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.905433338745592*^9}, {
  3.905433376004936*^9, 3.9054333970562706`*^9}, {3.905433514910533*^9, 
  3.9054335152541137`*^9}},ExpressionUUID->"96699503-2cca-46e7-a7c0-\
5d7bd531fd08"],

Cell[TextData[{
 "Spectral Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"X", ".", "\[CapitalLambda]", ".", 
     SuperscriptBox["X", 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "143a2f7e-a559-484d-83ae-d1569cc1b74b"],
 " where ",
 Cell[BoxData[
  FormBox["\[CapitalLambda]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ea38f02f-984c-46bd-8ee8-540bfa6763cc"],
 " is diagonal;"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.9054334039688005`*^9}, 
   3.9054335114219656`*^9},ExpressionUUID->"cc8a789a-fbac-427b-88b1-\
5ed8862f5b39"],

Cell[TextData[{
 "Symmetric (",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"A", "\[Transpose]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c37f9489-704a-4eb2-add2-922c9385c7df"],
 ") Spectral Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "\[CapitalLambda]", ".", 
     RowBox[{"Q", "\[Transpose]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "01c22a7c-ce3f-4eb7-9dcf-6e0930205ba2"],
 "  where ",
 Cell[BoxData[
  FormBox["\[CapitalLambda]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "405d395b-82a8-48e7-9316-f7fc2c48f075"],
 " is diagonal and ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9787d3a4-ac19-44b6-a7a9-f033f98f235b"],
 " is orthogonal;"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.9054334522660074`*^9}, {
  3.905433492699395*^9, 
  3.905433520321575*^9}},ExpressionUUID->"4f8b7be6-28b2-40ba-858d-\
cb4dc4245c76"],

Cell[TextData[{
 "Schur Decomposition (",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"A", "\[Transpose]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a706e658-d336-4b9b-89de-f1d94e642e77"],
 ") Spectral Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "T", ".", 
     RowBox[{"Q", "\[Transpose]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "eaf43a87-026e-445c-8a13-a3942a819f24"],
 "  where ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9e4b3f90-12ef-4747-a157-04787add05ee"],
 " is pseudo-upper triangular and ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "118e9562-9d91-4c6a-b557-8815a30eb965"],
 " is orthogonal;"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.9054334522660074`*^9}, {
  3.905433492699395*^9, 
  3.9054336089748745`*^9}},ExpressionUUID->"1d4e2b03-2d8f-408e-b098-\
c376ea0d06dd"],

Cell[TextData[{
 "Hessenberg Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "H", ".", 
     RowBox[{"Q", "\[Transpose]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "febc5ba7-d55d-4768-a6fc-5c3233eb2d9a"],
 " where H is upper Hessenberg and ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3c61fa7a-9cc5-4a4c-b7d0-64679b443d05"],
 " is orthogonal. (Direct)"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.9054335262799797`*^9}, {
  3.9054336451644373`*^9, 
  3.9054336488568068`*^9}},ExpressionUUID->"0aa1085a-e87a-4994-b0b5-\
cdd6c24645be"],

Cell[TextData[{
 "Symmetric (",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"A", "\[Transpose]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d2c311bf-8b56-4818-93da-b291ee45c3f7"],
 ") Hessenberg Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "T", ".", 
     RowBox[{"Q", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "17904a26-ae35-4203-bc7e-3c11a8b9c28c"],
 " where T is tridiagonal and ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "6df0e383-cbcd-4e1d-82e4-4405d7313e4a"],
 " is orthogonal. (Direct)"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.90543350735485*^9}, {
  3.9054336198903613`*^9, 
  3.9054336531889086`*^9}},ExpressionUUID->"bccaba1d-39a6-4a70-b2a5-\
7ed2454c8402"]
}, Open  ]],

Cell[TextData[{
 "These decompositions can be differentiated and some of the results are \
useful!  By differentiated I mean that you can compute derivatives of the \
products from the decomposition and the derivative of the data matrix ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "305887ce-4957-47a5-b717-dadf196a90dc"],
 ".  We are going to look at the SVD first. Our second target is the Schur \
decomposition. "
}], "Text",
 CellChangeTimes->{{3.9054336655770793`*^9, 
  3.9054338281014633`*^9}},ExpressionUUID->"3a7ee43f-52c0-42f9-ab19-\
8eee81665033"],

Cell[CellGroupData[{

Cell["Differentiating the SVD", "Subtitle",
 CellChangeTimes->{{3.9053221474326577`*^9, 3.905322158600971*^9}, {
  3.9053224857862453`*^9, 3.9053224874298773`*^9}, {3.9053225367131104`*^9, 
  3.905322546675497*^9}, {3.905327915897973*^9, 
  3.9053279170331354`*^9}},ExpressionUUID->"d1b3f2fd-79fa-467b-b3e6-\
b3d347009a21"],

Cell[TextData[{
 "The SVD expresses an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "87a51961-7c10-4278-be7f-b13cf0f0f687"],
 " matrix as the product\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"U", ".", "\[CapitalSigma]", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "06bc512c-14dc-4272-ad16-dead542b1d3a"],
 "\nwhere ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "9dbc144c-ffd8-4c06-8478-2caa947b4061"],
 " and ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "6f6a687e-141e-4b16-ab25-64c6a2cae003"],
 " are orthogonal and ",
 Cell[BoxData[
  FormBox["\[CapitalSigma]", TraditionalForm]],ExpressionUUID->
  "8d221f24-ff69-4443-8a09-4a83b2fdab6e"],
 " is diagonal. For simplicity lets assume the matrix is square and full rank \
then the product rule gives\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "'"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"U", "'"}], ".", "\[CapitalSigma]", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", 
      RowBox[{"\[CapitalSigma]", "'"}], ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", "\[CapitalSigma]", ".", 
      RowBox[{
       RowBox[{"V", "\[Transpose]"}], "'"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"e4ba35c9-36dd-4e83-a15d-2d855a92d576"],
 "\nSince  U and V are orthogonal ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", ".", 
     RowBox[{"U", "\[Transpose]"}]}], "=", 
    RowBox[{
     RowBox[{"V", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"d02975e4-412d-4d81-a751-36a12a3d1c15"],
 ". Differentiating the first of these gives\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"U", "\[Transpose]"}], ")"}], "'"}]}], "+", 
     RowBox[{
      RowBox[{"U", "'"}], ".", 
      RowBox[{"U", "\[Transpose]"}]}]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"1e7b4385-0704-4fd7-b6d9-4362295b0f74"],
 "\nwhich means that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", "'"}], ".", 
     RowBox[{"U", "\[Transpose]"}]}], "=", 
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"U", "'"}], ".", 
        RowBox[{"U", "\[Transpose]"}]}], ")"}], "\[Transpose]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"4c97c59f-6618-4646-94eb-7791f6338d77"],
 ".  In other words, \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    RowBox[{
     RowBox[{"U", "'"}], ".", 
     RowBox[{"U", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "96e7bbc3-a8ac-43b6-bac0-6b68fc2770af"],
 " \nis a skew matrix. Similarly we have that \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"Y", "=", 
    RowBox[{
     RowBox[{"V", "'"}], ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "909d5416-0050-44d1-8316-76ce6f91280c"],
 "\nis a skew matrix.  "
}], "Text",
 CellChangeTimes->{{3.9053279202689257`*^9, 
  3.905328411180498*^9}},ExpressionUUID->"85ae8e2b-4b4c-4128-abb1-\
f2a120290be6"],

Cell[TextData[{
 "Our goal is to compute the diagonal matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalSigma]", "'"}], TraditionalForm]],ExpressionUUID->
  "9495427e-4189-462d-9345-561d183d90e9"],
 " and the skew matrices ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "f63b0674-3da7-4290-82d9-e052bd085024"],
 " and Y from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "'"}], TraditionalForm]],ExpressionUUID->
  "a70899f0-cafb-43e7-93ca-1a5577f5e9ab"],
 " the diagonal matrix ",
 Cell[BoxData[
  FormBox["\[CapitalSigma]", TraditionalForm]],ExpressionUUID->
  "895c9d52-5c1c-4985-b9d3-80efce5f708b"],
 " and the orthogonal matrices ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "1ed9fa96-ccfb-492b-a225-cb9b87759aaa"],
 " and V.  Multiply the product rule expression by U\[Transpose] and V\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"A", "'"}], ".", "V"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"U", "\[Transpose]"}], ".", 
      RowBox[{"U", "'"}], ".", "\[CapitalSigma]", ".", 
      RowBox[{"V", "\[Transpose]"}], ".", "V"}], "+", 
     RowBox[{
      RowBox[{"U", "\[Transpose]"}], ".", "U", ".", 
      RowBox[{"\[CapitalSigma]", "'"}], ".", 
      RowBox[{"V", "\[Transpose]"}], ".", "V"}], "+", 
     RowBox[{
      RowBox[{"U", "\[Transpose]"}], ".", "U", ".", "\[CapitalSigma]", ".", 
      RowBox[{
       RowBox[{"V", "\[Transpose]"}], "'"}], ".", "V"}]}]}], 
   TraditionalForm]],ExpressionUUID->"69b93074-014c-44af-a1ab-c5ee52e294d0"],
 "\northogonality means this is  \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"A", "'"}], ".", "V"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"U", "\[Transpose]"}], ".", 
      RowBox[{"U", "'"}], ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", "'"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", 
      RowBox[{
       RowBox[{"V", "\[Transpose]"}], "'"}], ".", "V"}]}]}], 
   TraditionalForm]],ExpressionUUID->"6540d137-dd51-496e-a9cb-75737a4cf9dd"],
 "\nthe definition of X and Y means this is   \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", "'"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", "Y"}]}], "=", 
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"A", "'"}], ".", "V"}]}], TraditionalForm]],ExpressionUUID->
  "68cea9a5-75af-4f1d-b63d-97c4098a5b60"],
 "\nThe diagonal entries of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", ".", "\[CapitalSigma]"}], TraditionalForm]],ExpressionUUID->
  "796ed89b-ccd7-4672-8e25-d02e6da616b3"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalSigma]", ".", "Y"}], TraditionalForm]],ExpressionUUID->
  "54d5dcfa-691f-4c4b-8302-4c946491d53b"],
 " are zero so the diagonal of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalSigma]", "'"}], TraditionalForm]],ExpressionUUID->
  "2e2e55a1-458d-4a5c-a531-f639ffc39634"],
 " matches the diagonal of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", "\[Transpose]"}], ".", 
    RowBox[{"A", "'"}], ".", "V"}], TraditionalForm]],ExpressionUUID->
  "c4a4f5d9-2d07-4c86-acb5-482633726cee"],
 ".  I am going to write this as\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Sigma]", "'"}], "=", 
    RowBox[{"diagonal", "(", 
     RowBox[{
      RowBox[{"U", "\[Transpose]"}], ".", 
      RowBox[{"A", "'"}], ".", "V"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"c18950f5-825e-4e60-8f4e-6d9985e32b63"],
 "\nLets check this part of the computation. "
}], "Text",
 CellChangeTimes->{{3.905328428742011*^9, 3.9053287258237715`*^9}, {
  3.9053289108107214`*^9, 3.905328914687092*^9}, {3.905328962432089*^9, 
  3.905329094464033*^9}, {3.905329144354046*^9, 3.905329407869517*^9}, {
  3.9053296844332123`*^9, 3.905329701088558*^9}, {3.90533006272886*^9, 
  3.9053303199913855`*^9}, {3.9053304449325323`*^9, 3.905330462161231*^9}, {
  3.905330495486883*^9, 3.9053306514969244`*^9}, {3.9053308780268893`*^9, 
  3.9053309017132616`*^9}, {3.9053309399793634`*^9, 3.905330984494705*^9}, {
  3.9053311298078327`*^9, 3.9053311300889025`*^9}, {3.905433857192814*^9, 
  3.9054342626110373`*^9}, {3.905497965381214*^9, 3.905498029272128*^9}, {
  3.905498179289077*^9, 3.905498250935405*^9}, {3.905498282574486*^9, 
  3.9054982846041307`*^9}, {3.905498602250944*^9, 
  3.9054986226173553`*^9}},ExpressionUUID->"3fd55326-63c9-4aa4-97cd-\
0897ba20e0d9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";", " ", 
  RowBox[{"\[Epsilon]", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"dA", "=", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dS", "=", 
   RowBox[{"Diagonal", "[", 
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Diagonal", "[", "S", "]"}], ",", 
   RowBox[{
    RowBox[{"Diagonal", "[", "S", "]"}], "+", "dS"}], ",", 
   RowBox[{"SingularValueList", "[", 
    RowBox[{"A", "+", "dA"}], "]"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diagonal", "[", "S", "]"}], "+", "dS", "-", 
  RowBox[{"SingularValueList", "[", 
   RowBox[{"A", "+", "dA"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.90549831743038*^9, 3.9054983340270967`*^9}, {
  3.9054983640466995`*^9, 3.9054985815184803`*^9}, {3.905501892452447*^9, 
  3.905501895501112*^9}, {3.9055027916070995`*^9, 3.905502901338725*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"06004f4c-08d9-4bac-a1b6-16009ef5a594"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.6282755231903407`", ",", "1.5091416623145038`", ",", 
     "1.1324709878513801`", ",", "0.5509708656499284`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.6289844462708531`", ",", "1.5087353898222335`", ",", 
     "1.1290980852484211`", ",", "0.5521400236174981`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.6291570249057323`", ",", "1.5087787925481537`", ",", 
     "1.128941724841673`", ",", "0.5521289693514961`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.905501896307446*^9, {3.905502777478121*^9, 3.9055028108038125`*^9}, {
   3.9055028521700096`*^9, 3.9055029052425694`*^9}},
 CellLabel->
  "Out[366]=",ExpressionUUID->"f7b3465d-c94e-4f2a-a28b-7a62096d8244"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.00017257863487918357`"}], ",", 
   RowBox[{"-", "0.000043402725920183016`"}], ",", "0.0001563604067480462`", 
   ",", "0.00001105426600200854`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.905501896307446*^9, {3.905502777478121*^9, 3.9055028108038125`*^9}, {
   3.9055028521700096`*^9, 3.9055029052425694`*^9}},
 CellLabel->
  "Out[367]=",ExpressionUUID->"415b59ac-f2ca-4f27-9a60-829786cae883"]
}, Open  ]],

Cell[TextData[{
 "If we can compute the skew matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    RowBox[{
     RowBox[{"U", "'"}], 
     RowBox[{"U", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "2245a980-0a68-4ec4-8c3c-6814bf466fa0"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Y", "=", 
    RowBox[{
     RowBox[{"V", "'"}], 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "582c9cdb-6497-4106-b1a7-456850e258f8"],
 " we will be able to compute the derivatives ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "'"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e2188b70-a527-4766-9ec0-6256d6afad39"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "'"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "058980cf-13c0-4f12-b191-4f137e5c6db6"],
 ". Our algebraic equation is \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", "Y"}]}], "=", 
    RowBox[{"B", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"U", "\[Transpose]"}], ".", 
       RowBox[{"A", "'"}], ".", "V"}], "-", 
      RowBox[{"\[CapitalSigma]", "'"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"b3de1a6b-c082-466f-ad37-71409a72269b"],
 "\nNote that neither ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", ".", "\[CapitalSigma]"}], TraditionalForm]],ExpressionUUID->
  "d6c36dcc-4366-43b0-889a-da9607be2581"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalSigma]", ".", "Y"}], TraditionalForm]],ExpressionUUID->
  "950a7d93-0b34-4fc8-a210-7d3427d020c0"],
 " are skew! and the RHS matrix ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dc81dd48-0119-4981-afb0-6882cfaac57a"],
 " has zeros on the diagonal. I can transpose to get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalSigma]", "\[Transpose]"}], ".", 
      RowBox[{"X", "\[Transpose]"}]}], "+", 
     RowBox[{
      RowBox[{"Y", "\[Transpose]"}], ".", 
      RowBox[{"\[CapitalSigma]", "\[Transpose]"}]}]}], "=", 
    RowBox[{"B", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "231707b3-3b3a-4502-bbb6-b36a6d4ec38c"],
 "  or equivalently ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[CapitalSigma]", ".", "X"}]}], "-", 
     RowBox[{"Y", ".", "\[CapitalSigma]"}]}], "=", 
    RowBox[{"B", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "309f7871-5c60-48b6-a3f5-fad1fbe8e593"],
 "\nsince ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "a22e1f5f-c669-4234-9ab2-8137c50c8287"],
 " and ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "6a77579d-03bc-4eb0-9627-8d305114100c"],
 " are skew and ",
 Cell[BoxData[
  FormBox["\[CapitalSigma]", TraditionalForm]],ExpressionUUID->
  "69daa830-a278-448f-9b1d-2218ac83e0e2"],
 " is diagonal.  Subtracting I get \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalSigma]", ".", 
      RowBox[{"(", 
       RowBox[{"X", "+", "Y"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"X", "+", "Y"}], ")"}], ".", "\[CapitalSigma]"}]}], "=", 
    RowBox[{"B", "-", 
     RowBox[{"B", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "8bdaa6a2-9639-43b3-a8ca-9774534286d7"],
 "\nwhich is a standard diagonal Sylvester/Lyapunov equation. Mathematica, \
matlab and Julia all have solvers for these linear matrix equations."
}], "Text",
 CellChangeTimes->{{3.905328428742011*^9, 3.9053287258237715`*^9}, {
  3.9053289108107214`*^9, 3.905328914687092*^9}, {3.905328962432089*^9, 
  3.905329094464033*^9}, {3.905329144354046*^9, 3.905329407869517*^9}, {
  3.9053296844332123`*^9, 3.905329701088558*^9}, {3.90533006272886*^9, 
  3.9053303199913855`*^9}, {3.9053304449325323`*^9, 3.905330462161231*^9}, {
  3.905330495486883*^9, 3.9053306514969244`*^9}, {3.9053308780268893`*^9, 
  3.9053309017132616`*^9}, {3.9053309399793634`*^9, 3.905330984494705*^9}, {
  3.9053311298078327`*^9, 3.9053311300889025`*^9}, {3.905433857192814*^9, 
  3.9054342626110373`*^9}, {3.905497965381214*^9, 3.905498029272128*^9}, {
  3.905498179289077*^9, 3.905498250935405*^9}, {3.905498282574486*^9, 
  3.9054982846041307`*^9}, {3.9054986271423135`*^9, 3.9054989564575567`*^9}, {
  3.905499698912465*^9, 
  3.9054996995603685`*^9}},ExpressionUUID->"ff34e681-bde9-437b-bbf2-\
3ea9ef610d13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "LyapunovSolve"}]], "Input",
 CellChangeTimes->{{3.9054982559096403`*^9, 3.9054982602437305`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"797c8f30-0644-4353-8b85-95b95e66f56c"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/LyapunovSolve",
              ButtonNote->"paclet:ref/LyapunovSolve"],
             "\"paclet:ref/LyapunovSolve\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"LyapunovSolve\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"c\\\", \
\\\"TI\\\"]}], \\\"]\\\"}]\\) finds a solution \\!\\(\\*StyleBox[\\\"x\\\", \
\\\"TI\\\"]\\) of the matrix Lyapunov equation \
\\!\\(\\*RowBox[{RowBox[{RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\".\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"]}], \\\"+\\\", RowBox[{StyleBox[\\\"x\\\", \
\\\"TI\\\"], \\\".\\\", RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\"\
\[ConjugateTranspose]\\\"}]}]}], \\\"\[LongEqual]\\\", StyleBox[\\\"c\\\", \\\
\"TI\\\"]}]\\).\\n\\!\\(\\*RowBox[{\\\"LyapunovSolve\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"b\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"c\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) \
solves \\!\\(\\*RowBox[{RowBox[{RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \
\\\".\\\", StyleBox[\\\"x\\\", \\\"TI\\\"]}], \\\"+\\\", \
RowBox[{StyleBox[\\\"x\\\", \\\"TI\\\"], \\\".\\\", StyleBox[\\\"b\\\", \
\\\"TI\\\"]}]}], \\\"\[LongEqual]\\\", StyleBox[\\\"c\\\", \
\\\"TI\\\"]}]\\).\\n\\!\\(\\*RowBox[{\\\"LyapunovSolve\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \
\\\",\\\", StyleBox[\\\"d\\\", \\\"TI\\\"]}], \\\"}\\\"}], \\\",\\\", \
StyleBox[\\\"c\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) solves \
\\!\\(\\*RowBox[{RowBox[{RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\".\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"], \\\".\\\", RowBox[{StyleBox[\\\"d\\\", \
\\\"TI\\\"], \\\"\[ConjugateTranspose]\\\"}]}], \\\"+\\\", \
RowBox[{StyleBox[\\\"d\\\", \\\"TI\\\"], \\\".\\\", StyleBox[\\\"x\\\", \
\\\"TI\\\"], \\\".\\\", RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\"\
\[ConjugateTranspose]\\\"}]}]}], \\\"\[LongEqual]\\\", StyleBox[\\\"c\\\", \\\
\"TI\\\"]}]\\).\\n\\!\\(\\*RowBox[{\\\"LyapunovSolve\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \
\\\",\\\", StyleBox[\\\"d\\\", \\\"TI\\\"]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"b\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"e\\\", \\\"TI\\\"]}], \\\"}\\\"}], \\\",\\\", \
StyleBox[\\\"c\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) solves \
\\!\\(\\*RowBox[{RowBox[{RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\".\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"], \\\".\\\", StyleBox[\\\"e\\\", \
\\\"TI\\\"]}], \\\"+\\\", RowBox[{StyleBox[\\\"d\\\", \\\"TI\\\"], \\\".\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"], \\\".\\\", StyleBox[\\\"b\\\", \
\\\"TI\\\"]}]}], \\\"\[LongEqual]\\\", StyleBox[\\\"c\\\", \
\\\"TI\\\"]}]\\).\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", "paclet:ref/LyapunovSolve",
                     "paclet:ref/LyapunovSolve", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"], "\"  \"", 
                    StyleBox[
                    "\"|\"", "InformationRowLabel", StripOnInput -> False], 
                    "\"  \"", 
                    TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL[
                    "http://reference.wolfram.com/language/ref/LyapunovSolve.\
html"], None}, "http://reference.wolfram.com/language/ref/LyapunovSolve.html",
                     "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", "Protected", "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`LyapunovSolve\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{16.25, {5., 11.25}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{16.25, {5., 11.25}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/LyapunovSolve",
              ButtonNote->"paclet:ref/LyapunovSolve"],
             "\"paclet:ref/LyapunovSolve\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"LyapunovSolve\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"c\\\", \
\\\"TI\\\"]}], \\\"]\\\"}]\\) finds a solution \\!\\(\\*StyleBox[\\\"x\\\", \
\\\"TI\\\"]\\) of the matrix Lyapunov equation \
\\!\\(\\*RowBox[{RowBox[{RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\".\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"]}], \\\"+\\\", RowBox[{StyleBox[\\\"x\\\", \
\\\"TI\\\"], \\\".\\\", RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\"\
\[ConjugateTranspose]\\\"}]}]}], \\\"\[LongEqual]\\\", StyleBox[\\\"c\\\", \\\
\"TI\\\"]}]\\).\\n\\!\\(\\*RowBox[{\\\"LyapunovSolve\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"b\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"c\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) \
solves \\!\\(\\*RowBox[{RowBox[{RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \
\\\".\\\", StyleBox[\\\"x\\\", \\\"TI\\\"]}], \\\"+\\\", \
RowBox[{StyleBox[\\\"x\\\", \\\"TI\\\"], \\\".\\\", StyleBox[\\\"b\\\", \
\\\"TI\\\"]}]}], \\\"\[LongEqual]\\\", StyleBox[\\\"c\\\", \
\\\"TI\\\"]}]\\).\\n\\!\\(\\*RowBox[{\\\"LyapunovSolve\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \
\\\",\\\", StyleBox[\\\"d\\\", \\\"TI\\\"]}], \\\"}\\\"}], \\\",\\\", \
StyleBox[\\\"c\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) solves \
\\!\\(\\*RowBox[{RowBox[{RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\".\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"], \\\".\\\", RowBox[{StyleBox[\\\"d\\\", \
\\\"TI\\\"], \\\"\[ConjugateTranspose]\\\"}]}], \\\"+\\\", \
RowBox[{StyleBox[\\\"d\\\", \\\"TI\\\"], \\\".\\\", StyleBox[\\\"x\\\", \
\\\"TI\\\"], \\\".\\\", RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\"\
\[ConjugateTranspose]\\\"}]}]}], \\\"\[LongEqual]\\\", StyleBox[\\\"c\\\", \\\
\"TI\\\"]}]\\).\\n\\!\\(\\*RowBox[{\\\"LyapunovSolve\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \
\\\",\\\", StyleBox[\\\"d\\\", \\\"TI\\\"]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"b\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"e\\\", \\\"TI\\\"]}], \\\"}\\\"}], \\\",\\\", \
StyleBox[\\\"c\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) solves \
\\!\\(\\*RowBox[{RowBox[{RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \\\".\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"], \\\".\\\", StyleBox[\\\"e\\\", \
\\\"TI\\\"]}], \\\"+\\\", RowBox[{StyleBox[\\\"d\\\", \\\"TI\\\"], \\\".\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"], \\\".\\\", StyleBox[\\\"b\\\", \
\\\"TI\\\"]}]}], \\\"\[LongEqual]\\\", StyleBox[\\\"c\\\", \
\\\"TI\\\"]}]\\).\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{12.5, {4., 8.5}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{12.5, {4., 8.5}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"LyapunovSolve\", \"[\", RowBox[{StyleBox[\"a\", \"TI\"], \
\",\", StyleBox[\"c\", \"TI\"]}], \"]\"}]\) finds a solution \
\!\(\*StyleBox[\"x\", \"TI\"]\) of the matrix Lyapunov equation \
\!\(\*RowBox[{RowBox[{RowBox[{StyleBox[\"a\", \"TI\"], \".\", StyleBox[\"x\", \
\"TI\"]}], \"+\", RowBox[{StyleBox[\"x\", \"TI\"], \".\", \
RowBox[{StyleBox[\"a\", \"TI\"], \"\[ConjugateTranspose]\"}]}]}], \"\
\[LongEqual]\", StyleBox[\"c\", \"TI\"]}]\).\n\
\!\(\*RowBox[{\"LyapunovSolve\", \"[\", RowBox[{StyleBox[\"a\", \"TI\"], \
\",\", StyleBox[\"b\", \"TI\"], \",\", StyleBox[\"c\", \"TI\"]}], \"]\"}]\) \
solves \!\(\*RowBox[{RowBox[{RowBox[{StyleBox[\"a\", \"TI\"], \".\", \
StyleBox[\"x\", \"TI\"]}], \"+\", RowBox[{StyleBox[\"x\", \"TI\"], \".\", \
StyleBox[\"b\", \"TI\"]}]}], \"\[LongEqual]\", StyleBox[\"c\", \"TI\"]}]\).\n\
\!\(\*RowBox[{\"LyapunovSolve\", \"[\", RowBox[{RowBox[{\"{\", \
RowBox[{StyleBox[\"a\", \"TI\"], \",\", StyleBox[\"d\", \"TI\"]}], \"}\"}], \
\",\", StyleBox[\"c\", \"TI\"]}], \"]\"}]\) solves \
\!\(\*RowBox[{RowBox[{RowBox[{StyleBox[\"a\", \"TI\"], \".\", StyleBox[\"x\", \
\"TI\"], \".\", RowBox[{StyleBox[\"d\", \"TI\"], \
\"\[ConjugateTranspose]\"}]}], \"+\", RowBox[{StyleBox[\"d\", \"TI\"], \".\", \
StyleBox[\"x\", \"TI\"], \".\", RowBox[{StyleBox[\"a\", \"TI\"], \"\
\[ConjugateTranspose]\"}]}]}], \"\[LongEqual]\", StyleBox[\"c\", \"TI\"]}]\).\
\n\!\(\*RowBox[{\"LyapunovSolve\", \"[\", RowBox[{RowBox[{\"{\", \
RowBox[{StyleBox[\"a\", \"TI\"], \",\", StyleBox[\"d\", \"TI\"]}], \"}\"}], \
\",\", RowBox[{\"{\", RowBox[{StyleBox[\"b\", \"TI\"], \",\", StyleBox[\"e\", \
\"TI\"]}], \"}\"}], \",\", StyleBox[\"c\", \"TI\"]}], \"]\"}]\) solves \
\!\(\*RowBox[{RowBox[{RowBox[{StyleBox[\"a\", \"TI\"], \".\", StyleBox[\"x\", \
\"TI\"], \".\", StyleBox[\"e\", \"TI\"]}], \"+\", RowBox[{StyleBox[\"d\", \
\"TI\"], \".\", StyleBox[\"x\", \"TI\"], \".\", StyleBox[\"b\", \"TI\"]}]}], \
\"\[LongEqual]\", StyleBox[\"c\", \"TI\"]}]\).", "Documentation" -> 
    Association[
     "Local" -> "paclet:ref/LyapunovSolve", "Web" -> 
      "http://reference.wolfram.com/language/ref/LyapunovSolve.html"], 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> None, 
    "SubValues" -> None, "DefaultValues" -> None, "NValues" -> None, 
    "FormatValues" -> None, "Options" -> None, "Attributes" -> {Protected}, 
    "FullName" -> "System`LyapunovSolve"], False]]], "Output",
 CellChangeTimes->{3.905498261241481*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"88e3cf0c-ac07-49fd-9f44-d90f6911f2a3"]
}, Open  ]],

Cell["Here is what we have so far!", "Text",
 CellChangeTimes->{{3.9054990774217863`*^9, 
  3.905499087472336*^9}},ExpressionUUID->"0f32985a-557f-434e-8eeb-\
583d76f351f2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";", " ", 
  RowBox[{"\[Epsilon]", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"dA", "=", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dS", "=", 
   RowBox[{"Diagonal", "[", 
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}], "-", 
    RowBox[{"DiagonalMatrix", "[", "dS", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"XPlusY", "=", 
    RowBox[{"LyapunovSolve", "[", 
     RowBox[{"S", ",", "S", ",", 
      RowBox[{"B", "-", 
       RowBox[{"B", "\[Transpose]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "XPlusY", "]"}]}], "Input",
 CellChangeTimes->{{3.90549831743038*^9, 3.9054983340270967`*^9}, {
  3.9054983640466995`*^9, 3.9054985815184803`*^9}, {3.9054989721897035`*^9, 
  3.9054990620965204`*^9}, {3.905499122834623*^9, 3.9054991271726594`*^9}, {
  3.9054995152969885`*^9, 3.9054995221149616`*^9}, {3.905499743257885*^9, 
  3.9054997434966717`*^9}, {3.9055018859034653`*^9, 3.905501904543595*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"2776fb72-1fa6-412e-bc81-f363a3aac150"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.0010703983806392512`", 
      RowBox[{"-", "0.001686585755221318`"}], 
      RowBox[{"-", "0.0016657042317473436`"}]},
     {
      RowBox[{"-", "0.0010703983806392512`"}], "0.`", 
      "0.0033303454348926113`", "0.007860914335128111`"},
     {"0.001686585755221318`", 
      RowBox[{"-", "0.0033303454348926113`"}], "0.`", 
      RowBox[{"-", "0.0039035317991009274`"}]},
     {"0.0016657042317473436`", 
      RowBox[{"-", "0.007860914335128111`"}], "0.0039035317991009274`", "0.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9054983969363604`*^9, 3.9054984813063602`*^9}, {
   3.90549852030669*^9, 3.905498582225958*^9}, {3.9054989897710133`*^9, 
   3.9054990084188457`*^9}, 3.9054990627159805`*^9, 3.905499127764537*^9, 
   3.9054995226126328`*^9, 3.9054997444097204`*^9, 3.905501222424286*^9, {
   3.9055018885747623`*^9, 3.9055019050430884`*^9}, 3.9055027693202243`*^9, 
   3.90550400377684*^9},
 CellLabel->
  "Out[133]//MatrixForm=",ExpressionUUID->"b8ac74dd-3dc1-455e-85ce-\
53725493e0ec"]
}, Open  ]],

Cell[TextData[{
 "Of course, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", "=", 
    RowBox[{"X", "+", "Y"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "24586efc-c208-424a-8815-af6c82b4a5fd"],
 " comes out skew and substituting ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Y", "=", 
    RowBox[{"Z", "-", "X"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f39d7ec4-fa27-4041-8c86-7541a414f91e"],
 " in\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", "Y"}]}], "=", "B"}], TraditionalForm]],
  ExpressionUUID->"6b6f7d18-c271-4b51-957f-0dc41e594f28"],
 "\neliminates ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c578272f-d31e-4d7b-8c58-81ebad0d1770"],
 " to give \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "-", 
     RowBox[{"\[CapitalSigma]", ".", "X"}]}], "=", 
    RowBox[{"B", "-", 
     RowBox[{"\[CapitalSigma]", ".", "Z", " "}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5c4ca3c5-4f95-426a-9bde-9f95351103df"],
 "\nThis is a non standard Sylvester/Lyapunov equation.  The matrices on both \
sides are constructed or maybe constrained to be skew! For a general non-skew \
right hand side the equations are inconsistent.  However, we know how to \
write down the solution as a the Hadamard product\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    RowBox[{"K", "\[SmallCircle]", 
     RowBox[{"(", 
      RowBox[{"B", "-", 
       RowBox[{"\[CapitalSigma]", ".", "Z"}]}], ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "005ee13f-3d92-43cb-81fe-454459e3663a"],
 " \nwhere\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["K", 
     RowBox[{"i", ",", "j"}]], "=", 
    RowBox[{"(", GridBox[{
       {"0", "if", 
        RowBox[{"i", "=", "j"}]},
       {
        FractionBox["1", 
         RowBox[{
          RowBox[{"s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{
          "s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]], 
        "if", 
        RowBox[{"i", "\[NotEqual]", "j"}]}
      }]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e59dcc28-79ea-478f-a88a-027993c1447e"]
}], "Text",
 CellChangeTimes->{{3.905499131167159*^9, 3.9054992208381186`*^9}, {
  3.905499288685218*^9, 3.9054994659983654`*^9}, {3.9054995302953863`*^9, 
  3.905499649078125*^9}, {3.9054997706869965`*^9, 3.905499817143963*^9}, {
  3.90550000101987*^9, 3.9055000098388844`*^9}, {3.9055004074808893`*^9, 
  3.9055004711685705`*^9}, {3.9055007659238267`*^9, 3.9055008869973927`*^9}, {
  3.905500946492446*^9, 
  3.9055010726338596`*^9}},ExpressionUUID->"43be927d-0a81-4fec-b24e-\
73b67bca5f4d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"K", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "==", "j"}], ",", "0", ",", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"S", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"S", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}]]}], "]"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"K", "*", 
    RowBox[{"(", 
     RowBox[{"B", "-", 
      RowBox[{"S", ".", "Z"}]}], ")"}]}]}], ";", " ", 
  RowBox[{"Y", "=", 
   RowBox[{"Z", "-", "X"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"X", ".", "S"}], "-", 
      RowBox[{"S", ".", "X"}], "-", 
      RowBox[{"(", 
       RowBox[{"B", "-", 
        RowBox[{"S", ".", "Z"}]}], ")"}]}], ",", " ", 
     RowBox[{
      RowBox[{"X", ".", "S"}], "+", 
      RowBox[{"S", ".", "Y"}], "-", "B"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9054997494448576`*^9, 3.905499762767275*^9}, {
  3.9055010834649167`*^9, 3.9055012707376385`*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"b07867e7-6e9a-40aa-8b3a-9b0903fb8cec"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.905499753215444*^9, 3.905499763342888*^9}, {
   3.905501140231848*^9, 3.9055011649928303`*^9}, {3.905501200467473*^9, 
   3.9055012096704144`*^9}, {3.905501245063285*^9, 3.9055012717501016`*^9}, 
   3.905503999913995*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"0fdb0fd6-e4c0-4291-92e5-66c8d7fb5998"]
}, Open  ]],

Cell["\<\
The summary is that if I put all of this together I can \
\[OpenCurlyDoubleQuote]differentiate\[CloseCurlyDoubleQuote] the SVD.  This \
is a good time to ask \[OpenCurlyDoubleQuote]what can go wrong\
\[CloseCurlyDoubleQuote].  After that it is time to hide all this stuff in a \
function.   \
\>", "Text",
 CellChangeTimes->{{3.905501402145002*^9, 3.9055015107061925`*^9}, {
  3.905501825689125*^9, 
  3.905501843448932*^9}},ExpressionUUID->"fd8dac07-e575-4d16-bbec-\
4481124a8c59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SVDDiff", "[", 
   RowBox[{"A_", ",", "dA_", ",", 
    RowBox[{"{", 
     RowBox[{"U_", ",", "S_", ",", "V_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ds", ",", "B", ",", "Z", ",", "K", ",", "m", ",", "n", ",", "dX", ",", 
      "dY"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ds", "=", 
      RowBox[{"Diagonal", "[", 
       RowBox[{
        RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}], "-", 
       RowBox[{"DiagonalMatrix", "[", "ds", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Z", "=", 
      RowBox[{"LyapunovSolve", "[", 
       RowBox[{"S", ",", "S", ",", 
        RowBox[{"B", "-", 
         RowBox[{"B", "\[Transpose]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "==", "j"}], ",", "0", ",", 
          FractionBox["1", 
           RowBox[{
            RowBox[{"S", "\[LeftDoubleBracket]", 
             RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], "-", 
            RowBox[{"S", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}]]}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "m"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "m"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dX", "=", 
      RowBox[{"K", "*", 
       RowBox[{"(", 
        RowBox[{"B", "-", 
         RowBox[{"S", ".", "Z"}]}], ")"}]}]}], ";", " ", 
     RowBox[{"dY", "=", 
      RowBox[{"Z", "-", "dX"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ds", ",", "dX", ",", "dY"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9055016429634285`*^9, 3.9055018118803988`*^9}, {
   3.905501952859421*^9, 3.905501953999781*^9}, {3.9055025177945557`*^9, 
   3.9055025276500454`*^9}, 3.905502986415764*^9, {3.905503073753259*^9, 
   3.9055030770395665`*^9}, 3.9055032471922054`*^9, {3.9055034344282627`*^9, 
   3.9055034573882446`*^9}, {3.905503827677577*^9, 3.905503830553288*^9}, {
   3.905503871398664*^9, 3.9055038741756167`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"3f0c0628-addc-4b17-9ba6-861368189ef4"],

Cell[TextData[{
 "We need to test the function and the construction. I am going to check that \
I satisfy the starting point\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", "'"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", "Y"}]}], "=", 
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"A", "'"}], ".", "V"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "79381ee6-0788-4a7e-a011-4d8c93b5d5cf"],
 "\nof the computation. "
}], "Text",
 CellChangeTimes->{{3.905501850643645*^9, 3.905501875716764*^9}, {
  3.9055041685495706`*^9, 3.905504169019535*^9}, {3.9055042607019453`*^9, 
  3.9055042927809963`*^9}},ExpressionUUID->"04fe972f-77a3-4a86-8f2c-\
129a599a58d9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";", " ", 
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{"1.0", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";", " ", 
  RowBox[{"Id", "=", 
   RowBox[{"IdentityMatrix", "[", "m", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"dA", "=", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "A", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ds", ",", "dX", ",", "dY"}], "}"}], "=", 
   RowBox[{"SVDDiff", "[", 
    RowBox[{"A", ",", "dA", ",", 
     RowBox[{"{", 
      RowBox[{"U", ",", "S", ",", "V"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"dX", ".", "S"}], "+", 
   RowBox[{"DiagonalMatrix", "[", "ds", "]"}], "+", 
   RowBox[{"S", ".", "dY"}], " ", "-", 
   RowBox[{
    RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9055019249204874`*^9, 3.9055019720034113`*^9}, {
   3.90550212409496*^9, 3.905502329737319*^9}, 3.9055024002608852`*^9, {
   3.9055025923716145`*^9, 3.905502651734087*^9}, {3.9055026954669075`*^9, 
   3.905502709836979*^9}, {3.905503001709306*^9, 3.9055030540369616`*^9}, {
   3.905503095463205*^9, 3.905503105557713*^9}, {3.9055032703579903`*^9, 
   3.905503272507556*^9}, 3.905503400043177*^9, {3.905503466318981*^9, 
   3.905503512659134*^9}, {3.9055035693814993`*^9, 3.9055036082350616`*^9}, 
   3.905503648517209*^9, {3.905503842612595*^9, 3.905503853012473*^9}, {
   3.905503899480948*^9, 3.905503899731269*^9}, {3.905504183925736*^9, 
   3.9055042120194287`*^9}},ExpressionUUID->"683fe593-221c-4e1d-9e47-\
3af850e74a7f"],

Cell[BoxData["4.574125510396802`*^-22"], "Output",
 CellChangeTimes->{{3.905504203228846*^9, 3.905504209359743*^9}},
 CellLabel->
  "Out[152]=",ExpressionUUID->"a2d3db48-625a-4c87-95da-db740aead352"]
}, Open  ]],

Cell[TextData[{
 "This is not actually a check that we are computing the derivative correctly \
it is a check that we are implementing the plan correctly.  How should we \
check if the plan is right?  Well one way is to go backwards to the \
\[OpenCurlyDoubleQuote]product rule\[CloseCurlyDoubleQuote] from\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", "'"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", "Y"}]}], "=", 
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"A", "'"}], ".", "V"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "323ed07c-0c9d-4fbc-81e6-191128bb48be"],
 "\nSo\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", ".", "X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"U", ".", 
      RowBox[{"\[CapitalSigma]", "'"}]}], "+", 
     RowBox[{"U", ".", "\[CapitalSigma]", ".", "Y"}]}], "=", 
    RowBox[{
     RowBox[{"A", "'"}], ".", "V"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "99d22329-71b6-4396-af16-9f64431161c5"],
 "\nand \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", ".", "X", ".", "\[CapitalSigma]", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", 
      RowBox[{"\[CapitalSigma]", "'"}], ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", "\[CapitalSigma]", ".", "Y", ".", 
      RowBox[{"V", "\[Transpose]"}]}]}], "=", 
    RowBox[{"A", "'"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "91cbd77d-7046-47c9-ad74-f9f24090137f"],
 "\nwhich we can check."
}], "Text",
 CellChangeTimes->{{3.9055046918386154`*^9, 3.905504985871771*^9}, {
  3.9055050512182713`*^9, 
  3.9055050516397333`*^9}},ExpressionUUID->"45c79ef9-9ff1-43ab-a96a-\
d13bc9aa9524"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";", " ", 
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{"1.0", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";", " ", 
  RowBox[{"Id", "=", 
   RowBox[{"IdentityMatrix", "[", "m", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"dA", "=", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "A", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ds", ",", "dX", ",", "dY"}], "}"}], "=", 
   RowBox[{"SVDDiff", "[", 
    RowBox[{"A", ",", "dA", ",", 
     RowBox[{"{", 
      RowBox[{"U", ",", "S", ",", "V"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"U", ".", "dX", ".", "S", ".", 
    RowBox[{"V", "\[Transpose]"}]}], "+", 
   RowBox[{"U", ".", 
    RowBox[{"DiagonalMatrix", "[", "ds", "]"}], ".", 
    RowBox[{"V", "\[Transpose]"}]}], "+", 
   RowBox[{"U", ".", "S", ".", "dY", ".", 
    RowBox[{"V", "\[Transpose]"}]}], " ", "-", "dA"}], "]"}]}], "Input",
 CellChangeTimes->{{3.905504997903039*^9, 3.905505041719451*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"6c057e08-c192-4725-9833-2c5a135c3edd"],

Cell[BoxData["7.634865225812724`*^-22"], "Output",
 CellChangeTimes->{3.9055050426054707`*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"4a4fc942-93c5-4b72-94e0-7db6898d0b34"]
}, Open  ]],

Cell[TextData[{
 "We can rearrange this a bit. I changed some names and stuff.   \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", ".", "dX", ".", "S", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", 
      RowBox[{"(", 
       RowBox[{"S", "+", "dS"}], ")"}], ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", "S", ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"V", ".", 
         RowBox[{"dY", "\[Transpose]"}]}], ")"}], "\[Transpose]"}]}]}], "=", 
    RowBox[{"A", "+", "dA"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c26c9939-bb13-4098-9dc7-5c748d645ca0"],
 "\nRemember"
}], "Text",
 CellChangeTimes->{{3.9055051149780283`*^9, 3.9055053118386445`*^9}, {
  3.9055053427159863`*^9, 
  3.9055053616651525`*^9}},ExpressionUUID->"89627152-414e-47a8-b504-\
0cf86de35134"],

Cell[CellGroupData[{

Cell["Differentiating a Schur Decomposition", "Section",
 CellChangeTimes->{{3.9053221474326577`*^9, 3.905322158600971*^9}, {
  3.9053224857862453`*^9, 3.9053224874298773`*^9}, {3.9053225367131104`*^9, 
  3.905322546675497*^9}},ExpressionUUID->"865fee83-a0b9-4dde-a83c-\
64243de3e753"],

Cell[TextData[{
 "The target is to modify the SVD \[OpenCurlyDoubleQuote]differentiation\
\[CloseCurlyDoubleQuote] argument to the Schur Decomposition. \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "T", ".", 
     RowBox[{"Q", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "50579448-3a07-4748-b6f9-ea06e03eaa89"],
 " or equivalently ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "=", 
    RowBox[{
     RowBox[{"Q", "\[Transpose]"}], ".", "A", ".", "Q"}]}], TraditionalForm]],
  ExpressionUUID->"0adbf43e-701e-4819-8bf1-adb881c249f0"],
 "\nwhere ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "9b60a9c9-e321-4a2b-9475-8560979ff3eb"],
 " is orthogonal (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"Q", ".", 
      RowBox[{"Q", "\[Transpose]"}]}], "=", "I"}], ")"}], TraditionalForm]],
  ExpressionUUID->"7a38c5c1-d840-4706-bd58-e52d6a5b5af5"],
 " and T is upper triangular. Differentiating gives\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "'"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Q", "'"}], ".", "T", ".", 
      RowBox[{"Q", "\[Transpose]"}]}], "+", 
     RowBox[{"Q", ".", 
      RowBox[{"T", "'"}], ".", 
      RowBox[{"Q", "\[Transpose]"}]}], "+", 
     RowBox[{"Q", ".", "T", ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Q", "\[Transpose]"}], ")"}], "'"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"4debd638-2bf1-426e-997f-9cdb332035a8"],
 " \nand \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Q", "'"}], ".", 
      RowBox[{"Q", "\[Transpose]"}]}], "+", 
     RowBox[{"Q", ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Q", "\[Transpose]"}], ")"}], "'"}]}]}], "=", "0"}], 
   TraditionalForm]],ExpressionUUID->"5820f059-f12f-4ac0-b07e-b8f66076f209"]
}], "Text",
 CellChangeTimes->{{3.905501524721031*^9, 
  3.9055015961606646`*^9}},ExpressionUUID->"1dfca3d4-ad9d-45c3-8820-\
258f243850c0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q", ",", "T"}], "}"}], "=", 
   RowBox[{"SchurDecomposition", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "-", 
      RowBox[{"Q", ".", "T", ".", 
       RowBox[{"Q", "\[Transpose]"}]}]}], ",", 
     RowBox[{"Q", ".", 
      RowBox[{"Q", "\[Transpose]"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9053227151044006`*^9, 3.9053227504694405`*^9}, {
  3.9053227886811876`*^9, 3.9053228068568225`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"ef7ff574-777d-43b5-90e8-cfdd671ac8ac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.975275151738181`*^-15", ",", "1.0000000000000002`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9053227435277367`*^9, 3.905322750960987*^9}, 
   3.9053228073413477`*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"28a3cbe4-5eca-49e3-822e-6cf1135506fd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1273.5, 773.5},
WindowMargins->{{1972.5, Automatic}, {179, Automatic}},
TaggingRules->Association[
 "PresenterSettings" -> Association["Dialogs" -> {}], "TryRealOnly" -> False],
Magnification->1.25,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"0dc06b2e-8473-4a68-b9a3-039bb38cedb7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 182, 3, 153, "Title",ExpressionUUID->"86c65eeb-29ba-463c-83b4-272a963ce65b"],
Cell[765, 27, 405, 10, 41, "Text",ExpressionUUID->"b87d2f4c-f7c3-4db1-bbfb-5111d818b4d9"],
Cell[CellGroupData[{
Cell[1195, 41, 774, 19, 39, "Item",ExpressionUUID->"96699503-2cca-46e7-a7c0-5d7bd531fd08"],
Cell[1972, 62, 653, 19, 39, "Item",ExpressionUUID->"cc8a789a-fbac-427b-88b1-5ed8862f5b39"],
Cell[2628, 83, 1036, 31, 39, "Item",ExpressionUUID->"4f8b7be6-28b2-40ba-858d-cb4dc4245c76"],
Cell[3667, 116, 1033, 31, 39, "Item",ExpressionUUID->"1d4e2b03-2d8f-408e-b098-c376ea0d06dd"],
Cell[4703, 149, 673, 19, 39, "Item",ExpressionUUID->"0aa1085a-e87a-4994-b0b5-cdd6c24645be"],
Cell[5379, 170, 815, 24, 39, "Item",ExpressionUUID->"bccaba1d-39a6-4a70-b2a5-7ed2454c8402"]
}, Open  ]],
Cell[6209, 197, 614, 13, 97, "Text",ExpressionUUID->"3a7ee43f-52c0-42f9-ab19-8eee81665033"],
Cell[CellGroupData[{
Cell[6848, 214, 323, 5, 98, "Subtitle",ExpressionUUID->"d1b3f2fd-79fa-467b-b3e6-b3d347009a21"],
Cell[7174, 221, 3204, 99, 319, "Text",ExpressionUUID->"85ae8e2b-4b4c-4128-abb1-f2a120290be6"],
Cell[10381, 322, 4536, 118, 291, "Text",ExpressionUUID->"3fd55326-63c9-4aa4-97cd-0897ba20e0d9"],
Cell[CellGroupData[{
Cell[14942, 444, 1730, 50, 155, "Input",ExpressionUUID->"06004f4c-08d9-4bac-a1b6-16009ef5a594"],
Cell[16675, 496, 771, 20, 40, "Output",ExpressionUUID->"f7b3465d-c94e-4f2a-a28b-7a62096d8244"],
Cell[17449, 518, 453, 10, 40, "Output",ExpressionUUID->"415b59ac-f2ca-4f27-9a60-829786cae883"]
}, Open  ]],
Cell[17917, 531, 4490, 123, 208, "Text",ExpressionUUID->"ff34e681-bde9-437b-bbf2-3ea9ef610d13"],
Cell[CellGroupData[{
Cell[22432, 658, 204, 3, 35, "Input",ExpressionUUID->"797c8f30-0644-4353-8b85-95b95e66f56c"],
Cell[22639, 663, 18668, 385, 220, "Output",ExpressionUUID->"88e3cf0c-ac07-49fd-9f44-d90f6911f2a3"]
}, Open  ]],
Cell[41322, 1051, 172, 3, 41, "Text",ExpressionUUID->"0f32985a-557f-434e-8eeb-583d76f351f2"],
Cell[CellGroupData[{
Cell[41519, 1058, 1984, 57, 178, "Input",ExpressionUUID->"2776fb72-1fa6-412e-bc81-f363a3aac150"],
Cell[43506, 1117, 1444, 33, 117, "Output",ExpressionUUID->"b8ac74dd-3dc1-455e-85ce-53725493e0ec"]
}, Open  ]],
Cell[44965, 1153, 2907, 81, 295, "Text",ExpressionUUID->"43be927d-0a81-4fec-b24e-73b67bca5f4d"],
Cell[CellGroupData[{
Cell[47897, 1238, 1495, 43, 181, "Input",ExpressionUUID->"b07867e7-6e9a-40aa-8b3a-9b0903fb8cec"],
Cell[49395, 1283, 362, 6, 40, "Output",ExpressionUUID->"0fdb0fd6-e4c0-4291-92e5-66c8d7fb5998"]
}, Open  ]],
Cell[49772, 1292, 492, 10, 69, "Text",ExpressionUUID->"fd8dac07-e575-4d16-bbec-4481124a8c59"],
Cell[50267, 1304, 2721, 70, 329, "Input",ExpressionUUID->"3f0c0628-addc-4b17-9ba6-861368189ef4",
 InitializationCell->True],
Cell[52991, 1376, 796, 20, 97, "Text",ExpressionUUID->"04fe972f-77a3-4a86-8f2c-129a599a58d9"],
Cell[CellGroupData[{
Cell[53812, 1400, 2251, 59, 132, "Input",ExpressionUUID->"683fe593-221c-4e1d-9e47-3af850e74a7f"],
Cell[56066, 1461, 199, 3, 41, "Output",ExpressionUUID->"a2d3db48-625a-4c87-95da-db740aead352"]
}, Open  ]],
Cell[56280, 1467, 1874, 50, 235, "Text",ExpressionUUID->"45c79ef9-9ff1-43ab-a96a-d13bc9aa9524"],
Cell[CellGroupData[{
Cell[58179, 1521, 1753, 53, 132, "Input",ExpressionUUID->"6c057e08-c192-4725-9833-2c5a135c3edd"],
Cell[59935, 1576, 177, 3, 41, "Output",ExpressionUUID->"4a4fc942-93c5-4b72-94e0-7db6898d0b34"]
}, Open  ]],
Cell[60127, 1582, 888, 25, 97, "Text",ExpressionUUID->"89627152-414e-47a8-b504-0cf86de35134"],
Cell[CellGroupData[{
Cell[61040, 1611, 285, 4, 80, "Section",ExpressionUUID->"865fee83-a0b9-4dde-a83c-64243de3e753"],
Cell[61328, 1617, 1984, 61, 180, "Text",ExpressionUUID->"1dfca3d4-ad9d-45c3-8820-258f243850c0"],
Cell[CellGroupData[{
Cell[63337, 1682, 989, 30, 107, "Input",ExpressionUUID->"ef7ff574-777d-43b5-90e8-cfdd671ac8ac"],
Cell[64329, 1714, 295, 7, 45, "Output",ExpressionUUID->"28a3cbe4-5eca-49e3-822e-6cf1135506fd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

