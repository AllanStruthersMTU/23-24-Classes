(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68494,       1880]
NotebookOptionsPosition[     63372,       1792]
NotebookOutlinePosition[     63974,       1813]
CellTagsIndexPosition[     63931,       1810]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Differentiating Matrix Decompositions", "Title",
 CellChangeTimes->{{3.905433199790596*^9, 
  3.9054332141796827`*^9}},ExpressionUUID->"86c65eeb-29ba-463c-83b4-\
272a963ce65b"],

Cell[TextData[{
 "A matrix decomposition splits a matrix ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "d4dfddb9-cf3f-4100-a87f-9011b6597455"],
 " up into a useful product of structured matrices.  For example:"
}], "Text",
 CellChangeTimes->{{3.905433219670884*^9, 
  3.9054332747558823`*^9}},ExpressionUUID->"b87d2f4c-f7c3-4db1-bbfb-\
5111d818b4d9"],

Cell[TextData[{
 "Singular Value Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"U", ".", "\[CapitalSigma]", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "0310c896-d85c-412c-9625-8beca44ec78b"],
 "  where ",
 Cell[BoxData[
  FormBox["\[CapitalSigma]", TraditionalForm]],ExpressionUUID->
  "b1af86d7-c7f2-4e0b-9cbb-1b0f254a7f9e"],
 " is diagonal with ordered non-negative entries and U and V are orthogonal;"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.905433338745592*^9}, {
  3.905433376004936*^9, 3.9054333970562706`*^9}, {3.905433514910533*^9, 
  3.9054335152541137`*^9}},ExpressionUUID->"96699503-2cca-46e7-a7c0-\
5d7bd531fd08"],

Cell[TextData[{
 "Spectral Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"X", ".", "\[CapitalLambda]", ".", 
     SuperscriptBox["X", 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]],ExpressionUUID->
  "143a2f7e-a559-484d-83ae-d1569cc1b74b"],
 " where ",
 Cell[BoxData[
  FormBox["\[CapitalLambda]", TraditionalForm]],ExpressionUUID->
  "ea38f02f-984c-46bd-8ee8-540bfa6763cc"],
 " is diagonal;"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.9054334039688005`*^9}, 
   3.9054335114219656`*^9},ExpressionUUID->"cc8a789a-fbac-427b-88b1-\
5ed8862f5b39"],

Cell[TextData[{
 "Symmetric (",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"A", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "c37f9489-704a-4eb2-add2-922c9385c7df"],
 ") Spectral Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "\[CapitalLambda]", ".", 
     RowBox[{"Q", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "01c22a7c-ce3f-4eb7-9dcf-6e0930205ba2"],
 "  where ",
 Cell[BoxData[
  FormBox["\[CapitalLambda]", TraditionalForm]],ExpressionUUID->
  "405d395b-82a8-48e7-9316-f7fc2c48f075"],
 " is diagonal and ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "9787d3a4-ac19-44b6-a7a9-f033f98f235b"],
 " is orthogonal;"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.9054334522660074`*^9}, {
  3.905433492699395*^9, 
  3.905433520321575*^9}},ExpressionUUID->"4f8b7be6-28b2-40ba-858d-\
cb4dc4245c76"],

Cell[TextData[{
 "Schur Decomposition (",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"A", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "a706e658-d336-4b9b-89de-f1d94e642e77"],
 ") Spectral Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "T", ".", 
     RowBox[{"Q", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "eaf43a87-026e-445c-8a13-a3942a819f24"],
 "  where ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "9e4b3f90-12ef-4747-a157-04787add05ee"],
 " is pseudo-upper triangular and ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "118e9562-9d91-4c6a-b557-8815a30eb965"],
 " is orthogonal;"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.9054334522660074`*^9}, {
  3.905433492699395*^9, 
  3.9054336089748745`*^9}},ExpressionUUID->"1d4e2b03-2d8f-408e-b098-\
c376ea0d06dd"],

Cell[TextData[{
 "Hessenberg Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "H", ".", 
     RowBox[{"Q", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "febc5ba7-d55d-4768-a6fc-5c3233eb2d9a"],
 " where H is upper Hessenberg and ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "3c61fa7a-9cc5-4a4c-b7d0-64679b443d05"],
 " is orthogonal. (Direct)"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.9054335262799797`*^9}, {
  3.9054336451644373`*^9, 
  3.9054336488568068`*^9}},ExpressionUUID->"0aa1085a-e87a-4994-b0b5-\
cdd6c24645be"],

Cell[TextData[{
 "Symmetric (",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"A", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "d2c311bf-8b56-4818-93da-b291ee45c3f7"],
 ") Hessenberg Decomposition: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "T", ".", 
     RowBox[{"Q", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "17904a26-ae35-4203-bc7e-3c11a8b9c28c"],
 " where T is tridiagonal and ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "6df0e383-cbcd-4e1d-82e4-4405d7313e4a"],
 " is orthogonal. (Direct)"
}], "Item",
 CellChangeTimes->{{3.90543327907298*^9, 3.90543350735485*^9}, {
  3.9054336198903613`*^9, 
  3.9054336531889086`*^9}},ExpressionUUID->"bccaba1d-39a6-4a70-b2a5-\
7ed2454c8402"],

Cell[TextData[{
 "These decompositions can be differentiated and some of the results are \
useful!  By differentiated I mean that you can compute derivatives of the \
products from the decomposition and the derivative of the data matrix ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "305887ce-4957-47a5-b717-dadf196a90dc"],
 ".  We are going to look at the SVD first. Our second target is the Schur \
decomposition. "
}], "Text",
 CellChangeTimes->{{3.9054336655770793`*^9, 
  3.9054338281014633`*^9}},ExpressionUUID->"3a7ee43f-52c0-42f9-ab19-\
8eee81665033"],

Cell[CellGroupData[{

Cell["Differentiating the SVD", "Subtitle",
 CellChangeTimes->{{3.9053221474326577`*^9, 3.905322158600971*^9}, {
  3.9053224857862453`*^9, 3.9053224874298773`*^9}, {3.9053225367131104`*^9, 
  3.905322546675497*^9}, {3.905327915897973*^9, 
  3.9053279170331354`*^9}},ExpressionUUID->"d1b3f2fd-79fa-467b-b3e6-\
b3d347009a21"],

Cell[TextData[{
 "The SVD expresses an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "87a51961-7c10-4278-be7f-b13cf0f0f687"],
 " matrix as the product\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"U", ".", "\[CapitalSigma]", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "06bc512c-14dc-4272-ad16-dead542b1d3a"],
 "\nwhere ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "9dbc144c-ffd8-4c06-8478-2caa947b4061"],
 " and ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "6f6a687e-141e-4b16-ab25-64c6a2cae003"],
 " are orthogonal and ",
 Cell[BoxData[
  FormBox["\[CapitalSigma]", TraditionalForm]],ExpressionUUID->
  "8d221f24-ff69-4443-8a09-4a83b2fdab6e"],
 " is diagonal. For simplicity lets assume the matrix is square and full rank \
then the product rule gives\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "'"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"U", "'"}], ".", "\[CapitalSigma]", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", 
      RowBox[{"\[CapitalSigma]", "'"}], ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", "\[CapitalSigma]", ".", 
      RowBox[{
       RowBox[{"V", "\[Transpose]"}], "'"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"e4ba35c9-36dd-4e83-a15d-2d855a92d576"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"dA", "=", 
    RowBox[{
     RowBox[{"dU", ".", "\[CapitalSigma]", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", "d\[CapitalSigma]", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", "\[CapitalSigma]", ".", 
      RowBox[{"dV", "\[Transpose]"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "d2b825e2-52da-452f-968e-6c1fe8b27253"],
 "\nSince  U and V are orthogonal ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", ".", 
     RowBox[{"U", "\[Transpose]"}]}], "=", 
    RowBox[{
     RowBox[{"V", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"d02975e4-412d-4d81-a751-36a12a3d1c15"],
 ". Differentiating the first of these gives\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"U", "\[Transpose]"}], ")"}], "'"}]}], "+", 
     RowBox[{
      RowBox[{"U", "'"}], ".", 
      RowBox[{"U", "\[Transpose]"}]}]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"1e7b4385-0704-4fd7-b6d9-4362295b0f74"],
 "\nwhich means that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", "'"}], ".", 
     RowBox[{"U", "\[Transpose]"}]}], "=", 
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"U", "'"}], ".", 
        RowBox[{"U", "\[Transpose]"}]}], ")"}], "\[Transpose]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"4c97c59f-6618-4646-94eb-7791f6338d77"],
 ".  In other words, \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    RowBox[{
     RowBox[{"U", "'"}], ".", 
     RowBox[{"U", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "96e7bbc3-a8ac-43b6-bac0-6b68fc2770af"],
 " \nis a skew matrix. Similarly we have that \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"Y", "=", 
    RowBox[{
     RowBox[{"V", "'"}], ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "909d5416-0050-44d1-8316-76ce6f91280c"],
 "\nis a skew matrix.  "
}], "Text",
 CellChangeTimes->{{3.9053279202689257`*^9, 3.905328411180498*^9}, {
  3.905508510731044*^9, 
  3.9055085302151175`*^9}},ExpressionUUID->"85ae8e2b-4b4c-4128-abb1-\
f2a120290be6"],

Cell[TextData[{
 "Our goal is to compute the diagonal matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalSigma]", "'"}], TraditionalForm]],ExpressionUUID->
  "9495427e-4189-462d-9345-561d183d90e9"],
 " and the skew matrices ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "f63b0674-3da7-4290-82d9-e052bd085024"],
 " and Y from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "'"}], TraditionalForm]],ExpressionUUID->
  "a70899f0-cafb-43e7-93ca-1a5577f5e9ab"],
 " the diagonal matrix ",
 Cell[BoxData[
  FormBox["\[CapitalSigma]", TraditionalForm]],ExpressionUUID->
  "895c9d52-5c1c-4985-b9d3-80efce5f708b"],
 " and the orthogonal matrices ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "1ed9fa96-ccfb-492b-a225-cb9b87759aaa"],
 " and V.  Multiply the product rule expression by U\[Transpose] and V\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"A", "'"}], ".", "V"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"U", "\[Transpose]"}], ".", 
      RowBox[{"U", "'"}], ".", "\[CapitalSigma]", ".", 
      RowBox[{"V", "\[Transpose]"}], ".", "V"}], "+", 
     RowBox[{
      RowBox[{"U", "\[Transpose]"}], ".", "U", ".", 
      RowBox[{"\[CapitalSigma]", "'"}], ".", 
      RowBox[{"V", "\[Transpose]"}], ".", "V"}], "+", 
     RowBox[{
      RowBox[{"U", "\[Transpose]"}], ".", "U", ".", "\[CapitalSigma]", ".", 
      RowBox[{
       RowBox[{"V", "\[Transpose]"}], "'"}], ".", "V"}]}]}], 
   TraditionalForm]],ExpressionUUID->"69b93074-014c-44af-a1ab-c5ee52e294d0"],
 "\northogonality means this is  \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"A", "'"}], ".", "V"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"U", "\[Transpose]"}], ".", 
      RowBox[{"U", "'"}], ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", "'"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", 
      RowBox[{
       RowBox[{"V", "\[Transpose]"}], "'"}], ".", "V"}]}]}], 
   TraditionalForm]],ExpressionUUID->"6540d137-dd51-496e-a9cb-75737a4cf9dd"],
 "\nthe definition of X and Y means this is   \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", "'"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", "Y"}]}], "=", 
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"A", "'"}], ".", "V"}]}], TraditionalForm]],ExpressionUUID->
  "68cea9a5-75af-4f1d-b63d-97c4098a5b60"],
 "\nThe diagonal entries of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", ".", "\[CapitalSigma]"}], TraditionalForm]],ExpressionUUID->
  "796ed89b-ccd7-4672-8e25-d02e6da616b3"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalSigma]", ".", "Y"}], TraditionalForm]],ExpressionUUID->
  "54d5dcfa-691f-4c4b-8302-4c946491d53b"],
 " are zero so the diagonal of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalSigma]", "'"}], TraditionalForm]],ExpressionUUID->
  "2e2e55a1-458d-4a5c-a531-f639ffc39634"],
 " matches the diagonal of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", "\[Transpose]"}], ".", 
    RowBox[{"A", "'"}], ".", "V"}], TraditionalForm]],ExpressionUUID->
  "c4a4f5d9-2d07-4c86-acb5-482633726cee"],
 ".  I am going to write this as\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Sigma]", "'"}], "=", 
    RowBox[{"diagonal", "(", 
     RowBox[{
      RowBox[{"U", "\[Transpose]"}], ".", 
      RowBox[{"A", "'"}], ".", "V"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"c18950f5-825e-4e60-8f4e-6d9985e32b63"],
 "\nLets check this part of the computation. "
}], "Text",
 CellChangeTimes->{{3.905328428742011*^9, 3.9053287258237715`*^9}, {
  3.9053289108107214`*^9, 3.905328914687092*^9}, {3.905328962432089*^9, 
  3.905329094464033*^9}, {3.905329144354046*^9, 3.905329407869517*^9}, {
  3.9053296844332123`*^9, 3.905329701088558*^9}, {3.90533006272886*^9, 
  3.9053303199913855`*^9}, {3.9053304449325323`*^9, 3.905330462161231*^9}, {
  3.905330495486883*^9, 3.9053306514969244`*^9}, {3.9053308780268893`*^9, 
  3.9053309017132616`*^9}, {3.9053309399793634`*^9, 3.905330984494705*^9}, {
  3.9053311298078327`*^9, 3.9053311300889025`*^9}, {3.905433857192814*^9, 
  3.9054342626110373`*^9}, {3.905497965381214*^9, 3.905498029272128*^9}, {
  3.905498179289077*^9, 3.905498250935405*^9}, {3.905498282574486*^9, 
  3.9054982846041307`*^9}, {3.905498602250944*^9, 
  3.9054986226173553`*^9}},ExpressionUUID->"3fd55326-63c9-4aa4-97cd-\
0897ba20e0d9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";", " ", 
  RowBox[{"\[Epsilon]", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"dA", "=", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dS", "=", 
   RowBox[{"Diagonal", "[", 
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Diagonal", "[", "S", "]"}], ",", 
   RowBox[{
    RowBox[{"Diagonal", "[", "S", "]"}], "+", "dS"}], ",", 
   RowBox[{"SingularValueList", "[", 
    RowBox[{"A", "+", "dA"}], "]"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Diagonal", "[", "S", "]"}], "+", "dS"}], ")"}], "-", 
  RowBox[{"SingularValueList", "[", 
   RowBox[{"A", "+", "dA"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.90549831743038*^9, 3.9054983340270967`*^9}, {
  3.9054983640466995`*^9, 3.9054985815184803`*^9}, {3.905501892452447*^9, 
  3.905501895501112*^9}, {3.9055027916070995`*^9, 3.905502901338725*^9}, {
  3.9055091567704124`*^9, 3.9055091601411805`*^9}, {3.905509308748205*^9, 
  3.9055093140810547`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"06004f4c-08d9-4bac-a1b6-16009ef5a594"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.8199331158965146`", ",", "1.3405788847482052`", ",", 
     "1.1235405853957035`", ",", "0.33546679462052953`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.820035155771968`", ",", "1.3399857606159076`", ",", 
     "1.123974623773897`", ",", "0.33464676430205104`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.8200357845426023`", ",", "1.3399859974759274`", ",", 
     "1.1239745462610582`", ",", "0.33464678277947374`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.905501896307446*^9, {3.905502777478121*^9, 3.9055028108038125`*^9}, {
   3.9055028521700096`*^9, 3.9055029052425694`*^9}, 3.905509177979582*^9, {
   3.90550930977897*^9, 3.905509314724397*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"5df87da4-e581-4250-8016-2fb910bf26dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "6.287706342256172`*^-7"}], ",", 
   RowBox[{"-", "2.3686001981992888`*^-7"}], ",", "7.751283881418658`*^-8", 
   ",", 
   RowBox[{"-", "1.8477422703000457`*^-8"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.905501896307446*^9, {3.905502777478121*^9, 3.9055028108038125`*^9}, {
   3.9055028521700096`*^9, 3.9055029052425694`*^9}, 3.905509177979582*^9, {
   3.90550930977897*^9, 3.9055093147319365`*^9}},
 CellLabel->"Out[19]=",ExpressionUUID->"0abf2f48-cc55-4f62-89fc-c824730b42a4"]
}, Open  ]],

Cell[TextData[{
 "If we can compute the skew matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    RowBox[{
     RowBox[{"U", "'"}], 
     RowBox[{"U", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "2245a980-0a68-4ec4-8c3c-6814bf466fa0"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Y", "=", 
    RowBox[{
     RowBox[{"V", "'"}], 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "582c9cdb-6497-4106-b1a7-456850e258f8"],
 " we will be able to compute the derivatives ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "'"}], TraditionalForm]],ExpressionUUID->
  "e2188b70-a527-4766-9ec0-6256d6afad39"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "'"}], TraditionalForm]],ExpressionUUID->
  "058980cf-13c0-4f12-b191-4f137e5c6db6"],
 ". Our algebraic equation is \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", "Y"}]}], "=", 
    RowBox[{"B", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"U", "\[Transpose]"}], ".", 
       RowBox[{"A", "'"}], ".", "V"}], "-", 
      RowBox[{"\[CapitalSigma]", "'"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"b3de1a6b-c082-466f-ad37-71409a72269b"],
 "\nNote that neither ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", ".", "\[CapitalSigma]"}], TraditionalForm]],ExpressionUUID->
  "d6c36dcc-4366-43b0-889a-da9607be2581"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalSigma]", ".", "Y"}], TraditionalForm]],ExpressionUUID->
  "950a7d93-0b34-4fc8-a210-7d3427d020c0"],
 " are skew! and the RHS matrix ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "dc81dd48-0119-4981-afb0-6882cfaac57a"],
 " has zeros on the diagonal. I can transpose to get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalSigma]", "\[Transpose]"}], ".", 
      RowBox[{"X", "\[Transpose]"}]}], "+", 
     RowBox[{
      RowBox[{"Y", "\[Transpose]"}], ".", 
      RowBox[{"\[CapitalSigma]", "\[Transpose]"}]}]}], "=", 
    RowBox[{"B", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "231707b3-3b3a-4502-bbb6-b36a6d4ec38c"],
 "  or equivalently ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[CapitalSigma]", ".", "X"}]}], "-", 
     RowBox[{"Y", ".", "\[CapitalSigma]"}]}], "=", 
    RowBox[{"B", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "309f7871-5c60-48b6-a3f5-fad1fbe8e593"],
 "\nsince ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "a22e1f5f-c669-4234-9ab2-8137c50c8287"],
 " and ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "6a77579d-03bc-4eb0-9627-8d305114100c"],
 " are skew and ",
 Cell[BoxData[
  FormBox["\[CapitalSigma]", TraditionalForm]],ExpressionUUID->
  "69daa830-a278-448f-9b1d-2218ac83e0e2"],
 " is diagonal.  Subtracting I get \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalSigma]", ".", 
      RowBox[{"(", 
       RowBox[{"X", "+", "Y"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"X", "+", "Y"}], ")"}], ".", "\[CapitalSigma]"}]}], "=", 
    RowBox[{"B", "-", 
     RowBox[{"B", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "8bdaa6a2-9639-43b3-a8ca-9774534286d7"],
 "\nwhich is a standard diagonal Sylvester/Lyapunov equation. Mathematica, \
matlab and Julia all have solvers for these linear matrix equations."
}], "Text",
 CellChangeTimes->{{3.905328428742011*^9, 3.9053287258237715`*^9}, {
  3.9053289108107214`*^9, 3.905328914687092*^9}, {3.905328962432089*^9, 
  3.905329094464033*^9}, {3.905329144354046*^9, 3.905329407869517*^9}, {
  3.9053296844332123`*^9, 3.905329701088558*^9}, {3.90533006272886*^9, 
  3.9053303199913855`*^9}, {3.9053304449325323`*^9, 3.905330462161231*^9}, {
  3.905330495486883*^9, 3.9053306514969244`*^9}, {3.9053308780268893`*^9, 
  3.9053309017132616`*^9}, {3.9053309399793634`*^9, 3.905330984494705*^9}, {
  3.9053311298078327`*^9, 3.9053311300889025`*^9}, {3.905433857192814*^9, 
  3.9054342626110373`*^9}, {3.905497965381214*^9, 3.905498029272128*^9}, {
  3.905498179289077*^9, 3.905498250935405*^9}, {3.905498282574486*^9, 
  3.9054982846041307`*^9}, {3.9054986271423135`*^9, 3.9054989564575567`*^9}, {
  3.905499698912465*^9, 
  3.9054996995603685`*^9}},ExpressionUUID->"ff34e681-bde9-437b-bbf2-\
3ea9ef610d13"],

Cell["Here is what we have so far!", "Text",
 CellChangeTimes->{{3.9054990774217863`*^9, 
  3.905499087472336*^9}},ExpressionUUID->"0f32985a-557f-434e-8eeb-\
583d76f351f2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";", " ", 
  RowBox[{"\[Epsilon]", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"dA", "=", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dS", "=", 
   RowBox[{"Diagonal", "[", 
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}], "-", 
    RowBox[{"DiagonalMatrix", "[", "dS", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"XPlusY", "=", 
    RowBox[{"LyapunovSolve", "[", 
     RowBox[{"S", ",", "S", ",", 
      RowBox[{"B", "-", 
       RowBox[{"B", "\[Transpose]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "XPlusY", "]"}]}], "Input",
 CellChangeTimes->{{3.90549831743038*^9, 3.9054983340270967`*^9}, {
  3.9054983640466995`*^9, 3.9054985815184803`*^9}, {3.9054989721897035`*^9, 
  3.9054990620965204`*^9}, {3.905499122834623*^9, 3.9054991271726594`*^9}, {
  3.9054995152969885`*^9, 3.9054995221149616`*^9}, {3.905499743257885*^9, 
  3.9054997434966717`*^9}, {3.9055018859034653`*^9, 3.905501904543595*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"2776fb72-1fa6-412e-bc81-f363a3aac150"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.0026084801843237948`", "0.0019342569260705977`", 
      "0.006156218346997735`"},
     {
      RowBox[{"-", "0.0026084801843237948`"}], "0.`", 
      RowBox[{"-", "0.0028895084884738432`"}], "0.0002726592751311704`"},
     {
      RowBox[{"-", "0.0019342569260705977`"}], "0.0028895084884738432`", 
      "0.`", 
      RowBox[{"-", "0.004407904412547457`"}]},
     {
      RowBox[{"-", "0.006156218346997735`"}], 
      RowBox[{"-", "0.0002726592751311704`"}], "0.004407904412547457`", 
      "0.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9054983969363604`*^9, 3.9054984813063602`*^9}, {
   3.90549852030669*^9, 3.905498582225958*^9}, {3.9054989897710133`*^9, 
   3.9054990084188457`*^9}, 3.9054990627159805`*^9, 3.905499127764537*^9, 
   3.9054995226126328`*^9, 3.9054997444097204`*^9, 3.905501222424286*^9, {
   3.9055018885747623`*^9, 3.9055019050430884`*^9}, 3.9055027693202243`*^9, 
   3.90550400377684*^9, 3.9055096098571453`*^9},
 CellLabel->
  "Out[26]//MatrixForm=",ExpressionUUID->"a20049b5-52d0-4597-986e-\
98e3d3c85afa"]
}, Open  ]],

Cell[TextData[{
 "Of course, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", "=", 
    RowBox[{"X", "+", "Y"}]}], TraditionalForm]],ExpressionUUID->
  "24586efc-c208-424a-8815-af6c82b4a5fd"],
 " comes out skew and substituting ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Y", "=", 
    RowBox[{"Z", "-", "X"}]}], TraditionalForm]],ExpressionUUID->
  "f39d7ec4-fa27-4041-8c86-7541a414f91e"],
 " in\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", "Y"}]}], "=", "B"}], TraditionalForm]],
  ExpressionUUID->"6b6f7d18-c271-4b51-957f-0dc41e594f28"],
 "\neliminates ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "c578272f-d31e-4d7b-8c58-81ebad0d1770"],
 " to give \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "-", 
     RowBox[{"\[CapitalSigma]", ".", "X"}]}], "=", 
    RowBox[{"B", "-", 
     RowBox[{"\[CapitalSigma]", ".", "Z", " "}]}]}], TraditionalForm]],
  ExpressionUUID->"5c4ca3c5-4f95-426a-9bde-9f95351103df"],
 "\nThis is a non standard Sylvester/Lyapunov equation.  The matrices on both \
sides are constructed or maybe constrained to be skew! For a general non-skew \
right hand side the equations are inconsistent.  However, we know how to \
write down the solution as a the Hadamard product\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    RowBox[{"K", "\[SmallCircle]", 
     RowBox[{"(", 
      RowBox[{"B", "-", 
       RowBox[{"\[CapitalSigma]", ".", "Z"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"005ee13f-3d92-43cb-81fe-454459e3663a"],
 " \nwhere\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["K", 
     RowBox[{"i", ",", "j"}]], "=", 
    RowBox[{"(", GridBox[{
       {"0", "if", 
        RowBox[{"i", "=", "j"}]},
       {
        FractionBox["1", 
         RowBox[{
          RowBox[{"s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{
          "s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]], 
        "if", 
        RowBox[{"i", "\[NotEqual]", "j"}]}
      }]}]}], TraditionalForm]],ExpressionUUID->
  "e59dcc28-79ea-478f-a88a-027993c1447e"]
}], "Text",
 CellChangeTimes->{{3.905499131167159*^9, 3.9054992208381186`*^9}, {
  3.905499288685218*^9, 3.9054994659983654`*^9}, {3.9054995302953863`*^9, 
  3.905499649078125*^9}, {3.9054997706869965`*^9, 3.905499817143963*^9}, {
  3.90550000101987*^9, 3.9055000098388844`*^9}, {3.9055004074808893`*^9, 
  3.9055004711685705`*^9}, {3.9055007659238267`*^9, 3.9055008869973927`*^9}, {
  3.905500946492446*^9, 
  3.9055010726338596`*^9}},ExpressionUUID->"43be927d-0a81-4fec-b24e-\
73b67bca5f4d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"K", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "==", "j"}], ",", "0", ",", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"S", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"S", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}]]}], "]"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"K", "*", 
    RowBox[{"(", 
     RowBox[{"B", "-", 
      RowBox[{"S", ".", "Z"}]}], ")"}]}]}], ";", " ", 
  RowBox[{"Y", "=", 
   RowBox[{"Z", "-", "X"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"X", ".", "S"}], "-", 
      RowBox[{"S", ".", "X"}], "-", 
      RowBox[{"(", 
       RowBox[{"B", "-", 
        RowBox[{"S", ".", "Z"}]}], ")"}]}], ",", " ", 
     RowBox[{
      RowBox[{"X", ".", "S"}], "+", 
      RowBox[{"S", ".", "Y"}], "-", "B"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9054997494448576`*^9, 3.905499762767275*^9}, {
  3.9055010834649167`*^9, 3.9055012707376385`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"b07867e7-6e9a-40aa-8b3a-9b0903fb8cec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.4463077972909975`*^-19", ",", "1.7533498565291496`*^-18"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.905499753215444*^9, 3.905499763342888*^9}, {
   3.905501140231848*^9, 3.9055011649928303`*^9}, {3.905501200467473*^9, 
   3.9055012096704144`*^9}, {3.905501245063285*^9, 3.9055012717501016`*^9}, 
   3.905503999913995*^9, 3.9055097882123375`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"6b914c67-2b9c-41ab-baa4-ff29e4fac911"]
}, Open  ]],

Cell["\<\
The summary is that if I put all of this together I can \
\[OpenCurlyDoubleQuote]differentiate\[CloseCurlyDoubleQuote] the SVD.  This \
is a good time to ask \[OpenCurlyDoubleQuote]what can go wrong\
\[CloseCurlyDoubleQuote].  After that it is time to hide all this stuff in a \
function.   \
\>", "Text",
 CellChangeTimes->{{3.905501402145002*^9, 3.9055015107061925`*^9}, {
  3.905501825689125*^9, 
  3.905501843448932*^9}},ExpressionUUID->"fd8dac07-e575-4d16-bbec-\
4481124a8c59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SVDDiff", "[", 
   RowBox[{"A_", ",", "dA_", ",", 
    RowBox[{"{", 
     RowBox[{"U_", ",", "S_", ",", "V_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ds", ",", "B", ",", "Z", ",", "K", ",", "m", ",", "n", ",", "dX", ",", 
      "dY"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ds", "=", 
      RowBox[{"Diagonal", "[", 
       RowBox[{
        RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}], "-", 
       RowBox[{"DiagonalMatrix", "[", "ds", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Z", "=", 
      RowBox[{"LyapunovSolve", "[", 
       RowBox[{"S", ",", "S", ",", 
        RowBox[{"B", "-", 
         RowBox[{"B", "\[Transpose]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "==", "j"}], ",", "0", ",", 
          FractionBox["1", 
           RowBox[{
            RowBox[{"S", "\[LeftDoubleBracket]", 
             RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], "-", 
            RowBox[{"S", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}]]}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "m"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "m"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dX", "=", 
      RowBox[{"K", "*", 
       RowBox[{"(", 
        RowBox[{"B", "-", 
         RowBox[{"S", ".", "Z"}]}], ")"}]}]}], ";", " ", 
     RowBox[{"dY", "=", 
      RowBox[{"Z", "-", "dX"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ds", ",", "dX", ",", "dY"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9055016429634285`*^9, 3.9055018118803988`*^9}, {
   3.905501952859421*^9, 3.905501953999781*^9}, {3.9055025177945557`*^9, 
   3.9055025276500454`*^9}, 3.905502986415764*^9, {3.905503073753259*^9, 
   3.9055030770395665`*^9}, 3.9055032471922054`*^9, {3.9055034344282627`*^9, 
   3.9055034573882446`*^9}, {3.905503827677577*^9, 3.905503830553288*^9}, {
   3.905503871398664*^9, 3.9055038741756167`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"3f0c0628-addc-4b17-9ba6-861368189ef4"],

Cell[TextData[{
 "We need to test the function and the construction. I am going to check that \
I satisfy the starting point\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", "'"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", "Y"}]}], "=", 
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"A", "'"}], ".", "V"}]}], TraditionalForm]],ExpressionUUID->
  "79381ee6-0788-4a7e-a011-4d8c93b5d5cf"],
 "\nof the computation. "
}], "Text",
 CellChangeTimes->{{3.905501850643645*^9, 3.905501875716764*^9}, {
  3.9055041685495706`*^9, 3.905504169019535*^9}, {3.9055042607019453`*^9, 
  3.9055042927809963`*^9}},ExpressionUUID->"04fe972f-77a3-4a86-8f2c-\
129a599a58d9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "23"}], ";", " ", 
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{"1.0", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";", " ", 
  RowBox[{"Id", "=", 
   RowBox[{"IdentityMatrix", "[", "m", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"dA", "=", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "A", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ds", ",", "dX", ",", "dY"}], "}"}], "=", 
   RowBox[{"SVDDiff", "[", 
    RowBox[{"A", ",", "dA", ",", 
     RowBox[{"{", 
      RowBox[{"U", ",", "S", ",", "V"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"dX", ".", "S"}], "+", 
   RowBox[{"DiagonalMatrix", "[", "ds", "]"}], "+", 
   RowBox[{"S", ".", "dY"}], " ", "-", 
   RowBox[{
    RowBox[{"U", "\[Transpose]"}], ".", "dA", ".", "V"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9055019249204874`*^9, 3.9055019720034113`*^9}, {
   3.90550212409496*^9, 3.905502329737319*^9}, 3.9055024002608852`*^9, {
   3.9055025923716145`*^9, 3.905502651734087*^9}, {3.9055026954669075`*^9, 
   3.905502709836979*^9}, {3.905503001709306*^9, 3.9055030540369616`*^9}, {
   3.905503095463205*^9, 3.905503105557713*^9}, {3.9055032703579903`*^9, 
   3.905503272507556*^9}, 3.905503400043177*^9, {3.905503466318981*^9, 
   3.905503512659134*^9}, {3.9055035693814993`*^9, 3.9055036082350616`*^9}, 
   3.905503648517209*^9, {3.905503842612595*^9, 3.905503853012473*^9}, {
   3.905503899480948*^9, 3.905503899731269*^9}, {3.905504183925736*^9, 
   3.9055042120194287`*^9}, {3.9055099555942364`*^9, 3.9055099599983788`*^9}},
 
 CellLabel->"In[40]:=",ExpressionUUID->"683fe593-221c-4e1d-9e47-3af850e74a7f"],

Cell[BoxData["1.9479350096792352`*^-21"], "Output",
 CellChangeTimes->{{3.905504203228846*^9, 3.905504209359743*^9}, {
  3.9055099503475275`*^9, 3.9055099608720284`*^9}},
 CellLabel->"Out[44]=",ExpressionUUID->"8ca92a0d-2e99-4a03-93d5-30739cd0ab12"]
}, Open  ]],

Cell[TextData[{
 "This is not actually a check that we are computing the derivative correctly \
it is a check that we are implementing the plan correctly.  How should we \
check if the plan is right?  Well one way is to go backwards to the \
\[OpenCurlyDoubleQuote]product rule\[CloseCurlyDoubleQuote] from\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"\[CapitalSigma]", "'"}], "+", 
     RowBox[{"\[CapitalSigma]", ".", "Y"}]}], "=", 
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"A", "'"}], ".", "V"}]}], TraditionalForm]],ExpressionUUID->
  "323ed07c-0c9d-4fbc-81e6-191128bb48be"],
 "\nSo\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", ".", "X", ".", "\[CapitalSigma]"}], "+", 
     RowBox[{"U", ".", 
      RowBox[{"\[CapitalSigma]", "'"}]}], "+", 
     RowBox[{"U", ".", "\[CapitalSigma]", ".", "Y"}]}], "=", 
    RowBox[{
     RowBox[{"A", "'"}], ".", "V"}]}], TraditionalForm]],ExpressionUUID->
  "99d22329-71b6-4396-af16-9f64431161c5"],
 "\nand \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", ".", "X", ".", "\[CapitalSigma]", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", 
      RowBox[{"\[CapitalSigma]", "'"}], ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", "\[CapitalSigma]", ".", "Y", ".", 
      RowBox[{"V", "\[Transpose]"}]}]}], "=", 
    RowBox[{"A", "'"}]}], TraditionalForm]],ExpressionUUID->
  "91cbd77d-7046-47c9-ad74-f9f24090137f"],
 "\nwhich we can check."
}], "Text",
 CellChangeTimes->{{3.9055046918386154`*^9, 3.905504985871771*^9}, {
  3.9055050512182713`*^9, 
  3.9055050516397333`*^9}},ExpressionUUID->"45c79ef9-9ff1-43ab-a96a-\
d13bc9aa9524"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";", " ", 
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{"1.0", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";", " ", 
  RowBox[{"Id", "=", 
   RowBox[{"IdentityMatrix", "[", "m", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"dA", "=", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "A", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ds", ",", "dX", ",", "dY"}], "}"}], "=", 
   RowBox[{"SVDDiff", "[", 
    RowBox[{"A", ",", "dA", ",", 
     RowBox[{"{", 
      RowBox[{"U", ",", "S", ",", "V"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"U", ".", "dX", ".", "S", ".", 
    RowBox[{"V", "\[Transpose]"}]}], "+", 
   RowBox[{"U", ".", 
    RowBox[{"DiagonalMatrix", "[", "ds", "]"}], ".", 
    RowBox[{"V", "\[Transpose]"}]}], "+", 
   RowBox[{"U", ".", "S", ".", "dY", ".", 
    RowBox[{"V", "\[Transpose]"}]}], " ", "-", "dA"}], "]"}]}], "Input",
 CellChangeTimes->{{3.905504997903039*^9, 3.905505041719451*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"6c057e08-c192-4725-9833-2c5a135c3edd"],

Cell[BoxData["7.634865225812724`*^-22"], "Output",
 CellChangeTimes->{3.9055050426054707`*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"4a4fc942-93c5-4b72-94e0-7db6898d0b34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "9"}], ",", "9"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.905511011171793*^9, 3.905511048775793*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"26d97a6e-e877-4e91-a2e5-1174dc1b9320"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"6", "6", 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "4"}]},
     {
      RowBox[{"-", "7"}], 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "6"}], "9"},
     {
      RowBox[{"-", "3"}], 
      RowBox[{"-", "8"}], "1", "5"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9055110377774687`*^9, 3.9055110491906013`*^9}},
 CellLabel->
  "Out[46]//MatrixForm=",ExpressionUUID->"f2da7928-04fb-4179-9c67-\
77b526b86981"]
}, Open  ]],

Cell[TextData[{
 "We can rearrange this a bit. I changed some names and stuff.   \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", ".", "dX", ".", "S", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", 
      RowBox[{"(", 
       RowBox[{"S", "+", "dS"}], ")"}], ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", "S", ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"V", ".", 
         RowBox[{"dY", "\[Transpose]"}]}], ")"}], "\[Transpose]"}]}]}], "=", 
    RowBox[{"A", "+", "dA"}]}], TraditionalForm]],ExpressionUUID->
  "c26c9939-bb13-4098-9dc7-5c748d645ca0"],
 "\nRemember there are missing product terms e.g. dX times dY and/or dS"
}], "Text",
 CellChangeTimes->{{3.9055051149780283`*^9, 3.9055053118386445`*^9}, {
  3.9055053427159863`*^9, 3.9055053616651525`*^9}, {3.9055100806649637`*^9, 
  3.905510083228001*^9}, {3.905510189295603*^9, 
  3.905510226098198*^9}},ExpressionUUID->"89627152-414e-47a8-b504-\
0cf86de35134"],

Cell[TextData[{
 "Differentiate ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "x", ")"}], "=", 
    SuperscriptBox["x", "2"]}], TraditionalForm]],ExpressionUUID->
  "612a78e3-27ec-4883-82fc-bfd541d72244"],
 " from first principles\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "+", "h"}], ")"}], "2"], "=", 
    RowBox[{
     SuperscriptBox["x", "2"], "+", " ", 
     RowBox[{"2", " ", "x", " ", "h"}], " ", "+", " ", 
     SuperscriptBox["h", "2"], "  "}]}], TraditionalForm]],ExpressionUUID->
  "85575857-0c29-4e6a-8494-a03b68480596"],
 "looks like  ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], "+", " ", 
    RowBox[{"2", " ", "x", " ", "h"}]}], " ", "=", 
   RowBox[{
    RowBox[{"f", 
     RowBox[{"(", "x", ")"}]}], "+", 
    RowBox[{"2", "x", " ", "h"}]}]}]],ExpressionUUID->
  "5db539cc-90ce-4d8d-b544-aa0e3e747461"],
 "\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.905510250152422*^9, 
  3.905510417516616*^9}},ExpressionUUID->"149aba07-7e4c-4106-9a05-\
9184956bb49f"],

Cell[CellGroupData[{

Cell["\<\
Tuesday the 10th 
Algebraic Approach\
\>", "Subsection",
 CellChangeTimes->{{3.905916867981647*^9, 
  3.905916883579164*^9}},ExpressionUUID->"12586420-1925-4da1-a9b1-\
58b1e5eeff3b"],

Cell[TextData[{
 "The first principle derivation of the product rule expression is pretty \
direct\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"U", ".", "S", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0b66361e-d328-4e03-98ee-723d4c06129d"],
 "\nSet up the derivative expansion\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "+", 
     RowBox[{"h", " ", "dA"}], "+", "\[Ellipsis]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"U", "+", 
        RowBox[{"h", " ", "dU"}], "+", "\[Ellipsis]"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"S", "+", 
        RowBox[{"h", " ", "dS"}], "+", "\[Ellipsis]"}], ")"}], ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"V", "+", 
         RowBox[{"h", " ", "dV"}], "+", "\[Ellipsis]"}], ")"}], 
       "\[Transpose]"}]}], "=", 
     RowBox[{
      RowBox[{"U", ".", "S", ".", 
       RowBox[{"V", "\[Transpose]"}]}], "+", 
      RowBox[{"h", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dU", ".", "S", ".", 
          RowBox[{"V", "\[Transpose]"}]}], "+", 
         RowBox[{"U", ".", "dS", ".", 
          RowBox[{"V", "\[Transpose]"}]}], "+", 
         RowBox[{"U", ".", "D", ".", 
          RowBox[{"dV", "\[Transpose]"}]}]}], ")"}]}], "+", 
      "\[Ellipsis]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "558df5d2-ba8f-403e-b7ca-52b67f309072"],
 " "
}], "Text",
 CellChangeTimes->{{3.905916409268921*^9, 3.905916475428059*^9}, {
  3.905916533238781*^9, 
  3.9059168015474873`*^9}},ExpressionUUID->"0454a0ba-c307-47bf-a761-\
d722debff961"],

Cell[TextData[{
 "The first principle derivation of the product rule expression is pretty \
direct\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"U", ".", "S", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c8a3c6eb-5968-4bfb-bc9a-a4d566ca2458"],
 "\nYou might like this better without the \[Ellipsis]\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "+", 
     RowBox[{"h", " ", "dA"}], "+", 
     RowBox[{"O", "(", 
      SuperscriptBox["h", "2"], ")"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"U", "+", 
        RowBox[{"h", " ", "dU"}], "+", 
        RowBox[{"O", "(", 
         SuperscriptBox["h", "2"], ")"}]}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"S", "+", 
        RowBox[{"h", " ", "dS"}], "+", 
        RowBox[{"O", "(", 
         SuperscriptBox["h", "2"], ")"}]}], ")"}], ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"V", "+", 
         RowBox[{"h", " ", "dV"}], "+", 
         RowBox[{"O", "(", 
          SuperscriptBox["h", "2"], ")"}]}], ")"}], "\[Transpose]"}]}], "=", 
     RowBox[{
      RowBox[{"U", ".", "S", ".", 
       RowBox[{"V", "\[Transpose]"}]}], "+", 
      RowBox[{"h", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dU", ".", "S", ".", 
          RowBox[{"V", "\[Transpose]"}]}], "+", 
         RowBox[{"U", ".", "dS", ".", 
          RowBox[{"V", "\[Transpose]"}]}], "+", 
         RowBox[{"U", ".", "D", ".", 
          RowBox[{"dV", "\[Transpose]"}]}]}], ")"}]}], "+", 
      RowBox[{"O", "(", 
       SuperscriptBox["h", "2"], ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f8f16cdb-89c4-4f46-998b-417bce649e32"],
 " "
}], "Text",
 CellChangeTimes->{{3.905916409268921*^9, 3.905916475428059*^9}, {
  3.905916533238781*^9, 3.9059168015474873`*^9}, {3.9059169057473917`*^9, 
  3.905916983763105*^9}},ExpressionUUID->"f90ce8b1-0ef0-4126-864c-\
46c9281301fe"],

Cell[TextData[{
 "Matching up the terms in the expansion give us the \
\[OpenCurlyDoubleQuote]derivative\[CloseCurlyDoubleQuote] starting point \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"dA", "=", 
    RowBox[{
     RowBox[{"dU", ".", "S", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", "dS", ".", 
      RowBox[{"V", "\[Transpose]"}]}], "+", 
     RowBox[{"U", ".", "D", ".", 
      RowBox[{"dV", "\[Transpose]"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1e2216e8-3ac4-4f36-a3de-9131a5a53a31"],
 "\nwhich we implemented in the function we made last Thursday.  The function \
returns \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"ds", ",", " ", "dX", ",", " ", "dY"}], "}"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "eb531e40-334b-409e-88a8-e1036d05107a"],
 "\nwhere ",
 Cell[BoxData[
  FormBox["ds", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9a6c0dee-9b5f-4dd9-895a-0c7140929c4e"],
 " is the diagonal entries of ",
 Cell[BoxData[
  FormBox["dS", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b3a2b8b6-07d4-4082-a7d0-b32395b63ec0"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"dX", "=", 
    RowBox[{"dU", " ", 
     RowBox[{"U", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "140669c8-c6f0-4914-8b59-3d92f67a2f67"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"dY", "=", 
    RowBox[{"dV", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "52cdf3dc-ddc8-40bb-9d96-0ce1b426ee23"],
 "\n\t"
}], "Text",
 CellChangeTimes->{{3.905917205972066*^9, 3.905917310128687*^9}, {
  3.905917696263598*^9, 
  3.905917772958269*^9}},ExpressionUUID->"906091fa-d9bc-421b-a570-\
71b26f3aeecf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A", ",", "dA"}], "}"}], "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "m", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ds", ",", "dX", ",", "dY"}], "}"}], "=", 
   RowBox[{"SVDDiff", "[", 
    RowBox[{"A", ",", "dA", ",", 
     RowBox[{"{", 
      RowBox[{"U", ",", "S", ",", "V"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dS", "=", 
   RowBox[{"DiagonalMatrix", "[", "ds", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"dU", ",", "dV"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dX", ".", "U"}], ",", 
     RowBox[{"dY", ".", "V"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "err", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"err", "[", "h_", "]"}], ":=", " ", 
  RowBox[{"A", "+", 
   RowBox[{"h", " ", "dA"}], " ", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"U", "+", " ", 
      RowBox[{"h", " ", "dU"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"S", "+", 
      RowBox[{"h", " ", "dS"}]}], ")"}], ".", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"V", "+", 
       RowBox[{"h", " ", "dV"}]}], ")"}], 
     "\[Transpose]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["h", "2"], ",", 
     RowBox[{"Norm", "[", 
      RowBox[{"err", "[", "h", "]"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", ",", "0", ",", " ", "0.1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9059173676321497`*^9, 3.9059176125031433`*^9}, {
  3.905917789648994*^9, 3.905918086634828*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"a32a059f-248c-43a7-b254-e24bd2eb5e63"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1: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
       "]]},
     Annotation[#, "Charting`Private`Tag$15441#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVj3040wkAx3eKzh3yMGGkFB2J69FFMb6MXJLq0hGRlIvJhUsvkh1dVE9c
I+nyUnnbmpw2Y/wWSksi8zL2UyzErdBTnhI6Jtf98Xk+/34+5gdjdv+iRqFQ
fL/wv4vGiXjpeXPXOUWqT7SFq2uUmsGDSioFumfPZgVzTDBtdJp/maoLU4a9
2RqODegl5VYs6kocZK8t1uc4Y3CsKfw4dT3Gf9RRmnB8IEiXqcVR3UB/ydT0
4OwDbeBZ11HqLpinPKvK5xxBu0Yw8Sv1AM4FDWr4cxNBfekbmNEYCxOde0yx
LB1x9nkj6spTCIrvSUmIugqz+EtvO2KSMTcRPbvGOx+zcWEL5ZJz8MvmflQM
FKLCWscoT3oB1k0hWxWBpQhY3O1lbJeBUqrQY2QFD3kXDJdR69lwlIX51PeU
Y+bNei2LhiyESV4Pmljy0X7AX/vMeDbW9c2HR6lXItP+dabifQ54GmN1ix4L
EVsgiVOf+As5AdKeuaRqtBqXB58wzEPkUaeCrH010J1caJ2gFSBNtPQw05hA
14tQT4H3TbgY3xkdU4nRy09NX15zCxtGH/Lae+tAN8+sfSUqhM5ejt5oVgNC
cleN+7UVwexWnlCx+QGmGpkhWzqKkRbh0htMa4TPBwey73UJ9J97323Qfgi7
Cd6ZPXOluLRA9+xSPURarix8t4oDkfBg1FS/BPk7UnZ/1LuNi0fUb6u1P4KV
QJlCM+Qh2MaSZcZvAmNoYsBiWRmkq+krlRmPYWyU7N699g4iBXT7fFYzIj43
KdVty9ESI3u1L/QJjr3NvKzw/BtXLChGen4t0OItirgWUAEn3oj+CUYraPo2
yWTAXfwxH35MYf4Uk4zoDoUDHztUyQbu1DZkdxf8zq7lw6A5Zrpkug1nthV5
iRwFsA2hBPJ7pJA0MXUrGgXod+qtaWxqxxYjrbkIRiV8+TaabZwOWMbEjU5K
K+FRKw6M8+2EW4Fg2n2XEDmXxakn73eiSPDIRK1TCMNhHnvX91041JrrkR1U
hWnxuqfC210IFfukj/ZXgaFi5ejQZBBX3O/ViazGSILR4HS2DMEXNZy476tR
1pDOEWp3Y7OzVf1Xv4mgfXJTZjirG/HvtTzs5kUI45Y6cD91Y5zVNmb6ew1a
/X22KKJ6wP2wn5v0uQanGNTQ4b4eSKKqIvgXauGccJXJ2iMHTfzP1lJNAuvS
NjI1H8sxn7SYpvyWwOcir/TFT+QYcrd4Y6FDwOrrG/yFFjk4LYcySvQIuHSu
mJ+SyrHh+XBXsQkBxt7Y0mG5HNs/DQUV2RK4t9N3Q51SjiSHF9E3fyKQuMrR
M1adxIFZlcugHwGR/mr2kSUkPBtMl67wJ7D2mP+Lw5okvvEKFtwIIsAsvJIY
ok0i5+f+qYJDBJrqIpu3GZCoiH/Oyj9OIHk2Nd/SkkTmpn93Kk4SsDN7q1r5
HYl4lZG56WkCP3jk7ze1JuF0bq8kj0VATSSz1Lcl0Xyld0neeQJb3QollI0k
ygJmnvVd/PIf622nciDxp4lhGS2dwOz45tyZTST2FPtvz2UTcH41efwdnYRj
xInlfVkE9BPqlWOuJGg2Oe+MrxLgJnb4K91IzL+rvh947UvPjHXLEIPEUKWc
ff06gYGPbXSFJ4n/AC+JXXQ=
       "]]},
     Annotation[#, "Charting`Private`Tag$15441#2"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.1}, {0., 0.34795289933738427`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.9059178848504057`*^9, 3.9059178995050573`*^9}, 
   3.9059179299919243`*^9, {3.905917964543253*^9, 3.905918088122904*^9}},
 CellLabel->
  "Out[164]=",ExpressionUUID->"df3cad85-57a2-4a74-ad28-b66eb5001c56"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differentiating a Schur Decomposition", "Section",
 CellChangeTimes->{{3.9053221474326577`*^9, 3.905322158600971*^9}, {
  3.9053224857862453`*^9, 3.9053224874298773`*^9}, {3.9053225367131104`*^9, 
  3.905322546675497*^9}},ExpressionUUID->"865fee83-a0b9-4dde-a83c-\
64243de3e753"],

Cell[TextData[{
 "The target is to modify the SVD \[OpenCurlyDoubleQuote]differentiation\
\[CloseCurlyDoubleQuote] argument to the Schur Decomposition. \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "T", ".", 
     RowBox[{"Q", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "50579448-3a07-4748-b6f9-ea06e03eaa89"],
 " or equivalently ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "=", 
    RowBox[{
     RowBox[{"Q", "\[Transpose]"}], ".", "A", ".", "Q"}]}], TraditionalForm]],
  ExpressionUUID->"0adbf43e-701e-4819-8bf1-adb881c249f0"],
 "\nwhere ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "9b60a9c9-e321-4a2b-9475-8560979ff3eb"],
 " is orthogonal (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"Q", ".", 
      RowBox[{"Q", "\[Transpose]"}]}], "=", "I"}], ")"}], TraditionalForm]],
  ExpressionUUID->"7a38c5c1-d840-4706-bd58-e52d6a5b5af5"],
 " and T is upper triangular. Differentiating gives\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "'"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Q", "'"}], ".", "T", ".", 
      RowBox[{"Q", "\[Transpose]"}]}], "+", 
     RowBox[{"Q", ".", 
      RowBox[{"T", "'"}], ".", 
      RowBox[{"Q", "\[Transpose]"}]}], "+", 
     RowBox[{"Q", ".", "T", ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Q", "\[Transpose]"}], ")"}], "'"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"4debd638-2bf1-426e-997f-9cdb332035a8"],
 " \nand \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Q", "'"}], ".", 
      RowBox[{"Q", "\[Transpose]"}]}], "+", 
     RowBox[{"Q", ".", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Q", "\[Transpose]"}], ")"}], "'"}]}]}], "=", "0"}], 
   TraditionalForm]],ExpressionUUID->"5820f059-f12f-4ac0-b07e-b8f66076f209"]
}], "Text",
 CellChangeTimes->{{3.905501524721031*^9, 
  3.9055015961606646`*^9}},ExpressionUUID->"1dfca3d4-ad9d-45c3-8820-\
258f243850c0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q", ",", "T"}], "}"}], "=", 
   RowBox[{"SchurDecomposition", "[", "A", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "-", 
      RowBox[{"Q", ".", "T", ".", 
       RowBox[{"Q", "\[Transpose]"}]}]}], ",", 
     RowBox[{"Q", ".", 
      RowBox[{"Q", "\[Transpose]"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9053227151044006`*^9, 3.9053227504694405`*^9}, {
  3.9053227886811876`*^9, 3.9053228068568225`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"ef7ff574-777d-43b5-90e8-cfdd671ac8ac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.975275151738181`*^-15", ",", "1.0000000000000002`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9053227435277367`*^9, 3.905322750960987*^9}, 
   3.9053228073413477`*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"28a3cbe4-5eca-49e3-822e-6cf1135506fd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1152, 586},
WindowMargins->{{Automatic, 122}, {Automatic, 0}},
TaggingRules-><|
 "PresenterSettings" -> <|"Dialogs" -> {}|>, "TryRealOnly" -> False|>,
Magnification->1.25,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"0dc06b2e-8473-4a68-b9a3-039bb38cedb7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 182, 3, 154, "Title",ExpressionUUID->"86c65eeb-29ba-463c-83b4-272a963ce65b"],
Cell[765, 27, 374, 9, 42, "Text",ExpressionUUID->"b87d2f4c-f7c3-4db1-bbfb-5111d818b4d9"],
Cell[1142, 38, 712, 17, 39, "Item",ExpressionUUID->"96699503-2cca-46e7-a7c0-5d7bd531fd08"],
Cell[1857, 57, 591, 17, 39, "Item",ExpressionUUID->"cc8a789a-fbac-427b-88b1-5ed8862f5b39"],
Cell[2451, 76, 912, 27, 39, "Item",ExpressionUUID->"4f8b7be6-28b2-40ba-858d-cb4dc4245c76"],
Cell[3366, 105, 909, 27, 39, "Item",ExpressionUUID->"1d4e2b03-2d8f-408e-b098-c376ea0d06dd"],
Cell[4278, 134, 611, 17, 39, "Item",ExpressionUUID->"0aa1085a-e87a-4994-b0b5-cdd6c24645be"],
Cell[4892, 153, 784, 23, 39, "Item",ExpressionUUID->"bccaba1d-39a6-4a70-b2a5-7ed2454c8402"],
Cell[5679, 178, 583, 12, 98, "Text",ExpressionUUID->"3a7ee43f-52c0-42f9-ab19-8eee81665033"],
Cell[CellGroupData[{
Cell[6287, 194, 323, 5, 98, "Subtitle",ExpressionUUID->"d1b3f2fd-79fa-467b-b3e6-b3d347009a21"],
Cell[6613, 201, 3684, 112, 375, "Text",ExpressionUUID->"85ae8e2b-4b4c-4128-abb1-f2a120290be6"],
Cell[10300, 315, 4536, 118, 292, "Text",ExpressionUUID->"3fd55326-63c9-4aa4-97cd-0897ba20e0d9"],
Cell[CellGroupData[{
Cell[14861, 437, 1870, 53, 168, "Input",ExpressionUUID->"06004f4c-08d9-4bac-a1b6-16009ef5a594"],
Cell[16734, 492, 840, 20, 69, "Output",ExpressionUUID->"5df87da4-e581-4250-8016-2fb910bf26dc"],
Cell[17577, 514, 539, 11, 46, "Output",ExpressionUUID->"0abf2f48-cc55-4f62-89fc-c824730b42a4"]
}, Open  ]],
Cell[18131, 528, 4397, 120, 264, "Text",ExpressionUUID->"ff34e681-bde9-437b-bbf2-3ea9ef610d13"],
Cell[22531, 650, 172, 3, 42, "Text",ExpressionUUID->"0f32985a-557f-434e-8eeb-583d76f351f2"],
Cell[CellGroupData[{
Cell[22728, 657, 1980, 56, 194, "Input",ExpressionUUID->"2776fb72-1fa6-412e-bc81-f363a3aac150"],
Cell[24711, 715, 1481, 35, 119, "Output",ExpressionUUID->"a20049b5-52d0-4597-986e-98e3d3c85afa"]
}, Open  ]],
Cell[26207, 753, 2721, 75, 325, "Text",ExpressionUUID->"43be927d-0a81-4fec-b24e-73b67bca5f4d"],
Cell[CellGroupData[{
Cell[28953, 832, 1491, 42, 189, "Input",ExpressionUUID->"b07867e7-6e9a-40aa-8b3a-9b0903fb8cec"],
Cell[30447, 876, 469, 8, 46, "Output",ExpressionUUID->"6b914c67-2b9c-41ab-baa4-ff29e4fac911"]
}, Open  ]],
Cell[30931, 887, 492, 10, 70, "Text",ExpressionUUID->"fd8dac07-e575-4d16-bbec-4481124a8c59"],
Cell[31426, 899, 2716, 69, 347, "Input",ExpressionUUID->"3f0c0628-addc-4b17-9ba6-861368189ef4",
 InitializationCell->True],
Cell[34145, 970, 765, 19, 98, "Text",ExpressionUUID->"04fe972f-77a3-4a86-8f2c-129a599a58d9"],
Cell[CellGroupData[{
Cell[34935, 993, 2329, 61, 143, "Input",ExpressionUUID->"683fe593-221c-4e1d-9e47-3af850e74a7f"],
Cell[37267, 1056, 249, 3, 43, "Output",ExpressionUUID->"8ca92a0d-2e99-4a03-93d5-30739cd0ab12"]
}, Open  ]],
Cell[37531, 1062, 1781, 47, 237, "Text",ExpressionUUID->"45c79ef9-9ff1-43ab-a96a-d13bc9aa9524"],
Cell[CellGroupData[{
Cell[39337, 1113, 1756, 54, 143, "Input",ExpressionUUID->"6c057e08-c192-4725-9833-2c5a135c3edd"],
Cell[41096, 1169, 177, 3, 43, "Output",ExpressionUUID->"4a4fc942-93c5-4b72-94e0-7db6898d0b34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41310, 1177, 396, 10, 37, "Input",ExpressionUUID->"26d97a6e-e877-4e91-a2e5-1174dc1b9320"],
Cell[41709, 1189, 849, 27, 97, "Output",ExpressionUUID->"f2da7928-04fb-4179-9c67-77b526b86981"]
}, Open  ]],
Cell[42573, 1219, 1013, 25, 98, "Text",ExpressionUUID->"89627152-414e-47a8-b504-0cf86de35134"],
Cell[43589, 1246, 1095, 36, 99, "Text",ExpressionUUID->"149aba07-7e4c-4106-9a05-9184956bb49f",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[44709, 1286, 192, 6, 95, "Subsection",ExpressionUUID->"12586420-1925-4da1-a9b1-58b1e5eeff3b"],
Cell[44904, 1294, 1677, 49, 126, "Text",ExpressionUUID->"0454a0ba-c307-47bf-a761-d722debff961"],
Cell[46584, 1345, 1996, 57, 128, "Text",ExpressionUUID->"f90ce8b1-0ef0-4126-864c-46c9281301fe"],
Cell[48583, 1404, 1788, 52, 181, "Text",ExpressionUUID->"906091fa-d9bc-421b-a570-71b26f3aeecf"],
Cell[CellGroupData[{
Cell[50396, 1460, 2225, 71, 248, "Input",ExpressionUUID->"a32a059f-248c-43a7-b254-e24bd2eb5e63"],
Cell[52624, 1533, 7063, 137, 306, "Output",ExpressionUUID->"df3cad85-57a2-4a74-ad28-b66eb5001c56"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59736, 1676, 285, 4, 81, "Section",ExpressionUUID->"865fee83-a0b9-4dde-a83c-64243de3e753"],
Cell[60024, 1682, 1984, 61, 181, "Text",ExpressionUUID->"1dfca3d4-ad9d-45c3-8820-258f243850c0"],
Cell[CellGroupData[{
Cell[62033, 1747, 989, 30, 116, "Input",ExpressionUUID->"ef7ff574-777d-43b5-90e8-cfdd671ac8ac"],
Cell[63025, 1779, 295, 7, 46, "Output",ExpressionUUID->"28a3cbe4-5eca-49e3-822e-6cf1135506fd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

